<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 11 Item Response Theory | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</title>
<meta name="author" content="R. Noah Padgett">
<meta name="description" content="Item response theory (IRT) builds models for item (stimuli that the measures collected) based on two broad classes of models Models for dichotomous (binary, 0/1) items and Models for polytomous...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 11 Item Response Theory | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy">
<meta property="og:type" content="book">
<meta property="og:description" content="Item response theory (IRT) builds models for item (stimuli that the measures collected) based on two broad classes of models Models for dichotomous (binary, 0/1) items and Models for polytomous...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 11 Item Response Theory | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy">
<meta name="twitter:description" content="Item response theory (IRT) builds models for item (stimuli that the measures collected) based on two broad classes of models Models for dichotomous (binary, 0/1) items and Models for polytomous...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li class="book-part">Foundations</li>
<li><a class="" href="overview.html"><span class="header-section-number">1</span> Overview</a></li>
<li><a class="" href="chp2.html"><span class="header-section-number">2</span> Introduction to Bayesian Inference</a></li>
<li><a class="" href="conceptual-issues-in-bayesian-inference.html"><span class="header-section-number">3</span> Conceptual Issues in Bayesian Inference</a></li>
<li><a class="" href="normal-distribution-models.html"><span class="header-section-number">4</span> Normal Distribution Models</a></li>
<li><a class="" href="markov-chain-monte-carlo-estimation.html"><span class="header-section-number">5</span> Markov Chain Monte Carlo Estimation</a></li>
<li><a class="" href="regression.html"><span class="header-section-number">6</span> Regression</a></li>
<li class="book-part">Psychometrics</li>
<li><a class="" href="canonical-bayesian-psychometric-modeling.html"><span class="header-section-number">7</span> Canonical Bayesian Psychometric Modeling</a></li>
<li><a class="" href="classical-test-theory.html"><span class="header-section-number">8</span> Classical Test Theory</a></li>
<li><a class="" href="confirmatory-factor-analysis.html"><span class="header-section-number">9</span> Confirmatory Factor Analysis</a></li>
<li><a class="" href="model-evaluation.html"><span class="header-section-number">10</span> Model Evaluation</a></li>
<li><a class="active" href="item-response-theory.html"><span class="header-section-number">11</span> Item Response Theory</a></li>
<li><a class="" href="missing-data-modeling.html"><span class="header-section-number">12</span> Missing Data Modeling</a></li>
<li><a class="" href="latent-class-analysis.html"><span class="header-section-number">13</span> Latent Class Analysis</a></li>
<li><a class="" href="bayesian-networks.html"><span class="header-section-number">14</span> Bayesian Networks</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/noah-padgett/Bayesian-Psychometric-Modeling">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="item-response-theory" class="section level1" number="11">
<h1>
<span class="header-section-number">11</span> Item Response Theory<a class="anchor" aria-label="anchor" href="#item-response-theory"><i class="fas fa-link"></i></a>
</h1>
<p>Item response theory (IRT) builds models for item (stimuli that the measures collected) based on two broad classes of models</p>
<ol style="list-style-type: decimal">
<li>Models for dichotomous (binary, 0/1) items and</li>
<li>Models for polytomous (multi-category) items.</li>
</ol>
<div id="irt-models-for-dichotomous-data" class="section level2" number="11.1">
<h2>
<span class="header-section-number">11.1</span> IRT Models for Dichotomous Data<a class="anchor" aria-label="anchor" href="#irt-models-for-dichotomous-data"><i class="fas fa-link"></i></a>
</h2>
<p>First, for conventional dichotomous observed variables, an IRT model can be generally specified as follows.</p>
<p>Let <span class="math inline">\(x_{ij}\)</span> be the observed value from respondent <span class="math inline">\(i\)</span> on observable (item) <span class="math inline">\(j\)</span>.
When <span class="math inline">\(x\)</span> is binary, the observed value can be <span class="math inline">\(0\)</span> or <span class="math inline">\(1\)</span>.
Some common IRT models for binary observed variables can be expressed as a version of</p>
<p><span class="math display">\[p(x_{ij} = 1 \mid \theta_i, d_j, a_j, c_j) = c_j + (1-c_j)F(a_j \theta_i + d_j),\]</span></p>
<p>where,</p>
<ul>
<li>
<span class="math inline">\(\theta_i\)</span> is the magnitude of the latent variable that individual <span class="math inline">\(i\)</span> possesses. In educational measurement, <span class="math inline">\(\theta_i\)</span> commonly represents proficiency so that a higher <span class="math inline">\(\theta_i\)</span> means that individual has more of the trait,</li>
<li>
<span class="math inline">\(d_j\)</span> is the item location or difficulty parameter. <span class="math inline">\(d_j\)</span> is commonly transformed to be <span class="math inline">\(d_j = -a_jb_j\)</span> so that the location parameter is easier to interpret in relation to the latent trait <span class="math inline">\(\theta_i\)</span>,</li>
<li>
<span class="math inline">\(a_j\)</span> is the item slope or discrimination parameter,</li>
<li>
<span class="math inline">\(c_j\)</span> is the item lower asymptote or guessing parameter,</li>
<li>
<span class="math inline">\(F(.)\)</span> is the link function to be specified that determines the form of the transformation between latent trait and the item response probability. The link is common chosen to be either the logistic link or the normal-ogive link.</li>
</ul>
<p>Common IRT models are the</p>
<ul>
<li>1-PL, or one-parameter logistic model, which only uses one measurement parameter <span class="math inline">\(d_j\)</span> per item,</li>
<li>2-PL, or two-parameter logistic model, which uses two measurement model parameters <span class="math inline">\(a_j\)</span> and <span class="math inline">\(d_j\)</span> per item,</li>
<li>3-PL, or three-parameter logistic model, which uses all three parameters as shown above.</li>
<li>other models are also possible for binary item response formats but are omitted here.</li>
</ul>
<p>The above describes the functional form used to model why individual may have a greater or lesser likelihood of endorsing an item (have a <span class="math inline">\(1\)</span> as a measure).
We use the above model as the basis for defining the conditional probability of any response given the values of the parameters.
The conditional probability is then commonly used as part of a <em>marginal maximum likelihood (MML)</em> approach to finding parameters values for the measurement model which maximize the likelihood.
However, given that the values of the latent variable <span class="math inline">\(\theta_i\)</span> are also unknown, the distribution of <span class="math inline">\(\theta_i\)</span> is marginalized out of the likelihood function.</p>
<p>However, in the Bayesian formulation, we can side-step some of these issues by the use of prior distributions.
Starting with the general form of the likelihood function
<span class="math display">\[p(\mathbf{x}\mid \boldsymbol{\theta}, \boldsymbol{\omega}) = \prod_{i=1}^np(\mathbf{x}_i\mid \theta_i, \boldsymbol{\omega}) = \prod_{i=1}^n\prod_{j=1}^Jp(x_{ij}\mid \theta_i, \boldsymbol{\omega}_j),\]</span>
where
<span class="math display">\[x_{ij}\mid \theta_i, \boldsymbol{\omega}_j \sim \mathrm{Bernoulli}[p(x_{ij}\mid \theta_i, \boldsymbol{\omega}_j)].\]</span></p>
<p>Developing a joint prior distribution for <span class="math inline">\(p(\boldsymbol{\theta}, \boldsymbol{\omega})\)</span> is not straightforward given the high dimensional aspect of the components.
But, a common assumption is that the distribution for the latent variables (<span class="math inline">\(\boldsymbol{\theta}\)</span>) is independent of the distribution for the measurement model parameters (<span class="math inline">\(\boldsymbol{\omega}\)</span>).
That is, we can separate the problem into independent priors
<span class="math display">\[p(\boldsymbol{\theta}, \boldsymbol{\omega}) = p(\boldsymbol{\theta})p(\boldsymbol{\omega}).\]</span></p>
<p>For the latent variables, the prior distributuion is generally build by assuming that all individuals are also independent.
The independence of observations leads to a joint prior that is a product of priors with a common distribution,
<span class="math display">\[p(\boldsymbol{\theta}) = \prod_{i=1}^np(\theta_i\mid \boldsymbol{\theta}_p),\]</span>
where <span class="math inline">\(\boldsymbol{\theta}_p\)</span> are the hyperparameters governing the common prior for the latent variable distribution.
A common choice is that <span class="math inline">\(\theta_i \sim \mathrm{Normal}(\mu_{\theta} = 0, \sigma^2_{\theta}=1)\)</span> because the distribution is arbitrary.</p>
<p>For the measurement model parameters, a bit more complex specification is generally needed.
One <em>simple</em> approach would be to invoke an exchangeability assumption among items and among item parameters.
This would essentially make all priors independent and simplify the specification to product of univariate priors over all measurement model parameters
<span class="math display">\[p(\boldsymbol{\omega}) = \prod_{j=1}^Jp(\boldsymbol{\omega}_j)=\prod_{j=1}^Jp(d_j)p(a_j)p(c_j).\]</span>
For for location parameter (<span class="math inline">\(d_j\)</span>), a common prior distribution is an unbounded normal distribution.
Because, the location can take on any value within the range of the latent variable which is also technically unbounded so we let
<span class="math display">\[d_j \sim \mathrm{Normal}(\mu_{d},\sigma^2_d).\]</span>
The choice of hyperparameters can be guided by prior research or set to a common relative diffuse value for all items such as <span class="math inline">\(\mu_{d}=0,\sigma^2_d=10\)</span>.</p>
<p>The discrimination parameter governs the strength of the relationship between the latent variable and the probability of endorsing the item.
This is similar in flavor to a factor loading in CFA.
An issue with specifying a prior for the discrimination parameter is the indeterminacy with respect the the orientation of the latent variable.
In CFA, we resolved the orientation indeterminacy issue by fixing one factor loading to 1.
In IRT, we can do so by constraining the possible values of the discrimination parameters to be strictly positive.
This forces each item to have the meaning of higher values on the latent variable directly (or at least proportionally) increase the probability of endorsing the item.
We achieve this by using a prior such as
<span class="math display">\[a_j \sim \mathrm{Normal}^{+}(\mu_a,\sigma^2_a).\]</span>
The term <span class="math inline">\(\mathrm{Normal}^{+}(.)\)</span> means that the normal distribution is truncated at 0 so that only positive values are possible.</p>
<p>Lastly, the guessing parameter <span class="math inline">\(c_j\)</span> takes on values between <span class="math inline">\([0,1]\)</span>.
A common choice for parameters bounded between 0 and 1 is a Beta prior, that is
<span class="math display">\[c_j \sim \mathrm{Beta}(\alpha_c, \beta_c).\]</span>
The hyperparameters <span class="math inline">\(\alpha_c\)</span> and <span class="math inline">\(\beta_c\)</span> determine the shape of the beta prior and affect the likelihood and magnitude of guessing parameters.</p>
</div>
<div id="pl-lsat-example" class="section level2" number="11.2">
<h2>
<span class="header-section-number">11.2</span> 3-PL LSAT Example<a class="anchor" aria-label="anchor" href="#pl-lsat-example"><i class="fas fa-link"></i></a>
</h2>
<p>In the Law School Admission Test (LSAT) example (p. 263-271), the data are from 1000 examinees responding to five items which is just a subset of the LSAT.
We hypothesize that only one underlying latent variable is measured by these items.
But that guessing is also plausible.
The full 3-PL model we will use can be described in an equation as
<span class="math display">\[p(\boldsymbol{\theta}, \boldsymbol{d}, \boldsymbol{a}, \boldsymbol{c} \mid \mathbf{x}) \propto \prod_{i=1}^n\prod_{j=1}^Jp(\theta_i\mid\theta_i, d_j, a_j, c_j)p(\theta_i)p(d_j)p(a_j)p(c_j),\]</span>
where
<span class="math display">\[\begin{align*}
x_{ij}\mid\theta_i\mid\theta_i, d_j, a_j, c_j &amp;\sim \mathrm{Bernoulli}[p(\theta_i\mid\theta_i, d_j, a_j, c_j)],\ \mathrm{for}\ i=1, \cdots, 100,\ j = 1, \cdots, 5;\\
p(\theta_i\mid\theta_i, d_j, a_j, c_j) &amp;= c_j + (1-c_j)\Phi(a_j\theta_j + d_j),\ \mathrm{for}\ i=1, \cdots, 100,\ j = 1, \cdots, 5;\\
\theta_i &amp;\sim \mathrm{Normal}(0,1),\ \mathrm{for}\ i = 1, \cdots, 1000;\\
d_j &amp;\sim \mathrm{Normal}(0, 2),\ \mathrm{for}\ j=1, \cdots, 5;\\
a_j &amp;\sim \mathrm{Normal}^{+}(1, 2),\ \mathrm{for}\ j=1, \cdots, 5;\\
c_j &amp;\sim \mathrm{Beta}(5, 17),\ \mathrm{for}\ j=1, \cdots, 5.
\end{align*}\]</span></p>
<p>The above model can illustrated in a DAG as shown below.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chp11-dag-1"></span>
<img src="dag/chp11-irt1.png" alt="DAG for 3-PL IRT model for LSAT Example" width="75%" height="90%"><p class="caption">
Figure 11.1: DAG for 3-PL IRT model for LSAT Example
</p>
</div>
<p>The path diagram for an IRT is essentially identical to the path diagram for a CFA model.
This fact highlights an important feature of IRT/CFA in that the major conceptual difference between these approaches to is how we define the link between the latent variable the observed items.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chp11-pathdiag-1"></span>
<img src="path-diagram/chp11-irt1.png" alt="Path diagram for 3-PL IRT model" width="90%" height="90%"><p class="caption">
Figure 11.2: Path diagram for 3-PL IRT model
</p>
</div>
<p>For completeness, I have included the model specification diagram that more concretely connects the DAG and path diagram to the assumed distributions and priors.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chp11-spec-1"></span>
<img src="model-spec/chp11-irt1.png" alt="Model specification diagram for the 3-PL IRT model" width="90%" height="90%"><p class="caption">
Figure 11.3: Model specification diagram for the 3-PL IRT model
</p>
</div>
</div>
<div id="lsat-example---jags" class="section level2" number="11.3">
<h2>
<span class="header-section-number">11.3</span> LSAT Example - JAGS<a class="anchor" aria-label="anchor" href="#lsat-example---jags"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jags.model.lsat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>

<span class="co">#########################################</span>
<span class="co"># Specify the item response measurement model for the observables</span>
<span class="co">#########################################</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
    <span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">c</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">c</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu">phi</span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">d</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span>       <span class="co"># 3P-NO expression</span>
    <span class="va">x</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dbern</span><span class="op">(</span><span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>                  <span class="co"># distribution for each observable</span>
  <span class="op">}</span>
<span class="op">}</span>


<span class="co">##########################################</span>
<span class="co"># Specify the (prior) distribution for the latent variables</span>
<span class="co">##########################################</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># distribution for the latent variables</span>
<span class="op">}</span>


<span class="co">##########################################</span>
<span class="co"># Specify the prior distribution for the measurement model parameters</span>
<span class="co">##########################################</span>
<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
  <span class="va">d</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span>          <span class="co"># Locations for observables</span>
  <span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">)</span>    <span class="co"># Discriminations for observables</span>
  <span class="va">c</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">17</span><span class="op">)</span>           <span class="co"># Lower asymptotes for observables</span>
  
<span class="op">}</span>


<span class="op">}</span> <span class="co"># closes the model</span>

<span class="co"># initial values</span>
<span class="va">start_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span><span class="op">)</span>,
       <span class="st">"a"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span><span class="op">)</span>,
       <span class="st">"c"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span><span class="op">)</span>,
       <span class="st">"a"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span><span class="op">)</span>,
       <span class="st">"c"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span><span class="op">)</span>,
       <span class="st">"a"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,
       <span class="st">"c"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># vector of all parameters to save</span>
<span class="va">param_save</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>, <span class="st">"theta"</span><span class="op">)</span>

<span class="co"># dataset</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/LSAT.dat"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># fit model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">jags</span><span class="op">(</span>
  model.file<span class="op">=</span><span class="va">jags.model.lsat</span>,
  data<span class="op">=</span><span class="va">mydata</span>,
  inits<span class="op">=</span><span class="va">start_values</span>,
  parameters.to.save <span class="op">=</span> <span class="va">param_save</span>,
  n.iter<span class="op">=</span><span class="fl">20000</span>,
  n.iter<span class="op">=</span><span class="fl">26000</span>,
  n.burnin <span class="op">=</span> <span class="fl">6000</span>,
  n.chains <span class="op">=</span> <span class="fl">3</span>,
  progress.bar <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in jags(model.file = jags.model.lsat, data = mydata, inits = start_values, : formal argument "n.iter" matched by multiple actual arguments</code></pre>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in print(fit): object 'fit' not found</code></pre>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span> <span class="op">%like%</span> <span class="st">"theta"</span>, <span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'fit' not found</code></pre>
<div class="sourceCode" id="cb278"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract posteriors for all chains</span>
<span class="va">jags.mcmc</span> <span class="op">&lt;-</span> <span class="fu">as.mcmc</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in as.mcmc(fit): object 'fit' not found</code></pre>
<div class="sourceCode" id="cb280"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># the below two plots are too big to be useful given the 1000 observations.</span>
<span class="co">#R2jags::traceplot(jags.mcmc)</span>

<span class="co"># gelman-rubin-brook</span>
<span class="co">#gelman.plot(jags.mcmc)</span>

<span class="co"># convert to single data.frame for density plot</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in as.data.frame(jags.mcmc[[1]]): object 'jags.mcmc' not found</code></pre>
<div class="sourceCode" id="cb282"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">jags.mcmc</span>, chains<span class="op">=</span><span class="cn">T</span>, iters <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in as.matrix(jags.mcmc, chains = T, iters = T): object 'jags.mcmc' not found</code></pre>
<div class="sourceCode" id="cb284"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">plot.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chain"</span>, <span class="st">"iter"</span>, <span class="va">a</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'a' not found</code></pre>
<div class="sourceCode" id="cb286"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-diagnostics.html">mcmc_acf</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"d["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb288"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"d["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb290"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggmcmc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggmcmc/man/ggs_grb.html">ggs_grb</a></span><span class="op">(</span><span class="fu">ggs</span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"d"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in ggs(jags.mcmc): object 'jags.mcmc' not found</code></pre>
<div class="sourceCode" id="cb292"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">plot.data</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"d["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="st">"]"</span><span class="op">)</span><span class="op">)</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb294"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-diagnostics.html">mcmc_acf</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb296"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggmcmc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggmcmc/man/ggs_grb.html">ggs_grb</a></span><span class="op">(</span><span class="fu">ggs</span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"a"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in ggs(jags.mcmc): object 'jags.mcmc' not found</code></pre>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mcmc_areas</span><span class="op">(</span> <span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-diagnostics.html">mcmc_acf</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"c["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"c["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggmcmc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggmcmc/man/ggs_grb.html">ggs_grb</a></span><span class="op">(</span><span class="fu">ggs</span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"c"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in ggs(jags.mcmc): object 'jags.mcmc' not found</code></pre>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mcmc_areas</span><span class="op">(</span><span class="va">plot.data</span>, pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"c["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in posterior::is_draws(x): object 'plot.data' not found</code></pre>
<div id="posterior-predicted-distributions" class="section level3" number="11.3.1">
<h3>
<span class="header-section-number">11.3.1</span> Posterior Predicted Distributions<a class="anchor" aria-label="anchor" href="#posterior-predicted-distributions"><i class="fas fa-link"></i></a>
</h3>
<p>Here, we want to compare the observed and expected posterior predicted distributions.</p>
<p>Statistical functions of interest are the (1) standardized model-based covariance (SMBC) and (2) the standardized generalized discrepancy measure (SGDDM).</p>
<p>For (1), the SMBC is
<span class="math display">\[SMBC_{jj^\prime}=\frac{\frac{1}{n}\sum_{i=1}^n(x_{ij} - E(x_{ij} \mid \theta_i,\boldsymbol{\omega}_j))(x_{ij^\prime} - E(x_{ij^\prime} \mid \theta_i,\boldsymbol{\omega}_j^\prime))}{\sqrt{\frac{1}{n}\sum_{i=1}^n(x_{ij} - E(x_{ij} \mid \theta_i,\boldsymbol{\omega}_j))^2}\sqrt{\frac{1}{n}\sum_{i=1}^n(x_{ij^\prime} - E(x_{ij^\prime} \mid \theta_i,\boldsymbol{\omega}_j^\prime))}}\]</span></p>
<p>In R, the functions below can be used to compute these qualtities.</p>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">calculate.SGDDM</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data.matrix</span>, <span class="va">expected.value.matrix</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">J.local</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data.matrix</span><span class="op">)</span>

    <span class="va">SMBC.matrix</span> <span class="op">&lt;-</span> <span class="fu">calculate.SMBC.matrix</span><span class="op">(</span><span class="va">data.matrix</span>, <span class="va">expected.value.matrix</span><span class="op">)</span>
    
    <span class="va">SGDDM</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lower.tri.html">lower.tri</a></span><span class="op">(</span><span class="va">SMBC.matrix</span>, diag<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">SMBC.matrix</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="op">(</span><span class="va">J.local</span><span class="op">*</span><span class="op">(</span><span class="va">J.local</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>

    <span class="va">SGDDM</span>

<span class="op">}</span> <span class="co"># closes calculate.SGDDM</span>

<span class="va">calculate.SMBC.matrix</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data.matrix</span>, <span class="va">expected.value.matrix</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">N.local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">data.matrix</span><span class="op">)</span>

    <span class="va">MBC.matrix</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">data.matrix</span><span class="op">-</span><span class="va">expected.value.matrix</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="op">(</span><span class="va">data.matrix</span><span class="op">-</span><span class="va">expected.value.matrix</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">N.local</span>

    <span class="va">MBStddevs.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="va">MBC.matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

    <span class="co">#SMBC.matrix &lt;- solve(MBStddevs.matrix) %*% MBC.matrix %*% solve(MBStddevs.matrix)</span>


    <span class="va">J.local</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">data.matrix</span><span class="op">)</span>

    <span class="va">SMBC.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, nrow<span class="op">=</span><span class="va">J.local</span>, ncol<span class="op">=</span><span class="va">J.local</span><span class="op">)</span>

    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J.local</span><span class="op">)</span><span class="op">{</span>
        <span class="kw">for</span><span class="op">(</span><span class="va">jj</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J.local</span><span class="op">)</span><span class="op">{</span>
            <span class="va">SMBC.matrix</span><span class="op">[</span><span class="va">j</span>,<span class="va">jj</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">MBC.matrix</span><span class="op">[</span><span class="va">j</span>,<span class="va">jj</span><span class="op">]</span><span class="op">/</span><span class="op">(</span><span class="va">MBStddevs.matrix</span><span class="op">[</span><span class="va">j</span>,<span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="va">MBStddevs.matrix</span><span class="op">[</span><span class="va">jj</span>,<span class="va">jj</span><span class="op">]</span><span class="op">)</span>
        <span class="op">}</span>
    <span class="op">}</span>

    <span class="va">SMBC.matrix</span> 

<span class="op">}</span> <span class="co"># closes calculate.MBC.matrix</span></code></pre></div>
<p>Next, we will use the functions above among other basic data wrangling to construct a full posterior predictive distribution analysis to probe our resulting posterior.</p>
<div class="sourceCode" id="cb311"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Data wrangle the results/posterior draws for use</span>
<span class="va">datv1</span> <span class="op">&lt;-</span> <span class="va">plot.data</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols <span class="op">=</span> <span class="va">`a[1]`</span><span class="op">:</span><span class="va">`a[5]`</span>,
    values_to <span class="op">=</span> <span class="st">"a"</span>,
    names_to <span class="op">=</span> <span class="st">"item"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">item</span>, <span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">item</span>, <span class="va">a</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in pivot_longer(., cols = `a[1]`:`a[5]`, values_to = "a", names_to = "item"): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb313"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datv2</span> <span class="op">&lt;-</span> <span class="va">plot.data</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols <span class="op">=</span> <span class="va">`c[1]`</span><span class="op">:</span><span class="va">`c[5]`</span>,
    values_to <span class="op">=</span> <span class="st">"c"</span>,
    names_to <span class="op">=</span> <span class="st">"item"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">item</span>, <span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">item</span>, <span class="va">c</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in pivot_longer(., cols = `c[1]`:`c[5]`, values_to = "c", names_to = "item"): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb315"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datv3</span> <span class="op">&lt;-</span> <span class="va">plot.data</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols <span class="op">=</span> <span class="va">`d[1]`</span><span class="op">:</span><span class="va">`d[5]`</span>,
    values_to <span class="op">=</span> <span class="st">"d"</span>,
    names_to <span class="op">=</span> <span class="st">"item"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">item</span>, <span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">item</span>, <span class="va">d</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in pivot_longer(., cols = `d[1]`:`d[5]`, values_to = "d", names_to = "item"): object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb317"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">datv4</span> <span class="op">&lt;-</span> <span class="va">plot.data</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols <span class="op">=</span> <span class="va">`theta[1]`</span><span class="op">:</span><span class="va">`theta[999]`</span>,
    values_to <span class="op">=</span> <span class="st">"theta"</span>,
    names_to <span class="op">=</span> <span class="st">"person"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">select</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">person</span>, <span class="va">theta</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in pivot_longer(., cols = `theta[1]`:`theta[999]`, values_to = "theta", : object 'plot.data' not found</code></pre>
<div class="sourceCode" id="cb319"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">datv1</span>, <span class="va">datv2</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in full_join(datv1, datv2): object 'datv1' not found</code></pre>
<div class="sourceCode" id="cb321"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">dat_long</span>, <span class="va">datv3</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in full_join(dat_long, datv3): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb323"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu">full_join</span><span class="op">(</span><span class="va">dat_long</span>, <span class="va">datv4</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in full_join(dat_long, datv4): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb325"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat1</span> <span class="op">&lt;-</span> <span class="va">dat</span>
<span class="va">dat1</span><span class="op">$</span><span class="va">person</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"theta["</span>,<span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, <span class="st">"]"</span><span class="op">)</span>
<span class="va">datvl</span> <span class="op">&lt;-</span> <span class="va">dat1</span> <span class="op">%&gt;%</span>
  <span class="fu">pivot_longer</span><span class="op">(</span>
    cols<span class="op">=</span><span class="fu">contains</span><span class="op">(</span><span class="st">"item"</span><span class="op">)</span>,
    names_to <span class="op">=</span> <span class="st">"item"</span>,
    values_to <span class="op">=</span> <span class="st">"x"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    item <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/substr.html">substr</a></span><span class="op">(</span><span class="va">item</span>, <span class="fl">6</span>, <span class="fl">100</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">dat_long</span>, <span class="va">datvl</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in left_join(dat_long, datvl): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb327"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># compute expected prob</span>
<span class="va">ilogit</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">}</span>
<span class="va">dat_long</span> <span class="op">&lt;-</span> <span class="va">dat_long</span> <span class="op">%&gt;%</span>
  <span class="fu">as_tibble</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    x.exp <span class="op">=</span> <span class="va">c</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">c</span><span class="op">)</span><span class="op">*</span><span class="fu">ilogit</span><span class="op">(</span><span class="va">a</span><span class="op">*</span><span class="op">(</span><span class="va">theta</span> <span class="op">-</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span>,
    x.dif <span class="op">=</span> <span class="va">x</span> <span class="op">-</span> <span class="va">x.exp</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error in as_tibble(.): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb329"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dat_long</span><span class="op">$</span><span class="va">x.ppd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span>
  <span class="va">dat_long</span>, <span class="fl">1</span>, 
  FUN<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
    <span class="fu">rbern</span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">}</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error in apply(dat_long, 1, FUN = function(x) {: object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb331"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">itermin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span> <span class="co"># used for subseting</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb333"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># figure 11.4</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">dat_long</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">person</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>raw.score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
            raw.score.ppd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x.ppd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in group_by(., chain, iter, person): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb335"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">di</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span> <span class="va">d</span><span class="op">$</span><span class="va">chain</span> <span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">iter</span> <span class="op">==</span> <span class="va">itermin</span>, <span class="op">]</span> <span class="op">%&gt;%</span>
<span class="va">di</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">chain</span><span class="op">==</span><span class="fl">1</span>, <span class="va">iter</span><span class="op">==</span><span class="fl">6001</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">raw.score</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in filter(., chain == 1, iter == 6001): object 'd' not found</code></pre>
<div class="sourceCode" id="cb337"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dii</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">raw.score.ppd</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>raw.score <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in group_by(., chain, iter, raw.score.ppd): object 'd' not found</code></pre>
<div class="sourceCode" id="cb339"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># overall fit of observed scores</span>
<span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">dii</span>, <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">raw.score</span>, x<span class="op">=</span> <span class="va">raw.score.ppd</span>, group<span class="op">=</span><span class="va">raw.score.ppd</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>data<span class="op">=</span><span class="va">di</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">raw.score</span>, y<span class="op">=</span><span class="va">count</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Raw Score"</span>, y<span class="op">=</span><span class="st">"Number of Examinees"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks<span class="op">=</span><span class="fl">0</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in fortify(data): object 'dii' not found</code></pre>
<div class="sourceCode" id="cb341"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># by item</span>
<span class="va">d</span> <span class="op">&lt;-</span> <span class="va">dat_long</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">person</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>raw.score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
         raw.score.ppd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">x.ppd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in group_by(., chain, iter, person): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb343"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">di</span> <span class="op">&lt;-</span> <span class="va">d</span><span class="op">[</span> <span class="va">d</span><span class="op">$</span><span class="va">chain</span> <span class="op">==</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">d</span><span class="op">$</span><span class="va">iter</span> <span class="op">==</span> <span class="va">itermin</span>, <span class="op">]</span> <span class="op">%&gt;%</span>
<span class="va">di</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">chain</span><span class="op">==</span><span class="fl">1</span>, <span class="va">iter</span><span class="op">==</span><span class="fl">6001</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">raw.score</span>, <span class="va">item</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>p.correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in filter(., chain == 1, iter == 6001): object 'd' not found</code></pre>
<div class="sourceCode" id="cb345"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dii</span> <span class="op">&lt;-</span> <span class="va">d</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">chain</span>, <span class="va">iter</span>, <span class="va">raw.score.ppd</span>, <span class="va">item</span><span class="op">)</span><span class="op">%&gt;%</span>
  <span class="fu">summarise</span><span class="op">(</span>p.correct <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">x.ppd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in group_by(., chain, iter, raw.score.ppd, item): object 'd' not found</code></pre>
<div class="sourceCode" id="cb347"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span>data<span class="op">=</span><span class="va">dii</span>,
               <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span> <span class="va">p.correct</span>,
                   x<span class="op">=</span> <span class="va">raw.score.ppd</span>,
                   group<span class="op">=</span><span class="va">raw.score.ppd</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>data<span class="op">=</span><span class="va">di</span>,
             <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">raw.score</span>, y<span class="op">=</span><span class="va">p.correct</span><span class="op">)</span>,
             color<span class="op">=</span><span class="st">"red"</span>, size<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">item</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Raw Score"</span>, y<span class="op">=</span><span class="st">"Number of Examinees"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in fortify(data): object 'dii' not found</code></pre>
<div class="sourceCode" id="cb349"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># computing standardized model summary statistics</span>
<span class="co"># objects for results</span>
<span class="va">J</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">n.chain</span> <span class="op">&lt;-</span> <span class="fl">3</span>
<span class="va">n.iters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in unique(dat_long$iter): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb351"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n.iters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">long_dat</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in unique(long_dat$iter): object 'long_dat' not found</code></pre>
<div class="sourceCode" id="cb353"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n.iters.PPMC</span> <span class="op">&lt;-</span> <span class="va">n.iters</span><span class="op">*</span><span class="va">n.chain</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'n.iters' not found</code></pre>
<div class="sourceCode" id="cb355"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">realized.SMBC.array</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n.iters.PPMC</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in array(NA, c(n.iters.PPMC, J, J)): object 'n.iters.PPMC' not found</code></pre>
<div class="sourceCode" id="cb357"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">postpred.SMBC.array</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n.iters.PPMC</span>, <span class="va">J</span>, <span class="va">J</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in array(NA, c(n.iters.PPMC, J, J)): object 'n.iters.PPMC' not found</code></pre>
<div class="sourceCode" id="cb359"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">realized.SGDDM.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n.iters.PPMC</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in array(NA, c(n.iters.PPMC)): object 'n.iters.PPMC' not found</code></pre>
<div class="sourceCode" id="cb361"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">postpred.SGDDM.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html">array</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">n.iters.PPMC</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in array(NA, c(n.iters.PPMC)): object 'n.iters.PPMC' not found</code></pre>
<div class="sourceCode" id="cb363"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ii</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">c</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="co"># iteration condiitons</span>
<span class="va">iter.cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">dat_long</span><span class="op">$</span><span class="va">iter</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in unique(dat_long$iter): object 'dat_long' not found</code></pre>
<div class="sourceCode" id="cb365"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Xobs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">[</span>,<span class="op">-</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">iter.cond</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">c</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">{</span>
  <span class="va">cc</span> <span class="op">&lt;-</span> <span class="va">iter.cond</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>
  <span class="va">Xexp</span> <span class="op">&lt;-</span> <span class="va">dat_long</span><span class="op">[</span><span class="va">dat_long</span><span class="op">$</span><span class="va">chain</span><span class="op">==</span><span class="va">c</span> <span class="op">&amp;</span> <span class="va">dat_long</span><span class="op">$</span><span class="va">iter</span><span class="op">==</span><span class="va">cc</span> , <span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_wider</span><span class="op">(</span>
      id_cols <span class="op">=</span> <span class="va">person</span>,
      names_from <span class="op">=</span> <span class="st">"item"</span>,
      values_from <span class="op">=</span> <span class="st">"x.exp"</span>,
      names_prefix <span class="op">=</span> <span class="st">"item"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span>
    <span class="fu">select</span><span class="op">(</span><span class="va">item1</span><span class="op">:</span><span class="va">item5</span><span class="op">)</span><span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span>
  <span class="va">Xppd</span> <span class="op">&lt;-</span> <span class="va">dat_long</span><span class="op">[</span><span class="va">dat_long</span><span class="op">$</span><span class="va">chain</span><span class="op">==</span><span class="va">c</span> <span class="op">&amp;</span> <span class="va">dat_long</span><span class="op">$</span><span class="va">iter</span><span class="op">==</span><span class="va">cc</span> , <span class="op">]</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_wider</span><span class="op">(</span>
      id_cols <span class="op">=</span> <span class="va">person</span>,
      names_from <span class="op">=</span> <span class="st">"item"</span>,
      values_from <span class="op">=</span> <span class="st">"x.ppd"</span>,
      names_prefix <span class="op">=</span> <span class="st">"item"</span>
    <span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span><span class="op">%&gt;%</span>
    <span class="fu">select</span><span class="op">(</span><span class="va">item1</span><span class="op">:</span><span class="va">item5</span><span class="op">)</span><span class="op">%&gt;%</span>
    <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="op">)</span>

  <span class="co"># compute realized values</span>
  <span class="va">realized.SMBC.array</span><span class="op">[</span><span class="va">ii</span>, ,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">calculate.SMBC.matrix</span><span class="op">(</span><span class="va">Xobs</span>, <span class="va">Xexp</span><span class="op">)</span>
  <span class="va">realized.SGDDM.vector</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu">calculate.SGDDM</span><span class="op">(</span><span class="va">Xobs</span>, <span class="va">Xexp</span><span class="op">)</span>
  <span class="co"># compute PPD values</span>
  <span class="va">postpred.SMBC.array</span><span class="op">[</span><span class="va">ii</span>, ,<span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">calculate.SMBC.matrix</span><span class="op">(</span><span class="va">Xppd</span>, <span class="va">Xexp</span><span class="op">)</span>
  <span class="va">postpred.SGDDM.vector</span><span class="op">[</span><span class="va">ii</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="fu">calculate.SGDDM</span><span class="op">(</span><span class="va">Xppd</span>, <span class="va">Xexp</span><span class="op">)</span>
    <span class="va">ii</span> <span class="op">&lt;-</span> <span class="va">ii</span> <span class="op">+</span> <span class="fl">1</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'iter.cond' not found</code></pre>
<p>Next, generate plots to help summarize and describe the posterior predictor distributions of these statistics.</p>
<div class="sourceCode" id="cb367"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot.dat.ppd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  real <span class="op">=</span> <span class="va">realized.SGDDM.vector</span>,
  ppd <span class="op">=</span> <span class="va">postpred.SGDDM.vector</span>
<span class="op">)</span></code></pre></div>
<pre><code>## Error in data.frame(real = realized.SGDDM.vector, ppd = postpred.SGDDM.vector): object 'realized.SGDDM.vector' not found</code></pre>
<div class="sourceCode" id="cb369"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">plot.dat.ppd</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">real</span>, y<span class="op">=</span><span class="va">ppd</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">lims</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in ggplot(plot.dat.ppd, aes(x = real, y = ppd)): object 'plot.dat.ppd' not found</code></pre>
<div class="sourceCode" id="cb371"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># transform smbc into plotable format</span>
<span class="va">ddim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">postpred.SMBC.array</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'postpred.SMBC.array' not found</code></pre>
<div class="sourceCode" id="cb373"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot.dat.ppd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow<span class="op">=</span><span class="va">ddim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">ddim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">ddim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, ncol<span class="op">=</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in matrix(0, nrow = ddim[1] * ddim[2] * ddim[3], ncol = 4): object 'ddim' not found</code></pre>
<div class="sourceCode" id="cb375"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">plot.dat.ppd</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"itemj"</span>, <span class="st">"itemjj"</span>, <span class="st">"real"</span>, <span class="st">"ppd"</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in colnames(plot.dat.ppd) &lt;- c("itemj", "itemjj", "real", "ppd"): object 'plot.dat.ppd' not found</code></pre>
<div class="sourceCode" id="cb377"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ii</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">j</span> <span class="op">&lt;-</span> <span class="va">jj</span> <span class="op">&lt;-</span> <span class="fl">1</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ddim</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ddim</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">for</span><span class="op">(</span><span class="va">jj</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ddim</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">{</span>
      <span class="va">plot.dat.ppd</span><span class="op">[</span><span class="va">ii</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">j</span>
      <span class="va">plot.dat.ppd</span><span class="op">[</span><span class="va">ii</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">jj</span>
      <span class="va">plot.dat.ppd</span><span class="op">[</span><span class="va">ii</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">realized.SMBC.array</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">jj</span><span class="op">]</span>
      <span class="va">plot.dat.ppd</span><span class="op">[</span><span class="va">ii</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">postpred.SMBC.array</span><span class="op">[</span><span class="va">i</span>, <span class="va">j</span>, <span class="va">jj</span><span class="op">]</span>
      <span class="va">ii</span> <span class="op">&lt;-</span> <span class="va">ii</span> <span class="op">+</span> <span class="fl">1</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<pre><code>## Error in eval(expr, envir, enclos): object 'ddim' not found</code></pre>
<div class="sourceCode" id="cb379"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">plot.dat.ppd</span> <span class="op">&lt;-</span> <span class="va">plot.dat.ppd</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">itemj</span> <span class="op">&lt;</span> <span class="va">itemjj</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>
    cov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"cov("</span>, <span class="va">itemj</span>, <span class="st">", "</span>, <span class="va">itemjj</span>,<span class="st">")"</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<pre><code>## Error in filter(., itemj &lt; itemjj): object 'plot.dat.ppd' not found</code></pre>
<div class="sourceCode" id="cb381"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">plot.dat.ppd</span>, <span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">real</span>, y<span class="op">=</span><span class="va">ppd</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_point</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.25</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_density2d</span><span class="op">(</span>adjust<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_abline</span><span class="op">(</span>intercept <span class="op">=</span> <span class="fl">0</span>, slope<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="va">.</span><span class="op">~</span><span class="va">cov</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">lims</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_classic</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## Error in ggplot(plot.dat.ppd, aes(x = real, y = ppd)): object 'plot.dat.ppd' not found</code></pre>
<!-- ## LSAT Example - OpenBUGS -->
<!-- ```{r chp11-lsat-openbugs, warnings=T, message=T, error=T, cache=TRUE} -->
<!-- # model code -->
<!-- model.file <- paste0(w.d,"/code/IRT-for-Dichotomous-Observables/WinBUGS/3PNO.bug") -->
<!-- cat(model.file) -->
<!-- # get data file -->
<!-- data.file <- paste0(w.d,"/code/IRT-for-Dichotomous-Observables/WinBUGS/data.txt") -->
<!-- # initial values -->
<!-- start_values <- list( -->
<!--   list("d"=c(1.00, 1.00, 1.00, 1.00, 1.00), -->
<!--        "a"=c(1.00, 1.00, 1.00, 1.00, 1.00), -->
<!--        "c"=c(0.20, 0.20, 0.20, 0.20, 0.20)), -->
<!--   list("d"=c(-3.00, -3.00, -3.00, -3.00, -3.00), -->
<!--        "a"=c(3.00, 3.00, 3.00, 3.00, 3.00), -->
<!--        "c"=c(0.50, 0.50, 0.50, 0.50, 0.50)), -->
<!--   list("d"=c(3.00, 3.00, 3.00, 3.00, 3.00), -->
<!--        "a"=c(0.1, 0.1, 0.1, 0.1, 0.1), -->
<!--        "c"=c(0.05, 0.05, 0.05, 0.05, 0.05)) -->
<!-- ) -->
<!-- # vector of all parameters to save -->
<!-- param_save <- c("a", "c", "d", "theta") -->
<!-- # fit model -->
<!-- fit <- openbugs( -->
<!--   data= data.file,  -->
<!--   model.file = model.file, # R grabs the file and runs it in openBUGS -->
<!--   parameters.to.save = param_save, -->
<!--   #inits=start_values, -->
<!--   n.chains = 1, -->
<!--   n.iter = 2000, -->
<!--   n.burnin = 1000 -->
<!-- ) -->
<!-- print(fit) -->
<!-- ``` -->
</div>
</div>
<div id="lsat-example---stan" class="section level2" number="11.4">
<h2>
<span class="header-section-number">11.4</span> LSAT Example - Stan<a class="anchor" aria-label="anchor" href="#lsat-example---stan"><i class="fas fa-link"></i></a>
</h2>
<p>TO-DO</p>
</div>
<div id="irt-models-for-polytomous-data" class="section level2" number="11.5">
<h2>
<span class="header-section-number">11.5</span> IRT Models for Polytomous Data<a class="anchor" aria-label="anchor" href="#irt-models-for-polytomous-data"><i class="fas fa-link"></i></a>
</h2>
<p>A commonly used IRT model for polytomous items is the graded response model (GRM).
Below is one way of describing the model.
Let <span class="math inline">\(x_{ij}\)</span> be the observed response to item <span class="math inline">\(j\)</span> from examinee <span class="math inline">\(i\)</span> that may take on values 1, 2, …, <span class="math inline">\(K_j\)</span>, where <span class="math inline">\(K_j\)</span> is the number of possible responses/outcomes for item <span class="math inline">\(j\)</span>.
In many applications, the number of response options is constant across items, though this need not be the case.
The GRM using conditional probability statements about the probability of a response being at or above a specific category and obtaining the probability for each category as a difference of two such conditional probabilities.
That is
<span class="math display">\[P(x_{ij} = k \mid \theta_i, \boldsymbol{d}_j,a_j) = P(x_{ij} \geq k \mid \theta_i, d_{jk},a_j) - P(x_{ij \geq k+1 \mid \theta_i, d_{j(k+1)},a_j),\]</span>
where <span class="math inline">\(\boldsymbol{d}_j\)</span> is the collection of location/threshold parameters for item <span class="math inline">\(j\)</span>.
The GRM takes on a structure similar to the 2-PL for any one category
<span class="math display">\[P(x_{ij} \geq k \mid \theta_i, d_{jk},a_j)=F(a_j\theta_i + d_{jk}).\]</span></p>
<p>The conditional probability of observed responses may be modeled similarly as we have used for dichotomous responses but with a few important differences.
The conditional distribution of the data is
<span class="math display">\[p(\boldsymbol{x}\mid \boldsymbol{\theta},\boldsymbol{\omega}) = \prod_{i=1}^np(\boldsymbol{x}_i\mid \theta_i, \boldsymbol{\omega}) = \prod_{i=1}^n\prod_{j=1}^Jp(x_{ij}\mid \theta_i, \boldsymbol{\omega}_j),\]</span>
where each <span class="math inline">\(x_{ij}\)</span> is specified as a categorical random variable (or multinomial).
A categorical random variable is a generalization of the Bernoulli distribution which is defined be the collection of category response probabilities
<span class="math display">\[x_{ij} \sim \mathrm{Categorical}(\boldsymbol{P}(x_{ij}\mid\theta_i, \boldsymbol{\omega}_j)).\]</span></p>
<p>The above helps form the likelihood of the observed data.
Next, the prior distribution is described because what the structure should be is not necessarily obvious.</p>
<p>First, the prior for the latent ability follows the same logic from the dichotomous model.
We employ an exchangeability assumption to specify independent priors for each respondent with a normally distribution prior.</p>
<p>Next, the measurement model parameters’ priors are described.
We again can assume exchangeability and arrive at a common but independent prior across items, and assume that the priors for the location and discrimination parameters are independent.
These assumptions may not be tenable in theory, but they are practically useful.
The priors for discrimination stay the same as the dichotomous model.
The priors for the location parameters are a bit more involved.</p>
<p>For the location parameters, the first location parameter <span class="math inline">\(d_{j1}\)</span> specifies the probability of responding a 1 or greater which is a certainty if they gave a response.
Therefore, the probability would be 1.
We set <span class="math inline">\(d_{j1} = -\inf\)</span> and then set a normal prior for <span class="math inline">\(d_{j2}\sim \mathrm{Normal}(\mu_{d2},\sigma^2_{d2})\)</span>.
The priors for the remaining location parameters (<span class="math inline">\(d_{3}-d_{k}\)</span>) can be specified as truncated normal distributions.
That is, the location of the next threshold is constrained to be larger than the previous threshold and is formally
<span class="math display">\[d_{jk} \sim \mathrm{Normal}^{&gt;d_{j(k-1)}}(\mu_{d_k},\sigma^2_{d_k},\ \mathrm{for}\ k=3, ...,K_j.\]</span></p>
<p>The posterior distribution for the GRM can be parameterized as follows.
The model as described below is very general and can accommodate varying number of thresholds per item but is constrained to only 1 latent factor.</p>
<p><span class="math display">\[p(\boldsymbol{\theta}, \boldsymbol{d}, \boldsymbol{a}\mid \mathbf{x}) \propto \prod_{i=1}^n\prod_{j=1}^Jp(\theta_i\mid\theta_i, \boldsymbol{d}_j, a_j)p(\theta_i)p(a_j)\prod_{k=2}^{K_j}p(d_{jk}),\]</span>
where
<span class="math display">\[\begin{align*}
x_{ij}\mid\theta_i\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;\sim \mathrm{Categorical}(\boldsymbol{P}(x_{ij}\mid\theta_i, \boldsymbol{\omega}_j)),\ \mathrm{for}\ i=1, \cdots, n,\ j = 1, \cdots, J;\\
\mathbf{P}(x_{ij}\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;= \left(P(x_{ij}=1\mid\theta_i, \boldsymbol{d}_j, a_j), \cdots, P(x_{ij}=K_j\mid\theta_i, \boldsymbol{d}_j, a_j)\right),\ \mathrm{for}\ i=1, \cdots, n,\ j = 1, \cdots, J;\\
P(x_{ij}=k\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;= P(x_{ij}\geq k\mid\theta_i,d_{jk}, a_j) - P(x_{ij}\geq k+1\mid\theta_i, d_{j(k+1)}, a_j),\ \mathrm{for}\ i=1, \cdots, n,\ j = 1, \cdots, J,\ k = 1,\cdots,K_j-1;\\
P(x_{ij}=K_j\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;= P(x_{ij}\geq K_j\mid\theta_i,d_{jK_j}, a_j),\ \mathrm{for}\ i=1, \cdots, n,\ j = 1, \cdots, J;\\
P(x_{ij}\geq k\mid\theta_i, d_{jk}, a_j) &amp;= F(a_j\theta_j + d_{jk}),\ \mathrm{for}\ i=1, \cdots, n,\ j = 1, \cdots, J,\ k=2,\cdots,K_j;\\
P(x_{ij}\geq 1\mid\theta_i, d_{j1}, a_j) &amp;= 1,\ \mathrm{for}\ i=1, \cdots, n,\ j = 1, \cdots, J;\\
\theta_i \mid \mu_{\theta}, \sigma^2_{\theta} &amp;\sim \mathrm{Normal}(\mu_{\theta}, \sigma^2_{\theta}),\ \mathrm{for}\ i = 1, \cdots, n;\\
a_j \mid \mu_{a}, \sigma^2_{a} &amp;\sim \mathrm{Normal}^{+}(\mu_{a}, \sigma^2_{a}),\ \mathrm{for}\ j=1, \cdots, J;\\
d_{j2}\mid\mu_{j2}, \sigma^2_{j2} &amp;\sim \mathrm{Normal}(\mu_{j2}, \sigma^2_{j2} ),\ \mathrm{for}\ j=1, \cdots, J;\ \mathrm{and}\\
d_{jk}\mid\mu_{d_{jk}},\sigma^2_{d_{jk}} &amp;\sim \mathrm{Normal}^{&gt;d_{j(k-1)}}(\mu_{d_{jk}},\sigma^2_{d_{jk}}),\ \mathrm{for}\ j=1, \cdots, J,\ k=3, ...,K_j.
\end{align*}\]</span></p>
</div>
<div id="grm-peer-interactions-example" class="section level2" number="11.6">
<h2>
<span class="header-section-number">11.6</span> GRM Peer Interactions Example<a class="anchor" aria-label="anchor" href="#grm-peer-interactions-example"><i class="fas fa-link"></i></a>
</h2>
<p>The book uses an example of Peer Interactions from 500 responses to seven items. All the responses are coded from 1 to 5 on an agreement Likert-type scale.
A DAG for the GRM corresponding to these data is shown below.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chp11-dag-2"></span>
<img src="dag/chp11-grm.png" alt="DAG for the for Peer Interactions GRM analysis" width="90%" height="90%"><p class="caption">
Figure 11.4: DAG for the for Peer Interactions GRM analysis
</p>
</div>
<p>The path diagram version is substantially simpler and identical to the path diagram for the 3-PL and factor analysis diagrams.
Highlighting the similarity in <em>substantive</em> modeling of polytomous items to dichotomous items.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chp11-pathdiag-2"></span>
<img src="path-diagram/chp11-grm.png" alt="Path diagram for the Peer Interactions GRM analysis" width="90%" height="90%"><p class="caption">
Figure 11.5: Path diagram for the Peer Interactions GRM analysis
</p>
</div>
<p>For completeness, I have included the model specification diagram that more concretely connects the DAG and path diagram to the assumed distributions and priors.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:chp11-spec-2"></span>
<img src="model-spec/chp11-grm.png" alt="Model specification diagram for the Peer Interactions GRM analysis" width="90%" height="90%"><p class="caption">
Figure 11.6: Model specification diagram for the Peer Interactions GRM analysis
</p>
</div>
<div id="example-specific-model-specification" class="section level3" number="11.6.1">
<h3>
<span class="header-section-number">11.6.1</span> Example Specific Model Specification<a class="anchor" aria-label="anchor" href="#example-specific-model-specification"><i class="fas fa-link"></i></a>
</h3>
<p>In fitting the GRM to the Peer Interactions data, we can be more precise about the prior and likelihood structure.
Below is a breakdown of the model specific to this example.
Everything is structurally identical to the previous page but specific values are chosen for the hyperparameters.</p>
<p><span class="math display">\[p(\boldsymbol{\theta}, \boldsymbol{d}, \boldsymbol{a}\mid \mathbf{x}) \propto \prod_{i=1}^n\prod_{j=1}^Jp(\theta_i\mid\theta_i, \boldsymbol{d}_j, a_j)p(\theta_i)p(a_j)\prod_{k=2}^{K_j}p(d_{jk}),\]</span>
where
<span class="math display">\[\begin{align*}
x_{ij}\mid\theta_i\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;\sim \mathrm{Categorical}(\boldsymbol{P}(x_{ij}\mid\theta_i, \boldsymbol{\omega}_j)),\ \mathrm{for}\ i=1, \cdots, 500,\ j = 1, \cdots, 7;\\
\mathbf{P}(x_{ij}\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;= \left(P(x_{ij}=1\mid\theta_i, \boldsymbol{d}_j, a_j), \cdots, P(x_{ij}=5\mid\theta_i, \boldsymbol{d}_j, a_j)\right),\ \mathrm{for}\ i=1, \cdots, 500,\ j = 1, \cdots, 7;\\
P(x_{ij}=k\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;= P(x_{ij}\geq k\mid\theta_i,d_{jk}, a_j) - P(x_{ij}\geq k+1\mid\theta_i, d_{j(k+1)}, a_j),\ \mathrm{for}\ i=1, \cdots, 500,\ j = 1, \cdots, 7,\ k = 1,\cdots,4;\\
P(x_{ij}=5\mid\theta_i, \boldsymbol{d}_j, a_j) &amp;= P(x_{ij}\geq 5\mid\theta_i,d_{j5}, a_j),\ \mathrm{for}\ i=1, \cdots, 500,\ j = 1, \cdots, 7;\\
P(x_{ij}\geq k\mid\theta_i, d_{jk}, a_j) &amp;= F(a_j\theta_j + d_{jk}) = \frac{\exp\left(a_j\theta_i +d_{jk}\right)}{1+\exp\left(a_j\theta_i +d_{jk}\right)},\ \mathrm{for}\ i=1, \cdots, 500,\ j = 1, \cdots, 7,\ k=2,\cdots,5;\\
P(x_{ij}\geq 1\mid\theta_i, d_{j1}, a_j) &amp;= 1,\ \mathrm{for}\ i=1, \cdots, 500,\ j = 1, \cdots, 7;\\
\theta_i \mid \mu_{\theta}, \sigma^2_{\theta} &amp;\sim \mathrm{Normal}(0, 1),\ \mathrm{for}\ i = 1, \cdots, 500;\\
a_j \mid \mu_{a}, \sigma^2_{a} &amp;\sim \mathrm{Normal}^{+}(0,2),\ \mathrm{for}\ j=1, \cdots, 7;\\
d_{j2}\mid\mu_{d_{j2}}, \sigma^2_{d_{j2}} &amp;\sim \mathrm{Normal}(2,2),\ \mathrm{for}\ j=1, \cdots, 7;\\
d_{j3}\mid\mu_{d_{j3}},\sigma^2_{d_{j3}} &amp;\sim \mathrm{Normal}^{&gt;d_{j2}}(1, 2),\ \mathrm{for}\ j=1, \cdots, 7;\\
d_{j4}\mid\mu_{d_{j4}},\sigma^2_{d_{j4}} &amp;\sim \mathrm{Normal}^{&gt;d_{j3}}(-1, 2),\ \mathrm{for}\ j=1, \cdots, 7; \mathrm{and}\\
d_{j5}\mid\mu_{d_{j5}},\sigma^2_{d_{j5}} &amp;\sim \mathrm{Normal}^{&gt;d_{j4}}(-2, 2),\ \mathrm{for}\ j=1, \cdots, 7.
\end{align*}\]</span></p>
</div>
</div>
<div id="pi-example---jags" class="section level2" number="11.7">
<h2>
<span class="header-section-number">11.7</span> PI Example - JAGS<a class="anchor" aria-label="anchor" href="#pi-example---jags"><i class="fas fa-link"></i></a>
</h2>
<p>In the below implementation, I had to change <code>d[j,3] ~ dnorm(1, .5)I(d[j,4],d[j,2])</code> to <code>d[j,3] ~ dnorm(1, .5);I(,d[j,2])</code> because (1) R is dumb and doesn’t realize that <code>I</code> is a JAGS function; and (2) JAGS does not allow for a <code>directed cycle</code>.
The directed cycle in the DAG is when the range of values for <code>d[j,3]</code> is fixed to be within <code>I(d[j,4],d[j,2])</code> and is not permissible. We need to simply constrain the thresholds to be decreasing or smaller than the previous threshold.
I’m not sure of the underlying technical reason for this error, but I found that adding the semi-colon fixes the issue when defining the model as an R function.</p>
<div class="sourceCode" id="cb383"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jags.model.peer.int</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>

  <span class="co">#######################################</span>
  <span class="co"># Specify the item response measurement model for the observables</span>
  <span class="co">#######################################</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
    <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
  
      <span class="co">###################################</span>
      <span class="co"># Specify the probabilities of a value being greater than or equal to each category</span>
      <span class="co">###################################</span>
      <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
        <span class="co"># P(greater than or equal to category k &gt; 1)</span>
        <span class="fu">logit</span><span class="op">(</span><span class="va">P.gte</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">k</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="va">k</span><span class="op">]</span>
      <span class="op">}</span>
      <span class="co"># P(greater than or equal to category 1)</span>
      <span class="va">P.gte</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  
  
      <span class="co">###################################</span>
      <span class="co"># Specify the probabilities of a value being equal to each category</span>
      <span class="co">###################################</span>
      <span class="kw">for</span><span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">K</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
        <span class="co"># P(greater equal to category k &lt; K)</span>
        <span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">P.gte</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">k</span><span class="op">]</span><span class="op">-</span><span class="va">P.gte</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>
      <span class="op">}</span>
      <span class="co"># P(greater equal to category K)</span>
      <span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">K</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">P.gte</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="va">K</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span>
      
      <span class="co">###################################</span>
      <span class="co"># Specify the distribution for each observable</span>
      <span class="co">###################################</span>
      <span class="va">x</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dcat</span><span class="op">(</span><span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span>,<span class="fl">1</span><span class="op">:</span><span class="va">K</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
  
  
  <span class="co">#######################################</span>
  <span class="co"># Specify the (prior) distribution for the latent variables</span>
  <span class="co">#######################################</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
    <span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># distribution for the latent variables</span>
  <span class="op">}</span>
  
  
  <span class="co">#######################################</span>
  <span class="co"># Specify the prior distribution for the measurement model parameters</span>
  <span class="co">#######################################</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
    
    <span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">.5</span><span class="op">)</span>                   <span class="co"># Locations for k = 2</span>
    <span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span>,<span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>   <span class="co"># Locations for k = 3</span>
    <span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">4</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span>,<span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span>  <span class="co"># Locations for k = 4</span>
    <span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">5</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">.5</span><span class="op">)</span>;<span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span>,<span class="va">d</span><span class="op">[</span><span class="va">j</span>,<span class="fl">4</span><span class="op">]</span><span class="op">)</span>        <span class="co"># Locations for k = 5</span>
    <span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">)</span>    <span class="co"># Discriminations for observables</span>
  
  <span class="op">}</span>

<span class="op">}</span> <span class="co"># closes the model</span>

<span class="co"># initial values</span>
<span class="va">start_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    d<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span><span class="op">)</span>,
      ncol<span class="op">=</span><span class="fl">5</span>, nrow<span class="op">=</span><span class="fl">7</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    d<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span><span class="op">)</span>,
      ncol<span class="op">=</span><span class="fl">5</span>, nrow<span class="op">=</span><span class="fl">7</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
    d<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span>,
               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">1.00E+00</span>, <span class="op">-</span><span class="fl">2.00E+00</span>, <span class="op">-</span><span class="fl">3.00E+00</span><span class="op">)</span>,
              ncol<span class="op">=</span><span class="fl">5</span>, nrow<span class="op">=</span><span class="fl">7</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span>,
    a<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># vector of all parameters to save</span>
<span class="va">param_save</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="st">"theta"</span><span class="op">)</span>

<span class="co"># dataset</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/PI.dat"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>, J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,
  K <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># fit model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">jags</span><span class="op">(</span>
  model.file<span class="op">=</span><span class="va">jags.model.peer.int</span>,
  data<span class="op">=</span><span class="va">mydata</span>,
  inits<span class="op">=</span><span class="va">start_values</span>,
  parameters.to.save <span class="op">=</span> <span class="va">param_save</span>,
  n.iter<span class="op">=</span><span class="fl">2000</span>,
  n.burnin <span class="op">=</span> <span class="fl">1000</span>,
  n.chains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 3500
##    Unobserved stochastic nodes: 535
##    Total graph size: 53050
## 
## Initializing model
## 
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |++                                                |   4%
  |                                                        
  |++++                                              |   8%
  |                                                        
  |++++++                                            |  12%
  |                                                        
  |++++++++                                          |  16%
  |                                                        
  |++++++++++                                        |  20%
  |                                                        
  |++++++++++++                                      |  24%
  |                                                        
  |++++++++++++++                                    |  28%
  |                                                        
  |++++++++++++++++                                  |  32%
  |                                                        
  |++++++++++++++++++                                |  36%
  |                                                        
  |++++++++++++++++++++                              |  40%
  |                                                        
  |++++++++++++++++++++++                            |  44%
  |                                                        
  |++++++++++++++++++++++++                          |  48%
  |                                                        
  |++++++++++++++++++++++++++                        |  52%
  |                                                        
  |++++++++++++++++++++++++++++                      |  56%
  |                                                        
  |++++++++++++++++++++++++++++++                    |  60%
  |                                                        
  |++++++++++++++++++++++++++++++++                  |  64%
  |                                                        
  |++++++++++++++++++++++++++++++++++                |  68%
  |                                                        
  |++++++++++++++++++++++++++++++++++++              |  72%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++            |  76%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++          |  80%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++        |  84%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++      |  88%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++    |  92%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |**                                                |   4%
  |                                                        
  |****                                              |   8%
  |                                                        
  |******                                            |  12%
  |                                                        
  |********                                          |  16%
  |                                                        
  |**********                                        |  20%
  |                                                        
  |************                                      |  24%
  |                                                        
  |**************                                    |  28%
  |                                                        
  |****************                                  |  32%
  |                                                        
  |******************                                |  36%
  |                                                        
  |********************                              |  40%
  |                                                        
  |**********************                            |  44%
  |                                                        
  |************************                          |  48%
  |                                                        
  |**************************                        |  52%
  |                                                        
  |****************************                      |  56%
  |                                                        
  |******************************                    |  60%
  |                                                        
  |********************************                  |  64%
  |                                                        
  |**********************************                |  68%
  |                                                        
  |************************************              |  72%
  |                                                        
  |**************************************            |  76%
  |                                                        
  |****************************************          |  80%
  |                                                        
  |******************************************        |  84%
  |                                                        
  |********************************************      |  88%
  |                                                        
  |**********************************************    |  92%
  |                                                        
  |************************************************  |  96%
  |                                                        
  |**************************************************| 100%</code></pre>
<div class="sourceCode" id="cb385"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## Inference for Bugs model at "C:/Users/noahp/AppData/Local/Temp/RtmpQR8sbs/model454427434e8.txt", fit using jags,
##  3 chains, each with 2000 iterations (first 1000 discarded)
##  n.sims = 3000 iterations saved
##             mu.vect sd.vect     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## a[1]          2.136   0.164    1.845    2.024    2.126    2.239    2.481 1.006   670
## a[2]          3.521   0.260    3.016    3.346    3.518    3.696    4.032 1.008   270
## a[3]          3.957   0.303    3.356    3.758    3.959    4.149    4.550 1.004   530
## a[4]          3.576   0.252    3.104    3.401    3.571    3.747    4.088 1.008   260
## a[5]          2.444   0.171    2.124    2.323    2.437    2.563    2.786 1.009   270
## a[6]          1.866   0.151    1.587    1.761    1.861    1.965    2.171 1.011   200
## a[7]          1.495   0.121    1.255    1.413    1.492    1.577    1.730 1.004  2300
## d[1,2]        4.952   0.328    4.343    4.735    4.949    5.156    5.639 1.002  1000
## d[2,2]        5.185   0.355    4.529    4.936    5.169    5.420    5.915 1.007   330
## d[3,2]        6.513   0.482    5.575    6.188    6.506    6.830    7.485 1.003  1400
## d[4,2]        6.385   0.435    5.593    6.086    6.373    6.676    7.251 1.004   650
## d[5,2]        4.768   0.312    4.184    4.562    4.759    4.973    5.403 1.013   200
## d[6,2]        3.833   0.258    3.362    3.653    3.825    4.007    4.361 1.013   160
## d[7,2]        4.274   0.286    3.723    4.080    4.265    4.460    4.852 1.001  2400
## d[1,3]        2.943   0.211    2.536    2.800    2.939    3.085    3.370 1.003   970
## d[2,3]        1.169   0.201    0.756    1.046    1.174    1.300    1.563 1.020   240
## d[3,3]        3.323   0.296    2.753    3.120    3.329    3.508    3.930 1.002  2300
## d[4,3]        2.703   0.242    2.261    2.536    2.695    2.859    3.194 1.009   270
## d[5,3]        2.672   0.203    2.268    2.540    2.676    2.805    3.073 1.013   200
## d[6,3]        1.949   0.164    1.626    1.837    1.951    2.059    2.275 1.012   200
## d[7,3]        2.443   0.167    2.120    2.330    2.446    2.557    2.762 1.004   710
## d[1,4]        0.645   0.146    0.362    0.547    0.644    0.741    0.934 1.006   360
## d[2,4]       -1.785   0.222   -2.239   -1.929   -1.780   -1.627   -1.370 1.020   110
## d[3,4]       -1.325   0.233   -1.837   -1.467   -1.312   -1.164   -0.903 1.024    90
## d[4,4]       -0.806   0.206   -1.253   -0.933   -0.797   -0.672   -0.425 1.019   160
## d[5,4]       -0.356   0.156   -0.670   -0.455   -0.353   -0.249   -0.059 1.011   190
## d[6,4]       -0.490   0.131   -0.767   -0.571   -0.488   -0.403   -0.240 1.007   650
## d[7,4]        0.263   0.116    0.038    0.186    0.266    0.341    0.482 1.008   290
## d[1,5]       -2.511   0.186   -2.887   -2.636   -2.507   -2.379   -2.157 1.007   320
## d[2,5]       -5.140   0.368   -5.858   -5.374   -5.137   -4.885   -4.446 1.011   200
## d[3,5]       -5.562   0.419   -6.453   -5.830   -5.553   -5.272   -4.757 1.013   170
## d[4,5]       -4.855   0.348   -5.562   -5.083   -4.832   -4.625   -4.196 1.017   220
## d[5,5]       -3.605   0.243   -4.092   -3.762   -3.600   -3.436   -3.153 1.003  3000
## d[6,5]       -3.210   0.214   -3.631   -3.355   -3.205   -3.061   -2.806 1.009   530
## d[7,5]       -2.748   0.179   -3.112   -2.865   -2.740   -2.625   -2.413 1.004   650
## theta[1]      0.855   0.285    0.283    0.669    0.853    1.050    1.390 1.001  3000
## theta[2]     -0.976   0.268   -1.499   -1.152   -0.970   -0.802   -0.457 1.002  1000
## theta[3]     -1.040   0.252   -1.546   -1.205   -1.041   -0.871   -0.539 1.002  1100
## theta[4]     -0.257   0.258   -0.769   -0.428   -0.252   -0.083    0.242 1.001  3000
## theta[5]      0.113   0.274   -0.412   -0.070    0.124    0.293    0.636 1.001  3000
## theta[6]      0.107   0.248   -0.364   -0.062    0.107    0.272    0.598 1.004   570
## theta[7]      1.470   0.330    0.861    1.244    1.456    1.683    2.147 1.005   600
## theta[8]      0.787   0.258    0.292    0.608    0.788    0.964    1.297 1.001  3000
## theta[9]      0.004   0.253   -0.495   -0.166    0.008    0.173    0.503 1.004   580
## theta[10]     0.371   0.267   -0.130    0.194    0.367    0.543    0.896 1.001  3000
## theta[11]    -0.758   0.259   -1.266   -0.938   -0.754   -0.585   -0.231 1.001  2100
## theta[12]    -0.195   0.253   -0.697   -0.365   -0.194   -0.028    0.300 1.003   830
## theta[13]     1.036   0.267    0.521    0.857    1.036    1.210    1.562 1.003   720
## theta[14]     0.006   0.261   -0.516   -0.164    0.009    0.183    0.520 1.002  1600
## theta[15]    -0.698   0.267   -1.219   -0.880   -0.704   -0.518   -0.176 1.003   810
## theta[16]    -0.449   0.292   -1.001   -0.654   -0.451   -0.253    0.124 1.001  3000
## theta[17]     2.349   0.463    1.582    2.021    2.299    2.619    3.407 1.001  3000
## theta[18]     0.232   0.260   -0.271    0.062    0.236    0.404    0.744 1.002  2000
## theta[19]     0.045   0.260   -0.457   -0.133    0.046    0.216    0.564 1.001  3000
## theta[20]     0.240   0.263   -0.282    0.069    0.242    0.415    0.749 1.002  1300
## theta[21]     0.370   0.259   -0.139    0.198    0.370    0.543    0.883 1.001  3000
## theta[22]    -1.004   0.267   -1.518   -1.189   -1.003   -0.829   -0.479 1.001  2500
## theta[23]     0.698   0.265    0.195    0.520    0.699    0.869    1.231 1.003   900
## theta[24]     0.059   0.263   -0.468   -0.116    0.060    0.237    0.562 1.002  3000
## theta[25]     2.356   0.452    1.589    2.028    2.316    2.637    3.354 1.002  2900
## theta[26]     0.549   0.303   -0.038    0.342    0.539    0.758    1.137 1.001  3000
## theta[27]    -0.753   0.269   -1.275   -0.924   -0.759   -0.581   -0.192 1.002  1300
## theta[28]     0.214   0.260   -0.298    0.044    0.217    0.392    0.728 1.004   600
## theta[29]     1.074   0.290    0.525    0.876    1.063    1.267    1.662 1.003  3000
## theta[30]     0.373   0.263   -0.146    0.201    0.371    0.547    0.890 1.001  3000
## theta[31]     0.489   0.258   -0.019    0.311    0.484    0.659    1.002 1.002  1800
## theta[32]     0.438   0.261   -0.069    0.261    0.437    0.608    0.958 1.001  3000
## theta[33]     0.439   0.268   -0.102    0.256    0.441    0.617    0.973 1.001  3000
## theta[34]     0.137   0.261   -0.377   -0.037    0.141    0.309    0.652 1.002  3000
## theta[35]    -1.317   0.268   -1.848   -1.494   -1.319   -1.143   -0.770 1.003   890
## theta[36]     0.783   0.256    0.282    0.615    0.779    0.956    1.284 1.005   430
## theta[37]    -0.516   0.260   -1.010   -0.694   -0.524   -0.347    0.022 1.004   610
## theta[38]    -0.727   0.250   -1.222   -0.887   -0.725   -0.562   -0.240 1.002  1900
## theta[39]    -0.461   0.296   -1.048   -0.659   -0.460   -0.262    0.124 1.004  1400
## theta[40]    -0.128   0.272   -0.669   -0.310   -0.123    0.058    0.392 1.006   370
## theta[41]     0.228   0.278   -0.308    0.041    0.231    0.411    0.784 1.001  3000
## theta[42]    -2.225   0.354   -2.982   -2.452   -2.204   -1.975   -1.596 1.001  3000
## theta[43]     2.103   0.389    1.447    1.833    2.075    2.338    3.007 1.001  3000
## theta[44]    -0.396   0.303   -0.988   -0.606   -0.389   -0.195    0.189 1.001  3000
## theta[45]     2.361   0.481    1.556    2.028    2.303    2.647    3.514 1.001  3000
## theta[46]     0.796   0.262    0.281    0.625    0.790    0.966    1.331 1.001  3000
## theta[47]    -0.845   0.274   -1.381   -1.032   -0.841   -0.664   -0.312 1.002  1200
## theta[48]    -0.168   0.266   -0.701   -0.340   -0.160    0.015    0.322 1.002  2100
## theta[49]     0.178   0.270   -0.339    0.006    0.171    0.353    0.719 1.002  1100
## theta[50]    -0.582   0.285   -1.128   -0.775   -0.589   -0.389   -0.028 1.001  3000
## theta[51]    -0.377   0.262   -0.900   -0.554   -0.374   -0.199    0.130 1.005   440
## theta[52]    -0.998   0.260   -1.508   -1.177   -1.005   -0.828   -0.476 1.001  3000
## theta[53]     0.444   0.266   -0.082    0.266    0.446    0.628    0.951 1.001  3000
## theta[54]     0.380   0.272   -0.164    0.203    0.378    0.559    0.916 1.002  1900
## theta[55]    -0.829   0.271   -1.362   -1.010   -0.826   -0.651   -0.308 1.001  3000
## theta[56]     0.782   0.262    0.276    0.607    0.781    0.958    1.292 1.003   870
## theta[57]     1.393   0.275    0.852    1.207    1.389    1.568    1.954 1.001  3000
## theta[58]    -0.840   0.243   -1.302   -1.017   -0.845   -0.669   -0.371 1.001  2500
## theta[59]     0.111   0.253   -0.381   -0.052    0.108    0.279    0.617 1.007   310
## theta[60]     0.357   0.261   -0.156    0.183    0.355    0.530    0.878 1.003  1300
## theta[61]    -1.806   0.316   -2.490   -2.013   -1.792   -1.589   -1.235 1.001  3000
## theta[62]    -0.416   0.257   -0.905   -0.588   -0.419   -0.249    0.113 1.002  1000
## theta[63]     2.365   0.489    1.533    2.018    2.312    2.674    3.411 1.003   770
## theta[64]    -0.926   0.254   -1.434   -1.097   -0.921   -0.748   -0.444 1.001  3000
## theta[65]     0.387   0.264   -0.119    0.206    0.382    0.562    0.918 1.002  1800
## theta[66]     0.777   0.253    0.279    0.606    0.773    0.946    1.281 1.029   720
## theta[67]     0.344   0.250   -0.146    0.179    0.339    0.505    0.848 1.001  3000
## theta[68]     1.622   0.285    1.076    1.433    1.614    1.807    2.207 1.006   550
## theta[69]     1.091   0.268    0.554    0.912    1.089    1.272    1.618 1.003   960
## theta[70]     1.622   0.297    1.066    1.421    1.611    1.810    2.259 1.001  2000
## theta[71]    -0.003   0.247   -0.493   -0.178    0.002    0.169    0.478 1.002  1600
## theta[72]    -1.028   0.254   -1.538   -1.193   -1.029   -0.853   -0.564 1.001  3000
## theta[73]     0.158   0.259   -0.359   -0.010    0.161    0.332    0.663 1.001  3000
## theta[74]    -2.300   0.384   -3.130   -2.533   -2.272   -2.035   -1.665 1.004  3000
## theta[75]    -0.108   0.284   -0.659   -0.297   -0.106    0.082    0.448 1.001  2300
## theta[76]    -1.098   0.254   -1.596   -1.268   -1.094   -0.928   -0.609 1.003   870
##  [ reached getOption("max.print") -- omitted 425 rows ]
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 692.5 and DIC = 7012.1
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<div class="sourceCode" id="cb387"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span> <span class="op">%like%</span> <span class="st">"theta"</span>, <span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##              mean     sd     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## a[1]        2.136  0.164    1.845    2.024    2.126    2.239    2.481 1.006   670
## a[2]        3.521  0.260    3.016    3.346    3.518    3.696    4.032 1.008   270
## a[3]        3.957  0.303    3.356    3.758    3.959    4.149    4.550 1.004   530
## a[4]        3.576  0.252    3.104    3.401    3.571    3.747    4.088 1.008   260
## a[5]        2.444  0.171    2.124    2.323    2.437    2.563    2.786 1.009   270
## a[6]        1.866  0.151    1.587    1.761    1.861    1.965    2.171 1.011   200
## a[7]        1.495  0.121    1.255    1.413    1.492    1.577    1.730 1.004  2300
## d[1,2]      4.952  0.328    4.343    4.735    4.949    5.156    5.639 1.002  1000
## d[2,2]      5.185  0.355    4.529    4.936    5.169    5.420    5.915 1.007   330
## d[3,2]      6.513  0.482    5.575    6.188    6.506    6.830    7.485 1.003  1400
## d[4,2]      6.385  0.435    5.593    6.086    6.373    6.676    7.251 1.004   650
## d[5,2]      4.768  0.312    4.184    4.562    4.759    4.973    5.403 1.013   200
## d[6,2]      3.833  0.258    3.362    3.653    3.825    4.007    4.361 1.013   160
## d[7,2]      4.274  0.286    3.723    4.080    4.265    4.460    4.852 1.001  2400
## d[1,3]      2.943  0.211    2.536    2.800    2.939    3.085    3.370 1.003   970
## d[2,3]      1.169  0.201    0.756    1.046    1.174    1.300    1.563 1.020   240
## d[3,3]      3.323  0.296    2.753    3.120    3.329    3.508    3.930 1.002  2300
## d[4,3]      2.703  0.242    2.261    2.536    2.695    2.859    3.194 1.009   270
## d[5,3]      2.672  0.203    2.268    2.540    2.676    2.805    3.073 1.013   200
## d[6,3]      1.949  0.164    1.626    1.837    1.951    2.059    2.275 1.012   200
## d[7,3]      2.443  0.167    2.120    2.330    2.446    2.557    2.762 1.004   710
## d[1,4]      0.645  0.146    0.362    0.547    0.644    0.741    0.934 1.006   360
## d[2,4]     -1.785  0.222   -2.239   -1.929   -1.780   -1.627   -1.370 1.020   110
## d[3,4]     -1.325  0.233   -1.837   -1.467   -1.312   -1.164   -0.903 1.024    90
## d[4,4]     -0.806  0.206   -1.253   -0.933   -0.797   -0.672   -0.425 1.019   160
## d[5,4]     -0.356  0.156   -0.670   -0.455   -0.353   -0.249   -0.059 1.011   190
## d[6,4]     -0.490  0.131   -0.767   -0.571   -0.488   -0.403   -0.240 1.007   650
## d[7,4]      0.263  0.116    0.038    0.186    0.266    0.341    0.482 1.008   290
## d[1,5]     -2.511  0.186   -2.887   -2.636   -2.507   -2.379   -2.157 1.007   320
## d[2,5]     -5.140  0.368   -5.858   -5.374   -5.137   -4.885   -4.446 1.011   200
## d[3,5]     -5.562  0.419   -6.453   -5.830   -5.553   -5.272   -4.757 1.013   170
## d[4,5]     -4.855  0.348   -5.562   -5.083   -4.832   -4.625   -4.196 1.017   220
## d[5,5]     -3.605  0.243   -4.092   -3.762   -3.600   -3.436   -3.153 1.003  3000
## d[6,5]     -3.210  0.214   -3.631   -3.355   -3.205   -3.061   -2.806 1.009   530
## d[7,5]     -2.748  0.179   -3.112   -2.865   -2.740   -2.625   -2.413 1.004   650
## deviance 6319.569 37.286 6251.475 6293.382 6318.824 6344.230 6396.701 1.005   460</code></pre>
<div class="sourceCode" id="cb389"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract posteriors for all chains</span>
<span class="va">jags.mcmc</span> <span class="op">&lt;-</span> <span class="fu">as.mcmc</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>

<span class="co"># convert to single data.frame for density plot</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">jags.mcmc</span>, chains<span class="op">=</span><span class="cn">T</span>, iters <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">plot.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chain"</span>, <span class="st">"iter"</span>, <span class="va">a</span><span class="op">)</span>


<span class="va">plot_title</span> <span class="op">&lt;-</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Posterior distributions"</span>,<span class="st">"with medians and 80% intervals"</span><span class="op">)</span>
<span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span><span class="va">plot.data</span>, regex_pars <span class="op">=</span> <span class="st">"d"</span>, prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>  <span class="va">plot_title</span> <span class="op">+</span> <span class="fu">lims</span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Scale for 'x' is already present. Adding another scale for 'x', which will replace the existing
## scale.</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-1.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb392"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-intervals.html">mcmc_areas</a></span><span class="op">(</span>
  <span class="va">plot.data</span>,
  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span>,
  prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">plot_title</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-2.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb393"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-diagnostics.html">mcmc_acf</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-3.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb394"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">bayesplot</span><span class="fu">::</span><span class="fu"><a href="https://mc-stan.org/bayesplot/reference/MCMC-traces.html">mcmc_trace</a></span><span class="op">(</span><span class="va">plot.data</span>,pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">7</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-4.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb395"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggmcmc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggmcmc/man/ggs_grb.html">ggs_grb</a></span><span class="op">(</span><span class="fu">ggs</span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"d"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-5.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb396"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggmcmc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggmcmc/man/ggs_grb.html">ggs_grb</a></span><span class="op">(</span><span class="fu">ggs</span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"a"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-6.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb397"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggmcmc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ggmcmc/man/ggs_autocorrelation.html">ggs_autocorrelation</a></span><span class="op">(</span><span class="fu">ggs</span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">)</span>, family<span class="op">=</span><span class="st">"d"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-7.png" width="90%" height="90%"></div>
<!-- ## PI Example - OpenBUGS -->
<!-- I ran into issues using the BUGs code provided in text using JAGS so I figured I would replicate the model using OpenBUGS directly to test whether the model can be run as is without any modifications. -->
<!-- ```{r chp11-peer-int-openbugs, warnings=T, message=T, error=T, cache=TRUE} -->
<!-- # model code -->
<!-- model.file <- paste0(w.d,"/code/IRT-for-Polytomous-Observables/IRT for Polytomous Observables/WinBUGS/L-GRM (Normal with Bounds, Truncated-Normal).bug") -->
<!-- cat(model.file) -->
<!-- # get data file -->
<!-- data.file <- paste0(w.d,"/code/IRT-for-Polytomous-Observables/IRT for Polytomous Observables/WinBUGS/data.txt") -->
<!-- # initial values -->
<!-- start_values <- list( -->
<!--   list( -->
<!--     d= matrix(c(NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00), -->
<!--       ncol=5, nrow=7, byrow=T), -->
<!--     a=c(1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01)), -->
<!--   list( -->
<!--     d= matrix(c(NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00), -->
<!--       ncol=5, nrow=7, byrow=T), -->
<!--     a=c(3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00)), -->
<!--   list( -->
<!--     d= matrix(c(NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00), -->
<!--               ncol=5, nrow=7, byrow=T), -->
<!--     a=c(1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00)) -->
<!-- ) -->
<!-- # vector of all parameters to save -->
<!-- param_save <- c("a", "d", "theta") -->
<!-- # fit model -->
<!-- fit <- openbugs( -->
<!--   data= data.file,  -->
<!--   model.file = model.file, # R grabs the file and runs it in openBUGS -->
<!--   parameters.to.save = param_save, -->
<!--   inits=start_values, -->
<!--   n.chains = 3, -->
<!--   n.iter = 2000, -->
<!--   n.burnin = 1000, -->
<!--   n.thin = 1 -->
<!-- ) -->
<!-- print(fit) -->
<!-- ``` -->
</div>
<div id="pi-example---stan" class="section level2" number="11.8">
<h2>
<span class="header-section-number">11.8</span> PI Example - Stan<a class="anchor" aria-label="anchor" href="#pi-example---stan"><i class="fas fa-link"></i></a>
</h2>
<p>TO-DO</p>
</div>
<div id="latent-response-formulation" class="section level2" number="11.9">
<h2>
<span class="header-section-number">11.9</span> Latent Response Formulation<a class="anchor" aria-label="anchor" href="#latent-response-formulation"><i class="fas fa-link"></i></a>
</h2>
<p>Connecting IRT models to a factor analytic perspective can be helpful from a modeling standpoint.
Especially when one’s model is multidimensional leading into structural equation models.
A useful connection can be made by introducing extra variable(s) into the model to represent the <em>latent response variable</em> underlying the <em>observed categorical response variable</em>.
We can think of this latent response variables as</p>
<ul>
<li><p>a latent continuous variable hypothesized to underlie the observed categorical variable that discretized due to data collection or difficulty in measurement; or</p></li>
<li><p>when this natural interpretation is not appropriate, we can think of the latent response variable as a propensity measure for the given response. Although this is not a perfect interpretation, the use of a latent response formulation eases some of the computational machinery and allows for a nice connection between IRT and CFA models.</p></li>
</ul>
<p>Next, the latent response formulation is shown for a set of dichotomous outcomes.
This model is conceptually a 2-PL/2-PNO (2 parameter normal ogive) model and is essentially a probit model.
The model can be defined as</p>
<p><span class="math display">\[x^{\ast}_{ij} = a_j\theta_i+d_j+\varepsilon_{ij},\]</span></p>
<p>where, for each <span class="math inline">\(j\)</span>, <span class="math inline">\(\varepsilon_{ij} \sim \mathrm{Normal}(0, \sigma^2_{\varepsilon_j})\)</span>. And can jointly be expressed as</p>
<p><span class="math display">\[x^{\ast}_{ij} \sim \mathrm{Normal}(a_j\theta_i+d_j, \sigma^2_{\varepsilon_j}).\]</span></p>
<p>The probability of an observed response is then modeled as probability of the latent response variable for person <span class="math inline">\(i\)</span> on item <span class="math inline">\(j\)</span> being greater than or equal to some threshold <span class="math inline">\(\gamma_j\)</span>.</p>
<div id="lsat-example-revisted" class="section level3" number="11.9.1">
<h3>
<span class="header-section-number">11.9.1</span> LSAT Example Revisted<a class="anchor" aria-label="anchor" href="#lsat-example-revisted"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb398"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">jags.model.lsat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
    <span class="co"># latent response variable</span>
    <span class="va">xstar</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">*</span><span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="va">d</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="fl">1</span><span class="op">)</span>
    <span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">c</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">c</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span><span class="op">*</span><span class="fu">phi</span><span class="op">(</span><span class="va">xstar</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span> <span class="co"># 3P-NO expression</span>
    <span class="va">x</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dbern</span><span class="op">(</span><span class="va">P</span><span class="op">[</span><span class="va">i</span>,<span class="va">j</span><span class="op">]</span><span class="op">)</span>                  <span class="co"># distribution for each observable</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">{</span>
  <span class="va">theta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># distribution for the latent variables</span>
<span class="op">}</span>

<span class="kw">for</span><span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">)</span><span class="op">{</span>
  <span class="va">d</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span>          <span class="co"># Locations for observables</span>
  <span class="va">a</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">)</span>    <span class="co"># Discriminations for observables</span>
  <span class="va">c</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html">dbeta</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">17</span><span class="op">)</span>           <span class="co"># Lower asymptotes for observables</span>
  
<span class="op">}</span>


<span class="op">}</span> <span class="co"># closes the model</span>

<span class="co"># initial values</span>
<span class="va">start_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span><span class="op">)</span>,
       <span class="st">"a"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span><span class="op">)</span>,
       <span class="st">"c"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span>, <span class="op">-</span><span class="fl">3.00</span><span class="op">)</span>,
       <span class="st">"a"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span><span class="op">)</span>,
       <span class="st">"c"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span><span class="op">)</span><span class="op">)</span>,
  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="st">"d"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span><span class="op">)</span>,
       <span class="st">"a"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,
       <span class="st">"c"</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># vector of all parameters to save</span>
<span class="va">param_save</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"d"</span>, <span class="st">"c"</span>, <span class="st">"theta"</span><span class="op">)</span>

<span class="co"># dataset</span>
<span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"data/LSAT.dat"</span>, header<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,
  J <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>,
  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># fit model</span>
<span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">jags</span><span class="op">(</span>
  model.file<span class="op">=</span><span class="va">jags.model.lsat</span>,
  data<span class="op">=</span><span class="va">mydata</span>,
  inits<span class="op">=</span><span class="va">start_values</span>,
  parameters.to.save <span class="op">=</span> <span class="va">param_save</span>,
  n.iter<span class="op">=</span><span class="fl">500</span>,
  n.burnin <span class="op">=</span> <span class="fl">200</span>,
  n.chains <span class="op">=</span> <span class="fl">3</span>,
  progress.bar <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 5000
##    Unobserved stochastic nodes: 6015
##    Total graph size: 36027
## 
## Initializing model</code></pre>
<div class="sourceCode" id="cb400"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></code></pre></div>
<pre><code>## Inference for Bugs model at "C:/Users/noahp/AppData/Local/Temp/RtmpQR8sbs/model454417575fb3.txt", fit using jags,
##  3 chains, each with 500 iterations (first 200 discarded)
##  n.sims = 900 iterations saved
##              mu.vect sd.vect     2.5%      25%      50%      75%    97.5%   Rhat n.eff
## a[1]           0.577   0.198    0.285    0.436    0.544    0.678    1.045  1.652     6
## a[2]           1.939   1.567    0.383    0.665    1.051    3.534    4.703  3.996     3
## a[3]           1.568   0.660    0.710    0.929    1.355    2.234    2.572  2.317     4
## a[4]           0.600   0.198    0.278    0.462    0.560    0.726    1.038  1.360    10
## a[5]           0.847   0.608    0.090    0.359    0.575    1.440    1.965  2.599     4
## c[1]           0.453   0.324    0.095    0.194    0.283    0.894    0.915  3.948     3
## c[2]           0.348   0.165    0.115    0.214    0.297    0.539    0.607  3.008     4
## c[3]           0.293   0.153    0.098    0.170    0.235    0.474    0.538  4.308     3
## c[4]           0.402   0.245    0.103    0.195    0.294    0.718    0.752  3.600     4
## c[5]           0.417   0.305    0.089    0.176    0.256    0.829    0.858  4.082     3
## d[1]           0.562   1.927   -2.420   -2.019    1.843    1.959    2.144 20.801     3
## d[2]          -0.353   1.203   -2.471   -1.766    0.360    0.525    0.760  9.579     3
## d[3]          -1.043   1.054   -3.088   -2.063   -0.548   -0.197    0.058  6.905     3
## d[4]          -0.230   1.388   -2.375   -2.069    0.648    0.824    1.000 15.453     3
## d[5]           0.028   2.055   -3.286   -2.602    1.392    1.514    1.643 13.313     3
## theta[1]      -1.308   0.838   -2.869   -1.944   -1.321   -0.713    0.414  1.185    15
## theta[2]      -1.124   0.942   -3.075   -1.731   -1.142   -0.495    0.663  1.623     7
## theta[3]      -1.304   0.885   -3.028   -1.914   -1.308   -0.729    0.485  1.229    13
## theta[4]      -1.043   0.790   -2.712   -1.543   -0.952   -0.486    0.304  1.248    12
## theta[5]      -1.157   0.922   -3.024   -1.803   -1.099   -0.494    0.481  1.276    11
## theta[6]      -1.097   0.712   -2.471   -1.580   -1.118   -0.586    0.295  1.061    37
## theta[7]      -1.025   0.887   -2.935   -1.593   -0.984   -0.326    0.435  1.374     9
## theta[8]      -1.005   0.846   -2.812   -1.557   -0.901   -0.426    0.514  1.329    10
## theta[9]      -0.940   0.760   -2.434   -1.460   -0.895   -0.420    0.484  1.271    11
## theta[10]     -1.158   0.761   -2.647   -1.688   -1.140   -0.572    0.181  1.053    45
## theta[11]     -0.950   0.849   -2.720   -1.451   -0.976   -0.398    0.731  1.180    15
## theta[12]     -0.828   0.828   -2.502   -1.422   -0.816   -0.188    0.610  1.115    22
## theta[13]     -0.982   0.755   -2.531   -1.515   -0.977   -0.458    0.426  1.010   900
## theta[14]     -0.812   0.773   -2.363   -1.375   -0.795   -0.255    0.605  1.102    25
## theta[15]     -0.790   0.825   -2.487   -1.343   -0.722   -0.237    0.728  1.230    13
## theta[16]     -0.737   0.742   -2.070   -1.290   -0.740   -0.183    0.637  1.147    18
## theta[17]     -0.686   0.705   -1.971   -1.192   -0.718   -0.220    0.736  1.149    19
## theta[18]     -0.735   0.769   -2.236   -1.282   -0.745   -0.194    0.786  1.236    13
## theta[19]     -0.722   0.825   -2.455   -1.256   -0.696   -0.137    0.687  1.270    11
## theta[20]     -0.731   0.784   -2.271   -1.276   -0.677   -0.142    0.711  1.303    10
## theta[21]     -0.769   0.847   -2.494   -1.331   -0.742   -0.157    0.795  1.234    13
## theta[22]     -0.762   0.724   -2.394   -1.248   -0.705   -0.265    0.567  1.219    13
## theta[23]     -0.981   0.884   -2.570   -1.663   -1.022   -0.354    0.694  1.001   900
## theta[24]     -0.850   0.938   -2.710   -1.534   -0.831   -0.100    0.714  1.107    24
## theta[25]     -0.504   0.857   -2.318   -1.040   -0.419    0.095    0.954  1.042    88
## theta[26]     -0.627   0.836   -2.248   -1.203   -0.596   -0.028    0.884  1.057    48
## theta[27]     -0.336   0.726   -1.901   -0.804   -0.287    0.146    1.060  1.040    82
## theta[28]     -0.451   0.851   -2.100   -1.043   -0.400    0.147    1.131  1.001   900
## theta[29]     -0.298   0.799   -2.076   -0.824   -0.268    0.230    1.178  1.146    19
## theta[30]     -0.522   0.785   -2.256   -0.971   -0.430   -0.002    0.859  1.019   900
## theta[31]     -0.306   0.780   -1.806   -0.852   -0.292    0.248    1.174  1.028   140
## theta[32]     -0.919   0.882   -2.686   -1.504   -0.861   -0.327    0.676  1.209    14
## theta[33]     -0.433   1.002   -2.037   -1.126   -0.572    0.025    2.160  1.338    11
## theta[34]     -0.537   0.987   -2.328   -1.262   -0.597    0.141    1.429  1.847     6
## theta[35]     -0.417   0.854   -2.085   -0.966   -0.436    0.172    1.256  1.240    13
## theta[36]     -0.548   0.963   -2.371   -1.212   -0.548    0.067    1.430  1.596     7
## theta[37]     -0.609   0.976   -2.327   -1.305   -0.695    0.065    1.325  1.470     8
## theta[38]     -0.625   0.878   -2.214   -1.262   -0.584   -0.092    1.208  1.055    63
## theta[39]     -0.527   1.010   -2.441   -1.169   -0.585    0.114    1.716  1.595     7
## theta[40]     -0.657   1.053   -2.599   -1.347   -0.690   -0.064    1.677  1.169    23
## theta[41]     -0.202   0.940   -1.998   -0.759   -0.232    0.353    1.795  1.293    11
## theta[42]     -0.132   0.850   -1.726   -0.750   -0.186    0.438    1.550  1.451     8
## theta[43]     -0.308   0.979   -2.107   -0.918   -0.386    0.255    1.981  1.117    45
## theta[44]     -0.493   0.809   -2.095   -1.034   -0.489    0.055    1.100  1.013   900
## theta[45]     -0.247   1.016   -2.496   -0.829   -0.229    0.336    1.758  1.272    13
## theta[46]     -0.407   0.852   -2.005   -1.003   -0.376    0.201    1.224  1.163    17
## theta[47]     -0.235   1.045   -1.924   -0.967   -0.346    0.439    1.948  1.366    10
## theta[48]     -0.419   0.831   -2.152   -0.892   -0.366    0.111    1.166  1.048   870
## theta[49]     -0.411   0.814   -2.040   -0.993   -0.425    0.126    1.214  1.228    13
## theta[50]     -0.692   0.886   -2.646   -1.220   -0.614   -0.113    0.984  1.179    16
## theta[51]     -0.283   0.850   -1.850   -0.885   -0.376    0.296    1.424  1.152    18
## theta[52]     -0.396   0.841   -1.996   -0.975   -0.353    0.171    1.209  1.136    19
## theta[53]     -0.621   0.718   -2.011   -1.106   -0.608   -0.124    0.744  1.021   110
## theta[54]     -0.347   0.802   -1.969   -0.869   -0.362    0.212    1.152  1.061    42
## theta[55]     -0.453   0.790   -2.062   -0.974   -0.457    0.086    1.113  1.025   340
## theta[56]     -0.227   0.968   -1.961   -0.896   -0.247    0.455    1.733  1.243    13
## theta[57]     -0.094   0.851   -1.744   -0.675   -0.106    0.453    1.616  1.031    70
## theta[58]     -0.236   0.934   -2.433   -0.772   -0.127    0.441    1.290  1.036    78
## theta[59]     -0.065   1.046   -2.133   -0.760   -0.066    0.644    1.895  1.035   110
## theta[60]     -0.050   0.934   -1.826   -0.762    0.010    0.594    1.738  1.056    40
## theta[61]      0.071   0.875   -2.021   -0.426    0.179    0.627    1.659  1.148    19
## theta[62]      0.190   0.759   -1.280   -0.310    0.207    0.681    1.655  1.143    19
## theta[63]      0.424   0.839   -1.405   -0.069    0.471    0.965    1.969  1.010   280
## theta[64]      0.298   0.806   -1.413   -0.228    0.353    0.858    1.778  1.014   310
## theta[65]      0.441   1.022   -1.649   -0.221    0.512    1.134    2.385  1.340    10
## theta[66]      0.076   1.031   -2.033   -0.610    0.192    0.761    2.058  1.140    23
## theta[67]      0.581   0.933   -1.319   -0.032    0.611    1.213    2.459  1.160    17
## theta[68]      0.244   1.001   -2.200   -0.304    0.369    0.892    1.952  1.036   120
## theta[69]      0.123   0.784   -1.605   -0.300    0.183    0.649    1.463  1.022   110
## theta[70]      0.051   0.733   -1.401   -0.459    0.005    0.546    1.503  1.077    31
## theta[71]      0.207   0.821   -1.512   -0.313    0.215    0.812    1.713  1.033    65
## theta[72]      0.148   0.832   -1.604   -0.423    0.183    0.698    1.726  1.066    38
## theta[73]      0.394   1.131   -1.731   -0.361    0.308    1.164    2.614  1.377    10
## theta[74]     -0.013   0.780   -1.446   -0.546   -0.015    0.487    1.616  1.078    36
## theta[75]      0.455   0.817   -1.267   -0.079    0.520    1.031    1.862  1.056    51
## theta[76]      0.237   1.007   -1.745   -0.462    0.263    0.925    2.219  1.138    31
## theta[77]     -1.296   0.858   -2.849   -1.913   -1.305   -0.646    0.389  1.032    75
## theta[78]     -0.879   0.774   -2.427   -1.404   -0.867   -0.290    0.428  1.280    11
## theta[79]     -0.976   0.818   -2.547   -1.509   -0.998   -0.398    0.623  1.049    47
## theta[80]     -0.916   0.814   -2.520   -1.477   -0.886   -0.399    0.653  1.439     8
## theta[81]     -1.186   0.928   -2.848   -1.844   -1.263   -0.481    0.579  1.056    63
## theta[82]     -1.012   0.871   -2.763   -1.587   -1.000   -0.366    0.516  1.135    20
## theta[83]     -0.893   0.830   -2.430   -1.498   -0.948   -0.292    0.734  1.324    10
## theta[84]     -1.013   0.799   -2.621   -1.565   -1.008   -0.437    0.408  1.123    22
## theta[85]     -1.151   0.766   -2.736   -1.618   -1.107   -0.600    0.167  1.096    28
## theta[86]     -1.130   0.776   -2.783   -1.635   -1.075   -0.565    0.160  1.236    13
## theta[87]     -0.786   0.781   -2.528   -1.290   -0.719   -0.197    0.491  1.166    17
## theta[88]     -0.872   0.806   -2.663   -1.378   -0.820   -0.311    0.518  1.095    26
## theta[89]     -0.849   0.736   -2.369   -1.361   -0.810   -0.349    0.557  1.060    38
## theta[90]     -0.876   0.743   -2.525   -1.325   -0.818   -0.343    0.434  1.161    17
## theta[91]     -0.907   0.763   -2.322   -1.490   -0.892   -0.356    0.556  1.022   120
## theta[92]     -0.647   0.729   -2.069   -1.134   -0.661   -0.137    0.814  1.232    13
## theta[93]     -0.752   0.675   -2.164   -1.212   -0.729   -0.283    0.502  1.099    25
## theta[94]     -0.937   0.766   -2.479   -1.493   -0.923   -0.386    0.484  1.048    47
## theta[95]     -0.757   0.769   -2.332   -1.284   -0.717   -0.189    0.637  1.151    18
## theta[96]     -0.846   0.773   -2.453   -1.355   -0.816   -0.306    0.511  1.053    44
##  [ reached getOption("max.print") -- omitted 905 rows ]
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 5736.9 and DIC = 9694.9
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<div class="sourceCode" id="cb402"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">summary</span><span class="op">[</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">BUGSoutput</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span> <span class="op">%like%</span> <span class="st">"theta"</span>, <span class="op">]</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##              mean      sd     2.5%      25%      50%      75%    97.5%   Rhat n.eff
## a[1]        0.577   0.198    0.285    0.436    0.544    0.678    1.045  1.652     6
## a[2]        1.939   1.567    0.383    0.665    1.051    3.534    4.703  3.996     3
## a[3]        1.568   0.660    0.710    0.929    1.355    2.234    2.572  2.317     4
## a[4]        0.600   0.198    0.278    0.462    0.560    0.726    1.038  1.360    10
## a[5]        0.847   0.608    0.090    0.359    0.575    1.440    1.965  2.599     4
## c[1]        0.453   0.324    0.095    0.194    0.283    0.894    0.915  3.948     3
## c[2]        0.348   0.165    0.115    0.214    0.297    0.539    0.607  3.008     4
## c[3]        0.293   0.153    0.098    0.170    0.235    0.474    0.538  4.308     3
## c[4]        0.402   0.245    0.103    0.195    0.294    0.718    0.752  3.600     4
## c[5]        0.417   0.305    0.089    0.176    0.256    0.829    0.858  4.082     3
## d[1]        0.562   1.927   -2.420   -2.019    1.843    1.959    2.144 20.801     3
## d[2]       -0.353   1.203   -2.471   -1.766    0.360    0.525    0.760  9.579     3
## d[3]       -1.043   1.054   -3.088   -2.063   -0.548   -0.197    0.058  6.905     3
## d[4]       -0.230   1.388   -2.375   -2.069    0.648    0.824    1.000 15.453     3
## d[5]        0.028   2.055   -3.286   -2.602    1.392    1.514    1.643 13.313     3
## deviance 3957.959 550.269 3380.214 3542.102 3666.316 4645.067 4825.453  8.457     3</code></pre>
<div class="sourceCode" id="cb404"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># extract posteriors for all chains</span>
<span class="va">jags.mcmc</span> <span class="op">&lt;-</span> <span class="fu">as.mcmc</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>
<span class="co"># the below two plots are too big to be useful given the 1000 observations.</span>
<span class="co">#R2jags::traceplot(jags.mcmc)</span>

<span class="co"># gelman-rubin-brook</span>
<span class="co">#gelman.plot(jags.mcmc)</span>

<span class="co"># convert to single data.frame for density plot</span>
<span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="va">jags.mcmc</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="va">plot.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">jags.mcmc</span>, chains<span class="op">=</span><span class="cn">T</span>, iters <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">plot.data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"chain"</span>, <span class="st">"iter"</span>, <span class="va">a</span><span class="op">)</span>


<span class="va">plot_title</span> <span class="op">&lt;-</span> <span class="fu">ggtitle</span><span class="op">(</span><span class="st">"Posterior distributions"</span>,
                      <span class="st">"with medians and 80% intervals"</span><span class="op">)</span>
<span class="fu">mcmc_areas</span><span class="op">(</span>
  <span class="va">plot.data</span>,
  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"d["</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="st">"]"</span><span class="op">)</span><span class="op">)</span>,
  prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">plot_title</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-lrv-lsat-jags-1.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb405"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mcmc_areas</span><span class="op">(</span>
  <span class="va">plot.data</span>,
  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span>,
  prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">plot_title</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-lrv-lsat-jags-2.png" width="90%" height="90%"></div>
<div class="sourceCode" id="cb406"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mcmc_areas</span><span class="op">(</span>
  <span class="va">plot.data</span>,
  pars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"c["</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="st">"]"</span><span class="op">)</span><span class="op">)</span>,
  prob <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span>
  <span class="va">plot_title</span></code></pre></div>
<div class="inline-figure"><img src="bookdown-BPM_files/figure-html/chp11-lrv-lsat-jags-3.png" width="90%" height="90%"></div>
</div>
</div>
<div id="final-notes" class="section level2" number="11.10">
<h2>
<span class="header-section-number">11.10</span> Final Notes<a class="anchor" aria-label="anchor" href="#final-notes"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>A fully Bayesian approach to psychometric modeling helps highlight the major similarities between factor analytic frameworks and the item response theory perspective.</li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="model-evaluation.html"><span class="header-section-number">10</span> Model Evaluation</a></div>
<div class="next"><a href="missing-data-modeling.html"><span class="header-section-number">12</span> Missing Data Modeling</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#item-response-theory"><span class="header-section-number">11</span> Item Response Theory</a></li>
<li><a class="nav-link" href="#irt-models-for-dichotomous-data"><span class="header-section-number">11.1</span> IRT Models for Dichotomous Data</a></li>
<li><a class="nav-link" href="#pl-lsat-example"><span class="header-section-number">11.2</span> 3-PL LSAT Example</a></li>
<li>
<a class="nav-link" href="#lsat-example---jags"><span class="header-section-number">11.3</span> LSAT Example - JAGS</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#posterior-predicted-distributions"><span class="header-section-number">11.3.1</span> Posterior Predicted Distributions</a></li></ul>
</li>
<li><a class="nav-link" href="#lsat-example---stan"><span class="header-section-number">11.4</span> LSAT Example - Stan</a></li>
<li><a class="nav-link" href="#irt-models-for-polytomous-data"><span class="header-section-number">11.5</span> IRT Models for Polytomous Data</a></li>
<li>
<a class="nav-link" href="#grm-peer-interactions-example"><span class="header-section-number">11.6</span> GRM Peer Interactions Example</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#example-specific-model-specification"><span class="header-section-number">11.6.1</span> Example Specific Model Specification</a></li></ul>
</li>
<li><a class="nav-link" href="#pi-example---jags"><span class="header-section-number">11.7</span> PI Example - JAGS</a></li>
<li><a class="nav-link" href="#pi-example---stan"><span class="header-section-number">11.8</span> PI Example - Stan</a></li>
<li>
<a class="nav-link" href="#latent-response-formulation"><span class="header-section-number">11.9</span> Latent Response Formulation</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#lsat-example-revisted"><span class="header-section-number">11.9.1</span> LSAT Example Revisted</a></li></ul>
</li>
<li><a class="nav-link" href="#final-notes"><span class="header-section-number">11.10</span> Final Notes</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/noah-padgett/Bayesian-Psychometric-Modeling/blob/master/11-irt.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/noah-padgett/Bayesian-Psychometric-Modeling/edit/master/11-irt.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</strong>" was written by R. Noah Padgett. It was last built on 2022-06-20.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
