<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11.2 3-PL LSAT Example | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</title>
  <meta name="description" content="This online book is meant to serve a computation reference for the text Bayesian Psychometric Modeling by Roy Levy and Robert Mislevy. We hope that having a detailed computatin guide using Stan is of interest to someone." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="11.2 3-PL LSAT Example | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This online book is meant to serve a computation reference for the text Bayesian Psychometric Modeling by Roy Levy and Robert Mislevy. We hope that having a detailed computatin guide using Stan is of interest to someone." />
  <meta name="github-repo" content="noah-padgett/Bayesian-Psychometric-Modeling" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11.2 3-PL LSAT Example | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy" />
  
  <meta name="twitter:description" content="This online book is meant to serve a computation reference for the text Bayesian Psychometric Modeling by Roy Levy and Robert Mislevy. We hope that having a detailed computatin guide using Stan is of interest to someone." />
  

<meta name="author" content="R. Noah Padgett" />


<meta name="date" content="2021-04-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="irt-models-for-dichotomous-data.html"/>
<link rel="next" href="lsat-example-jags.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Psychometric Modeling</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started/Overview Chapter</a>
<ul>
<li class="chapter" data-level="1.1" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>1.1</b> Software</a></li>
<li class="chapter" data-level="1.2" data-path="overview-of-assessment-and-psychometric-modeling.html"><a href="overview-of-assessment-and-psychometric-modeling.html"><i class="fa fa-check"></i><b>1.2</b> Overview of Assessment and Psychometric Modeling</a></li>
<li class="chapter" data-level="1.3" data-path="looking-forward.html"><a href="looking-forward.html"><i class="fa fa-check"></i><b>1.3</b> Looking Forward</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chp2.html"><a href="chp2.html"><i class="fa fa-check"></i><b>2</b> Introduction to Bayesian Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html"><i class="fa fa-check"></i><b>2.1</b> Beta-binomial Example</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html#computation-using-stan"><i class="fa fa-check"></i><b>2.1.1</b> Computation using Stan</a></li>
<li class="chapter" data-level="2.1.2" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html#computation-using-winbugs-openbugs"><i class="fa fa-check"></i><b>2.1.2</b> Computation using WinBUGS (OpenBUGS)</a></li>
<li class="chapter" data-level="2.1.3" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html#computation-using-jags-r2jags"><i class="fa fa-check"></i><b>2.1.3</b> Computation using JAGS (R2jags)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html"><i class="fa fa-check"></i><b>2.2</b> Beta-Bernoulli Example</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html#computation-using-stan-1"><i class="fa fa-check"></i><b>2.2.1</b> Computation using Stan</a></li>
<li class="chapter" data-level="2.2.2" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html#computation-using-winbugs-openbugs-1"><i class="fa fa-check"></i><b>2.2.2</b> Computation using WinBUGS (OpenBUGS)</a></li>
<li class="chapter" data-level="2.2.3" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html#computation-using-jags-r2jags-1"><i class="fa fa-check"></i><b>2.2.3</b> Computation using JAGS (R2jags)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="conceptual-issues-in-bayesian-inference.html"><a href="conceptual-issues-in-bayesian-inference.html"><i class="fa fa-check"></i><b>3</b> Conceptual Issues in Bayesian Inference</a></li>
<li class="chapter" data-level="4" data-path="normal-distribution-models.html"><a href="normal-distribution-models.html"><i class="fa fa-check"></i><b>4</b> Normal Distribution Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="stan-model-for-mean-and-variance-unknown.html"><a href="stan-model-for-mean-and-variance-unknown.html"><i class="fa fa-check"></i><b>4.1</b> Stan Model for mean and variance unknown</a></li>
<li class="chapter" data-level="4.2" data-path="jags-model-for-mean-and-variance-unknown-precision-parameterization.html"><a href="jags-model-for-mean-and-variance-unknown-precision-parameterization.html"><i class="fa fa-check"></i><b>4.2</b> JAGS Model for mean and variance unknown (precision parameterization)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="markov-chain-monte-carlo-estimation.html"><a href="markov-chain-monte-carlo-estimation.html"><i class="fa fa-check"></i><b>5</b> Markov Chain Monte Carlo Estimation</a></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stan-model-for-regression-model.html"><a href="stan-model-for-regression-model.html"><i class="fa fa-check"></i><b>6.1</b> Stan Model for Regression Model</a></li>
<li class="chapter" data-level="6.2" data-path="jags-model-for-regression-model.html"><a href="jags-model-for-regression-model.html"><i class="fa fa-check"></i><b>6.2</b> JAGS Model for Regression Model</a></li>
</ul></li>
<li class="part"><span><b>II Psychometrics</b></span></li>
<li class="chapter" data-level="7" data-path="canonical-bayesian-psychometric-modeling.html"><a href="canonical-bayesian-psychometric-modeling.html"><i class="fa fa-check"></i><b>7</b> Canonical Bayesian Psychometric Modeling</a></li>
<li class="chapter" data-level="8" data-path="classical-test-theory.html"><a href="classical-test-theory.html"><i class="fa fa-check"></i><b>8</b> Classical Test Theory</a>
<ul>
<li class="chapter" data-level="8.1" data-path="example-1-known-measurement-model-parameters-with-1-measure.html"><a href="example-1-known-measurement-model-parameters-with-1-measure.html"><i class="fa fa-check"></i><b>8.1</b> Example 1 - Known measurement model parameters with 1 measure</a></li>
<li class="chapter" data-level="8.2" data-path="example-1-stan.html"><a href="example-1-stan.html"><i class="fa fa-check"></i><b>8.2</b> Example 1 - Stan</a></li>
<li class="chapter" data-level="8.3" data-path="example-1-jags.html"><a href="example-1-jags.html"><i class="fa fa-check"></i><b>8.3</b> Example 1 - JAGS</a></li>
<li class="chapter" data-level="8.4" data-path="example-2-known-measurement-model-with-multiple-measures.html"><a href="example-2-known-measurement-model-with-multiple-measures.html"><i class="fa fa-check"></i><b>8.4</b> Example 2 - Known Measurement Model with Multiple Measures</a></li>
<li class="chapter" data-level="8.5" data-path="example-2-stan.html"><a href="example-2-stan.html"><i class="fa fa-check"></i><b>8.5</b> Example 2 - Stan</a></li>
<li class="chapter" data-level="8.6" data-path="example-2-jags.html"><a href="example-2-jags.html"><i class="fa fa-check"></i><b>8.6</b> Example 2 - JAGS</a></li>
<li class="chapter" data-level="8.7" data-path="example-3-unknown-measurement-model-with-multiple-measures.html"><a href="example-3-unknown-measurement-model-with-multiple-measures.html"><i class="fa fa-check"></i><b>8.7</b> Example 3 - Unknown Measurement Model with Multiple Measures</a></li>
<li class="chapter" data-level="8.8" data-path="example-3-stan.html"><a href="example-3-stan.html"><i class="fa fa-check"></i><b>8.8</b> Example 3 - Stan</a></li>
<li class="chapter" data-level="8.9" data-path="example-3-jags.html"><a href="example-3-jags.html"><i class="fa fa-check"></i><b>8.9</b> Example 3 - JAGS</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="confirmatory-factor-analysis.html"><a href="confirmatory-factor-analysis.html"><i class="fa fa-check"></i><b>9</b> Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="single-latent-variable-model.html"><a href="single-latent-variable-model.html"><i class="fa fa-check"></i><b>9.1</b> Single Latent Variable Model</a></li>
<li class="chapter" data-level="9.2" data-path="jags-single-latent-variable.html"><a href="jags-single-latent-variable.html"><i class="fa fa-check"></i><b>9.2</b> JAGS - Single Latent Variable</a></li>
<li class="chapter" data-level="9.3" data-path="stan-single-latent-variable.html"><a href="stan-single-latent-variable.html"><i class="fa fa-check"></i><b>9.3</b> Stan - Single Latent Variable</a></li>
<li class="chapter" data-level="9.4" data-path="blavaan-single-latent-variable.html"><a href="blavaan-single-latent-variable.html"><i class="fa fa-check"></i><b>9.4</b> Blavaan - Single Latent Variable</a></li>
<li class="chapter" data-level="9.5" data-path="jags-two-latent-variable.html"><a href="jags-two-latent-variable.html"><i class="fa fa-check"></i><b>9.5</b> JAGS - Two Latent Variable</a></li>
<li class="chapter" data-level="9.6" data-path="stan-two-latent-variable.html"><a href="stan-two-latent-variable.html"><i class="fa fa-check"></i><b>9.6</b> Stan - Two Latent Variable</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="stan-two-latent-variable.html"><a href="stan-two-latent-variable.html#inverse-wishart-prior"><i class="fa fa-check"></i><b>9.6.1</b> Inverse-Wishart Prior</a></li>
<li class="chapter" data-level="9.6.2" data-path="stan-two-latent-variable.html"><a href="stan-two-latent-variable.html#lkj-cholesky-parameterization"><i class="fa fa-check"></i><b>9.6.2</b> LKJ Cholesky Parameterization</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="blavaan-two-latent-variables.html"><a href="blavaan-two-latent-variables.html"><i class="fa fa-check"></i><b>9.7</b> Blavaan - Two Latent Variables</a></li>
<li class="chapter" data-level="9.8" data-path="indeterminacy-in-one-factor-cfa.html"><a href="indeterminacy-in-one-factor-cfa.html"><i class="fa fa-check"></i><b>9.8</b> Indeterminacy in One Factor CFA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>10</b> Model Evaluation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="residual-analysis.html"><a href="residual-analysis.html"><i class="fa fa-check"></i><b>10.1</b> Residual Analysis</a></li>
<li class="chapter" data-level="10.2" data-path="posterior-predictive-distributions.html"><a href="posterior-predictive-distributions.html"><i class="fa fa-check"></i><b>10.2</b> Posterior Predictive Distributions</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="posterior-predictive-distributions.html"><a href="posterior-predictive-distributions.html#example-of-posterior-predictive-distribution-of-correlations"><i class="fa fa-check"></i><b>10.2.1</b> Example of posterior predictive distribution of correlations</a></li>
<li class="chapter" data-level="10.2.2" data-path="posterior-predictive-distributions.html"><a href="posterior-predictive-distributions.html#ppd-srmr"><i class="fa fa-check"></i><b>10.2.2</b> PPD SRMR</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10.3</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="item-response-theory.html"><a href="item-response-theory.html"><i class="fa fa-check"></i><b>11</b> Item Response Theory</a>
<ul>
<li class="chapter" data-level="11.1" data-path="irt-models-for-dichotomous-data.html"><a href="irt-models-for-dichotomous-data.html"><i class="fa fa-check"></i><b>11.1</b> IRT Models for Dichotomous Data</a></li>
<li class="chapter" data-level="11.2" data-path="pl-lsat-example.html"><a href="pl-lsat-example.html"><i class="fa fa-check"></i><b>11.2</b> 3-PL LSAT Example</a></li>
<li class="chapter" data-level="11.3" data-path="lsat-example-jags.html"><a href="lsat-example-jags.html"><i class="fa fa-check"></i><b>11.3</b> LSAT Example - JAGS</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="lsat-example-jags.html"><a href="lsat-example-jags.html#posterior-predicted-distributions"><i class="fa fa-check"></i><b>11.3.1</b> Posterior Predicted Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="lsat-example-stan.html"><a href="lsat-example-stan.html"><i class="fa fa-check"></i><b>11.4</b> LSAT Example - Stan</a></li>
<li class="chapter" data-level="11.5" data-path="irt-models-for-polytomous-data.html"><a href="irt-models-for-polytomous-data.html"><i class="fa fa-check"></i><b>11.5</b> IRT Models for Polytomous Data</a></li>
<li class="chapter" data-level="11.6" data-path="grm-peer-interactions-example.html"><a href="grm-peer-interactions-example.html"><i class="fa fa-check"></i><b>11.6</b> GRM Peer Interactions Example</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="grm-peer-interactions-example.html"><a href="grm-peer-interactions-example.html#example-specific-model-specification"><i class="fa fa-check"></i><b>11.6.1</b> Example Specific Model Specification</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="pi-example-jags.html"><a href="pi-example-jags.html"><i class="fa fa-check"></i><b>11.7</b> PI Example - JAGS</a></li>
<li class="chapter" data-level="11.8" data-path="pi-example-stan.html"><a href="pi-example-stan.html"><i class="fa fa-check"></i><b>11.8</b> PI Example - Stan</a></li>
<li class="chapter" data-level="11.9" data-path="latent-response-formulation.html"><a href="latent-response-formulation.html"><i class="fa fa-check"></i><b>11.9</b> Latent Response Formulation</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="latent-response-formulation.html"><a href="latent-response-formulation.html#lsat-example-revisted"><i class="fa fa-check"></i><b>11.9.1</b> LSAT Example Revisted</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="final-notes.html"><a href="final-notes.html"><i class="fa fa-check"></i><b>11.10</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="missing-data-modeling.html"><a href="missing-data-modeling.html"><i class="fa fa-check"></i><b>12</b> Missing Data Modeling</a></li>
<li class="chapter" data-level="13" data-path="latent-class-analysis.html"><a href="latent-class-analysis.html"><i class="fa fa-check"></i><b>13</b> Latent Class Analysis</a></li>
<li class="chapter" data-level="14" data-path="bayesian-networks.html"><a href="bayesian-networks.html"><i class="fa fa-check"></i><b>14</b> Bayesian Networks</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/noah-padgett" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pl-lsat-example" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> 3-PL LSAT Example</h2>
<p>In the Law School Admission Test (LSAT) example (p.Â 263-271), the data are from 1000 examinees responding to five items which is just a subset of the LSAT.
We hypothesize that only one underlying latent variable is measured by these items.
But that guessing is also plausible.
The full 3-PL model we will use can be described in an equation as
<span class="math display">\[p(\boldsymbol{\theta}, \boldsymbol{d}, \boldsymbol{a}, \boldsymbol{c} \mid \mathbf{x}) \propto \prod_{i=1}^n\prod_{j=1}^Jp(\theta_i\mid\theta_i, d_j, a_j, c_j)p(\theta_i)p(d_j)p(a_j)p(c_j),\]</span>
where
<span class="math display">\[\begin{align*}
x_{ij}\mid\theta_i\mid\theta_i, d_j, a_j, c_j &amp;\sim \mathrm{Bernoulli}[p(\theta_i\mid\theta_i, d_j, a_j, c_j)],\ \mathrm{for}\ i=1, \cdots, 100,\ j = 1, \cdots, 5;\\
p(\theta_i\mid\theta_i, d_j, a_j, c_j) &amp;= c_j + (1-c_j)\Phi(a_j\theta_j + d_j),\ \mathrm{for}\ i=1, \cdots, 100,\ j = 1, \cdots, 5;\\
\theta_i &amp;\sim \mathrm{Normal}(0,1),\ \mathrm{for}\ i = 1, \cdots, 1000;\\
d_j &amp;\sim \mathrm{Normal}(0, 2),\ \mathrm{for}\ j=1, \cdots, 5;\\
a_j &amp;\sim \mathrm{Normal}^{+}(1, 2),\ \mathrm{for}\ j=1, \cdots, 5;\\
c_j &amp;\sim \mathrm{Beta}(5, 17),\ \mathrm{for}\ j=1, \cdots, 5.
\end{align*}\]</span></p>
<p>The above model can illustrated in a DAG as shown below.</p>
<div class="figure" style="text-align: center"><span id="fig:chp11-dag-1"></span>
<img src="dag/chp11-irt1.png" alt="DAG for 3-PL IRT model for LSAT Example" width="612" />
<p class="caption">
Figure 11.1: DAG for 3-PL IRT model for LSAT Example
</p>
</div>
<p>The path diagram for an IRT is essentially identical to the path diagram for a CFA model.
This fact highlights an important feature of IRT/CFA in that the major conceptual difference between these approaches to is how we define the link between the latent variable the observed items.</p>
<div class="figure" style="text-align: center"><span id="fig:chp11-pathdiag-1"></span>
<img src="path-diagram/chp11-irt1.png" alt="Path diagram for 3-PL IRT model" width="504" />
<p class="caption">
Figure 11.2: Path diagram for 3-PL IRT model
</p>
</div>
<p>For completeness, I have included the model specification diagram that more concretely connects the DAG and path diagram to the assumed distributions and priors.</p>
<div class="figure" style="text-align: center"><span id="fig:chp11-spec-1"></span>
<img src="model-spec/chp11-irt1.png" alt="Model specification diagram for the 3-PL IRT model" width="728" />
<p class="caption">
Figure 11.3: Model specification diagram for the 3-PL IRT model
</p>
</div>
<<<<<<< Updated upstream
<div id="lsat-example-using-jags" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> LSAT Example Using JAGS</h3>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="pl-lsat-example.html#cb302-1" aria-hidden="true" tabindex="-1"></a>jags.model.lsat <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb302-2"><a href="pl-lsat-example.html#cb302-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-3"><a href="pl-lsat-example.html#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################</span></span>
<span id="cb302-4"><a href="pl-lsat-example.html#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the item response measurement model for the observables</span></span>
<span id="cb302-5"><a href="pl-lsat-example.html#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################</span></span>
<span id="cb302-6"><a href="pl-lsat-example.html#cb302-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb302-7"><a href="pl-lsat-example.html#cb302-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J){</span>
<span id="cb302-8"><a href="pl-lsat-example.html#cb302-8" aria-hidden="true" tabindex="-1"></a>    P[i,j] <span class="ot">&lt;-</span> c[j]<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>c[j])<span class="sc">*</span><span class="fu">phi</span>(a[j]<span class="sc">*</span>theta[i]<span class="sc">+</span>d[j])       <span class="co"># 3P-NO expression</span></span>
<span id="cb302-9"><a href="pl-lsat-example.html#cb302-9" aria-hidden="true" tabindex="-1"></a>    x[i,j] <span class="sc">~</span> <span class="fu">dbern</span>(P[i,j])                  <span class="co"># distribution for each observable</span></span>
<span id="cb302-10"><a href="pl-lsat-example.html#cb302-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb302-11"><a href="pl-lsat-example.html#cb302-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb302-12"><a href="pl-lsat-example.html#cb302-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-13"><a href="pl-lsat-example.html#cb302-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-14"><a href="pl-lsat-example.html#cb302-14" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################</span></span>
<span id="cb302-15"><a href="pl-lsat-example.html#cb302-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the (prior) distribution for the latent variables</span></span>
<span id="cb302-16"><a href="pl-lsat-example.html#cb302-16" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################</span></span>
<span id="cb302-17"><a href="pl-lsat-example.html#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb302-18"><a href="pl-lsat-example.html#cb302-18" aria-hidden="true" tabindex="-1"></a>  theta[i] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># distribution for the latent variables</span></span>
<span id="cb302-19"><a href="pl-lsat-example.html#cb302-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb302-20"><a href="pl-lsat-example.html#cb302-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-21"><a href="pl-lsat-example.html#cb302-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-22"><a href="pl-lsat-example.html#cb302-22" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################</span></span>
<span id="cb302-23"><a href="pl-lsat-example.html#cb302-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the prior distribution for the measurement model parameters</span></span>
<span id="cb302-24"><a href="pl-lsat-example.html#cb302-24" aria-hidden="true" tabindex="-1"></a><span class="do">##########################################</span></span>
<span id="cb302-25"><a href="pl-lsat-example.html#cb302-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J){</span>
<span id="cb302-26"><a href="pl-lsat-example.html#cb302-26" aria-hidden="true" tabindex="-1"></a>  d[j] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, .<span class="dv">5</span>)          <span class="co"># Locations for observables</span></span>
<span id="cb302-27"><a href="pl-lsat-example.html#cb302-27" aria-hidden="true" tabindex="-1"></a>  a[j] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, .<span class="dv">5</span>); <span class="fu">I</span>(<span class="dv">0</span>,)    <span class="co"># Discriminations for observables</span></span>
<span id="cb302-28"><a href="pl-lsat-example.html#cb302-28" aria-hidden="true" tabindex="-1"></a>  c[j] <span class="sc">~</span> <span class="fu">dbeta</span>(<span class="dv">5</span>,<span class="dv">17</span>)           <span class="co"># Lower asymptotes for observables</span></span>
<span id="cb302-29"><a href="pl-lsat-example.html#cb302-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb302-30"><a href="pl-lsat-example.html#cb302-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb302-31"><a href="pl-lsat-example.html#cb302-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-32"><a href="pl-lsat-example.html#cb302-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-33"><a href="pl-lsat-example.html#cb302-33" aria-hidden="true" tabindex="-1"></a>} <span class="co"># closes the model</span></span>
<span id="cb302-34"><a href="pl-lsat-example.html#cb302-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-35"><a href="pl-lsat-example.html#cb302-35" aria-hidden="true" tabindex="-1"></a><span class="co"># initial values</span></span>
<span id="cb302-36"><a href="pl-lsat-example.html#cb302-36" aria-hidden="true" tabindex="-1"></a>start_values <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb302-37"><a href="pl-lsat-example.html#cb302-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;d&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>),</span>
<span id="cb302-38"><a href="pl-lsat-example.html#cb302-38" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;a&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>),</span>
<span id="cb302-39"><a href="pl-lsat-example.html#cb302-39" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;c&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>, <span class="fl">0.20</span>)),</span>
<span id="cb302-40"><a href="pl-lsat-example.html#cb302-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;d&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="sc">-</span><span class="fl">3.00</span>, <span class="sc">-</span><span class="fl">3.00</span>, <span class="sc">-</span><span class="fl">3.00</span>, <span class="sc">-</span><span class="fl">3.00</span>, <span class="sc">-</span><span class="fl">3.00</span>),</span>
<span id="cb302-41"><a href="pl-lsat-example.html#cb302-41" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;a&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>),</span>
<span id="cb302-42"><a href="pl-lsat-example.html#cb302-42" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;c&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>, <span class="fl">0.50</span>)),</span>
<span id="cb302-43"><a href="pl-lsat-example.html#cb302-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="st">&quot;d&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>, <span class="fl">3.00</span>),</span>
<span id="cb302-44"><a href="pl-lsat-example.html#cb302-44" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;a&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>),</span>
<span id="cb302-45"><a href="pl-lsat-example.html#cb302-45" aria-hidden="true" tabindex="-1"></a>       <span class="st">&quot;c&quot;</span><span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span>))</span>
<span id="cb302-46"><a href="pl-lsat-example.html#cb302-46" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb302-47"><a href="pl-lsat-example.html#cb302-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-48"><a href="pl-lsat-example.html#cb302-48" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of all parameters to save</span></span>
<span id="cb302-49"><a href="pl-lsat-example.html#cb302-49" aria-hidden="true" tabindex="-1"></a>param_save <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;theta&quot;</span>)</span>
<span id="cb302-50"><a href="pl-lsat-example.html#cb302-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-51"><a href="pl-lsat-example.html#cb302-51" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset</span></span>
<span id="cb302-52"><a href="pl-lsat-example.html#cb302-52" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/LSAT.dat&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb302-53"><a href="pl-lsat-example.html#cb302-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-54"><a href="pl-lsat-example.html#cb302-54" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb302-55"><a href="pl-lsat-example.html#cb302-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(dat), <span class="at">J =</span> <span class="fu">ncol</span>(dat),</span>
<span id="cb302-56"><a href="pl-lsat-example.html#cb302-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">as.matrix</span>(dat)</span>
<span id="cb302-57"><a href="pl-lsat-example.html#cb302-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb302-58"><a href="pl-lsat-example.html#cb302-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-59"><a href="pl-lsat-example.html#cb302-59" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb302-60"><a href="pl-lsat-example.html#cb302-60" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">jags</span>(</span>
<span id="cb302-61"><a href="pl-lsat-example.html#cb302-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.file=</span>jags.model.lsat,</span>
<span id="cb302-62"><a href="pl-lsat-example.html#cb302-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>mydata,</span>
<span id="cb302-63"><a href="pl-lsat-example.html#cb302-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">inits=</span>start_values,</span>
<span id="cb302-64"><a href="pl-lsat-example.html#cb302-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters.to.save =</span> param_save,</span>
<span id="cb302-65"><a href="pl-lsat-example.html#cb302-65" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.iter=</span><span class="dv">20000</span>,</span>
<span id="cb302-66"><a href="pl-lsat-example.html#cb302-66" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.burnin =</span> <span class="dv">6000</span>,</span>
<span id="cb302-67"><a href="pl-lsat-example.html#cb302-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.chains =</span> <span class="dv">3</span>,</span>
<span id="cb302-68"><a href="pl-lsat-example.html#cb302-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">progress.bar =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<pre><code>## module glm loaded</code></pre>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 5000
##    Unobserved stochastic nodes: 1015
##    Total graph size: 31027
## 
## Initializing model</code></pre>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="pl-lsat-example.html#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit)</span></code></pre></div>
<pre><code>## Inference for Bugs model at &quot;C:/Users/noahp/AppData/Local/Temp/RtmporGNNv/model41c4569b1970.txt&quot;, fit using jags,
##  3 chains, each with 20000 iterations (first 6000 discarded), n.thin = 14
##  n.sims = 3000 iterations saved
##              mu.vect sd.vect     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## a[1]           0.471   0.181    0.175    0.346    0.450    0.569    0.881 1.002  1800
## a[2]           0.584   0.230    0.289    0.431    0.537    0.674    1.161 1.007   300
## a[3]           1.240   0.719    0.417    0.696    1.039    1.605    3.093 1.004   600
## a[4]           0.508   0.214    0.234    0.379    0.473    0.589    1.023 1.001  3000
## a[5]           0.417   0.154    0.154    0.313    0.404    0.505    0.765 1.001  3000
## c[1]           0.239   0.092    0.086    0.170    0.232    0.298    0.435 1.004   670
## c[2]           0.254   0.097    0.093    0.184    0.243    0.316    0.461 1.003   990
## c[3]           0.262   0.080    0.102    0.202    0.266    0.321    0.407 1.006   450
## c[4]           0.253   0.098    0.092    0.180    0.244    0.313    0.477 1.001  3000
## c[5]           0.241   0.090    0.087    0.174    0.232    0.300    0.429 1.001  2600
## d[1]           1.419   0.138    1.171    1.330    1.413    1.500    1.714 1.001  3000
## d[2]           0.294   0.189   -0.185    0.214    0.329    0.419    0.555 1.009   770
## d[3]          -0.537   0.455   -1.688   -0.776   -0.414   -0.199    0.032 1.014   210
## d[4]           0.512   0.160    0.121    0.435    0.538    0.617    0.746 1.001  3000
## d[5]           1.024   0.117    0.787    0.955    1.030    1.099    1.238 1.002  1100
## theta[1]      -1.659   0.776   -3.317   -2.159   -1.631   -1.129   -0.190 1.001  3000
## theta[2]      -1.615   0.785   -3.232   -2.145   -1.602   -1.092   -0.115 1.001  3000
## theta[3]      -1.643   0.767   -3.199   -2.162   -1.619   -1.102   -0.225 1.001  2100
## theta[4]      -1.301   0.764   -2.862   -1.833   -1.289   -0.756    0.134 1.001  2800
## theta[5]      -1.285   0.780   -2.856   -1.790   -1.266   -0.733    0.133 1.002  1600
## theta[6]      -1.298   0.776   -2.833   -1.809   -1.276   -0.763    0.159 1.002  1300
## theta[7]      -1.299   0.768   -2.835   -1.799   -1.292   -0.781    0.158 1.002  1600
## theta[8]      -1.315   0.759   -2.913   -1.812   -1.282   -0.771    0.061 1.002  1900
## theta[9]      -1.311   0.776   -2.881   -1.838   -1.295   -0.794    0.141 1.001  3000
## theta[10]     -1.310   0.795   -2.922   -1.834   -1.290   -0.739    0.207 1.003   860
## theta[11]     -1.299   0.788   -2.898   -1.824   -1.275   -0.741    0.167 1.001  3000
## theta[12]     -0.921   0.775   -2.465   -1.419   -0.925   -0.385    0.575 1.002  1200
## theta[13]     -0.971   0.777   -2.592   -1.477   -0.948   -0.448    0.478 1.001  2500
## theta[14]     -0.939   0.773   -2.493   -1.474   -0.906   -0.398    0.477 1.001  3000
## theta[15]     -0.935   0.774   -2.495   -1.444   -0.923   -0.392    0.526 1.001  3000
## theta[16]     -0.954   0.790   -2.490   -1.494   -0.938   -0.405    0.542 1.001  3000
## theta[17]     -0.935   0.766   -2.449   -1.452   -0.924   -0.415    0.543 1.001  3000
## theta[18]     -0.937   0.775   -2.477   -1.444   -0.935   -0.407    0.554 1.001  3000
## theta[19]     -0.951   0.789   -2.576   -1.460   -0.926   -0.406    0.528 1.001  3000
## theta[20]     -0.950   0.786   -2.499   -1.472   -0.925   -0.395    0.542 1.003   820
## theta[21]     -0.949   0.774   -2.504   -1.468   -0.949   -0.425    0.496 1.001  3000
## theta[22]     -0.950   0.762   -2.510   -1.445   -0.925   -0.445    0.481 1.001  3000
## theta[23]     -1.447   0.868   -3.105   -2.036   -1.448   -0.856    0.257 1.002  1600
## theta[24]     -0.983   0.877   -2.668   -1.578   -0.999   -0.377    0.694 1.002  1700
## theta[25]     -1.011   0.867   -2.731   -1.595   -1.021   -0.419    0.683 1.001  3000
## theta[26]     -1.052   0.914   -2.859   -1.671   -1.034   -0.444    0.711 1.002  1300
## theta[27]     -1.012   0.894   -2.724   -1.617   -1.009   -0.391    0.718 1.002  1700
## theta[28]     -0.549   0.881   -2.277   -1.150   -0.559    0.072    1.172 1.001  3000
## theta[29]     -0.551   0.877   -2.240   -1.147   -0.533    0.051    1.109 1.001  2300
## theta[30]     -0.541   0.908   -2.325   -1.155   -0.518    0.079    1.182 1.002  1200
## theta[31]     -0.557   0.873   -2.290   -1.135   -0.557    0.022    1.106 1.001  3000
## theta[32]     -1.318   0.777   -2.916   -1.813   -1.300   -0.793    0.145 1.001  3000
## theta[33]     -0.937   0.798   -2.557   -1.445   -0.929   -0.370    0.590 1.001  2100
## theta[34]     -0.947   0.791   -2.522   -1.495   -0.919   -0.394    0.527 1.002  1900
## theta[35]     -0.933   0.776   -2.469   -1.451   -0.908   -0.382    0.476 1.001  2000
## theta[36]     -0.952   0.782   -2.483   -1.469   -0.953   -0.411    0.554 1.002  1400
## theta[37]     -0.965   0.796   -2.580   -1.493   -0.943   -0.411    0.527 1.001  3000
## theta[38]     -0.933   0.791   -2.516   -1.456   -0.906   -0.400    0.572 1.002  1300
## theta[39]     -0.951   0.799   -2.522   -1.482   -0.941   -0.394    0.572 1.001  3000
## theta[40]     -0.948   0.798   -2.551   -1.479   -0.917   -0.422    0.581 1.001  3000
## theta[41]     -0.556   0.783   -2.134   -1.064   -0.527   -0.014    0.859 1.001  2900
## theta[42]     -0.596   0.791   -2.170   -1.118   -0.579   -0.071    0.931 1.001  3000
## theta[43]     -0.583   0.799   -2.190   -1.121   -0.568   -0.043    0.995 1.002  1400
## theta[44]     -0.562   0.784   -2.160   -1.063   -0.538   -0.032    0.893 1.001  3000
## theta[45]     -0.545   0.793   -2.197   -1.058   -0.520   -0.018    0.972 1.002  1900
## theta[46]     -0.546   0.780   -2.121   -1.052   -0.536   -0.027    0.979 1.002  1500
## theta[47]     -0.581   0.799   -2.214   -1.083   -0.555   -0.044    0.957 1.001  3000
## theta[48]     -0.572   0.784   -2.208   -1.068   -0.532   -0.052    0.898 1.001  2400
## theta[49]     -0.596   0.790   -2.233   -1.108   -0.568   -0.072    0.854 1.001  3000
## theta[50]     -0.538   0.797   -2.207   -1.067   -0.514    0.005    0.963 1.001  3000
## theta[51]     -0.572   0.785   -2.189   -1.048   -0.554   -0.064    0.925 1.002  1500
## theta[52]     -0.564   0.781   -2.135   -1.074   -0.550   -0.028    0.903 1.002  1700
## theta[53]     -0.581   0.777   -2.216   -1.104   -0.541   -0.052    0.881 1.001  3000
## theta[54]     -0.555   0.784   -2.121   -1.061   -0.524   -0.001    0.900 1.001  2600
## theta[55]     -0.534   0.801   -2.176   -1.052   -0.506    0.014    0.942 1.001  3000
## theta[56]     -0.573   0.794   -2.165   -1.097   -0.550   -0.033    0.896 1.001  3000
## theta[57]     -0.536   0.889   -2.381   -1.145   -0.527    0.078    1.163 1.001  3000
## theta[58]     -0.532   0.885   -2.344   -1.126   -0.522    0.075    1.161 1.001  3000
## theta[59]     -0.534   0.897   -2.333   -1.128   -0.514    0.073    1.204 1.001  3000
## theta[60]     -0.532   0.916   -2.318   -1.160   -0.531    0.114    1.212 1.001  2500
## theta[61]     -0.516   0.901   -2.262   -1.147   -0.505    0.102    1.194 1.001  3000
## theta[62]     -0.035   0.908   -1.810   -0.652   -0.032    0.590    1.710 1.001  3000
## theta[63]     -0.045   0.905   -1.896   -0.642   -0.025    0.556    1.729 1.001  3000
## theta[64]     -0.032   0.913   -1.867   -0.665   -0.010    0.602    1.706 1.001  3000
## theta[65]     -0.031   0.908   -1.850   -0.656   -0.015    0.605    1.684 1.001  3000
## theta[66]      0.006   0.903   -1.794   -0.573    0.027    0.611    1.707 1.001  3000
## theta[67]     -0.029   0.894   -1.800   -0.610   -0.011    0.565    1.715 1.003   850
## theta[68]     -0.035   0.914   -1.893   -0.664   -0.001    0.589    1.708 1.002  1900
## theta[69]      0.008   0.923   -1.807   -0.620    0.025    0.655    1.716 1.001  3000
## theta[70]     -0.042   0.891   -1.787   -0.627   -0.027    0.564    1.668 1.001  3000
## theta[71]     -0.030   0.896   -1.809   -0.627    0.017    0.578    1.693 1.001  3000
## theta[72]     -0.046   0.914   -1.900   -0.642   -0.025    0.573    1.703 1.001  3000
## theta[73]     -0.017   0.909   -1.812   -0.629    0.034    0.611    1.647 1.001  3000
## theta[74]     -0.041   0.923   -1.982   -0.629   -0.018    0.604    1.647 1.001  2700
## theta[75]     -0.036   0.927   -1.937   -0.653    0.011    0.603    1.687 1.001  3000
## theta[76]     -0.008   0.912   -1.884   -0.616    0.037    0.600    1.675 1.001  3000
## theta[77]     -1.206   0.744   -2.692   -1.703   -1.192   -0.687    0.210 1.001  2600
## theta[78]     -1.202   0.775   -2.741   -1.711   -1.194   -0.673    0.265 1.002  1800
## theta[79]     -1.206   0.772   -2.758   -1.710   -1.191   -0.661    0.257 1.001  3000
## theta[80]     -1.186   0.769   -2.753   -1.704   -1.164   -0.657    0.253 1.001  3000
## theta[81]     -1.205   0.788   -2.817   -1.742   -1.193   -0.651    0.266 1.001  3000
## theta[82]     -1.187   0.786   -2.797   -1.707   -1.155   -0.637    0.234 1.003   740
## theta[83]     -1.197   0.757   -2.726   -1.703   -1.182   -0.683    0.269 1.001  3000
## theta[84]     -1.181   0.751   -2.724   -1.668   -1.155   -0.659    0.207 1.001  3000
## theta[85]     -1.182   0.780   -2.734   -1.710   -1.168   -0.648    0.313 1.001  3000
## theta[86]     -1.226   0.766   -2.768   -1.740   -1.185   -0.677    0.179 1.001  2700
## theta[87]     -0.847   0.752   -2.397   -1.334   -0.846   -0.325    0.585 1.001  3000
## theta[88]     -0.858   0.750   -2.370   -1.349   -0.846   -0.324    0.552 1.001  3000
## theta[89]     -0.832   0.757   -2.395   -1.319   -0.805   -0.302    0.558 1.002  1900
## theta[90]     -0.832   0.753   -2.352   -1.337   -0.793   -0.315    0.576 1.001  3000
## theta[91]     -0.832   0.752   -2.339   -1.308   -0.814   -0.323    0.582 1.001  3000
## theta[92]     -0.839   0.758   -2.387   -1.331   -0.836   -0.334    0.632 1.002  1600
## theta[93]     -0.847   0.772   -2.428   -1.347   -0.833   -0.315    0.595 1.001  3000
## theta[94]     -0.835   0.765   -2.408   -1.319   -0.825   -0.314    0.629 1.001  3000
## theta[95]     -0.829   0.762   -2.403   -1.331   -0.805   -0.316    0.604 1.001  2600
## theta[96]     -0.845   0.746   -2.369   -1.329   -0.839   -0.339    0.529 1.002  2000
##  [ reached getOption(&quot;max.print&quot;) -- omitted 905 rows ]
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 2749.6 and DIC = 7270.9
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="pl-lsat-example.html#cb307-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(fit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>summary[ <span class="sc">!</span><span class="fu">rownames</span>(fit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>summary) <span class="sc">%like%</span> <span class="st">&quot;theta&quot;</span>, ], <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##              mean     sd     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## a[1]        0.471  0.181    0.175    0.346    0.450    0.569    0.881 1.002  1800
## a[2]        0.584  0.230    0.289    0.431    0.537    0.674    1.161 1.007   300
## a[3]        1.240  0.719    0.417    0.696    1.039    1.605    3.093 1.004   600
## a[4]        0.508  0.214    0.234    0.379    0.473    0.589    1.023 1.001  3000
## a[5]        0.417  0.154    0.154    0.313    0.404    0.505    0.765 1.001  3000
## c[1]        0.239  0.092    0.086    0.170    0.232    0.298    0.435 1.004   670
## c[2]        0.254  0.097    0.093    0.184    0.243    0.316    0.461 1.003   990
## c[3]        0.262  0.080    0.102    0.202    0.266    0.321    0.407 1.006   450
## c[4]        0.253  0.098    0.092    0.180    0.244    0.313    0.477 1.001  3000
## c[5]        0.241  0.090    0.087    0.174    0.232    0.300    0.429 1.001  2600
## d[1]        1.419  0.138    1.171    1.330    1.413    1.500    1.714 1.001  3000
## d[2]        0.294  0.189   -0.185    0.214    0.329    0.419    0.555 1.009   770
## d[3]       -0.537  0.455   -1.688   -0.776   -0.414   -0.199    0.032 1.014   210
## d[4]        0.512  0.160    0.121    0.435    0.538    0.617    0.746 1.001  3000
## d[5]        1.024  0.117    0.787    0.955    1.030    1.099    1.238 1.002  1100
## deviance 4521.341 74.150 4359.677 4477.858 4525.361 4572.117 4651.660 1.002  3000</code></pre>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="pl-lsat-example.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract posteriors for all chains</span></span>
<span id="cb309-2"><a href="pl-lsat-example.html#cb309-2" aria-hidden="true" tabindex="-1"></a>jags.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(fit)</span>
<span id="cb309-3"><a href="pl-lsat-example.html#cb309-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the below two plots are too big to be useful given the 1000 observations.</span></span>
<span id="cb309-4"><a href="pl-lsat-example.html#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="co">#R2jags::traceplot(jags.mcmc)</span></span>
<span id="cb309-5"><a href="pl-lsat-example.html#cb309-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-6"><a href="pl-lsat-example.html#cb309-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gelman-rubin-brook</span></span>
<span id="cb309-7"><a href="pl-lsat-example.html#cb309-7" aria-hidden="true" tabindex="-1"></a><span class="co">#gelman.plot(jags.mcmc)</span></span>
<span id="cb309-8"><a href="pl-lsat-example.html#cb309-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-9"><a href="pl-lsat-example.html#cb309-9" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to single data.frame for density plot</span></span>
<span id="cb309-10"><a href="pl-lsat-example.html#cb309-10" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">colnames</span>(<span class="fu">as.data.frame</span>(jags.mcmc[[<span class="dv">1</span>]]))</span>
<span id="cb309-11"><a href="pl-lsat-example.html#cb309-11" aria-hidden="true" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">as.matrix</span>(jags.mcmc, <span class="at">chains=</span>T, <span class="at">iters =</span> T))</span>
<span id="cb309-12"><a href="pl-lsat-example.html#cb309-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plot.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;chain&quot;</span>, <span class="st">&quot;iter&quot;</span>, a)</span>
<span id="cb309-13"><a href="pl-lsat-example.html#cb309-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-14"><a href="pl-lsat-example.html#cb309-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb309-15"><a href="pl-lsat-example.html#cb309-15" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Posterior distributions&quot;</span>,</span>
<span id="cb309-16"><a href="pl-lsat-example.html#cb309-16" aria-hidden="true" tabindex="-1"></a>                      <span class="st">&quot;with medians and 80% intervals&quot;</span>)</span>
<span id="cb309-17"><a href="pl-lsat-example.html#cb309-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(</span>
<span id="cb309-18"><a href="pl-lsat-example.html#cb309-18" aria-hidden="true" tabindex="-1"></a>  plot.data,</span>
<span id="cb309-19"><a href="pl-lsat-example.html#cb309-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;d[&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="st">&quot;]&quot;</span>)),</span>
<span id="cb309-20"><a href="pl-lsat-example.html#cb309-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb309-21"><a href="pl-lsat-example.html#cb309-21" aria-hidden="true" tabindex="-1"></a>  plot_title</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-lsat-jags-1.png" width="672" /></p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="pl-lsat-example.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(</span>
<span id="cb310-2"><a href="pl-lsat-example.html#cb310-2" aria-hidden="true" tabindex="-1"></a>  plot.data,</span>
<span id="cb310-3"><a href="pl-lsat-example.html#cb310-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;a[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">&quot;]&quot;</span>)),</span>
<span id="cb310-4"><a href="pl-lsat-example.html#cb310-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb310-5"><a href="pl-lsat-example.html#cb310-5" aria-hidden="true" tabindex="-1"></a>  plot_title</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-lsat-jags-2.png" width="672" /></p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="pl-lsat-example.html#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(</span>
<span id="cb311-2"><a href="pl-lsat-example.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  plot.data,</span>
<span id="cb311-3"><a href="pl-lsat-example.html#cb311-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;c[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="st">&quot;]&quot;</span>)),</span>
<span id="cb311-4"><a href="pl-lsat-example.html#cb311-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb311-5"><a href="pl-lsat-example.html#cb311-5" aria-hidden="true" tabindex="-1"></a>  plot_title</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-lsat-jags-3.png" width="672" /></p>
<div id="posterior-predicted-distributions" class="section level4" number="11.2.1.1">
<h4><span class="header-section-number">11.2.1.1</span> Posterior Predicted Distributions</h4>
<p>Here, we want to compare the observed and expected posterior predicted distributions.</p>
<p>Statistical functions of interest are the (1) standardized model-based covariance (SMBC) and (2) the standardized generalized discrepancy measure (SGDDM).</p>
<p>For (1), the SMBC is
<span class="math display">\[SMBC_{jj^\prime}=\frac{\frac{1}{n}\sum_{i=1}^n(x_{ij} - E(x_{ij} \mid \theta_i,\boldsymbol{\omega}_j))(x_{ij^\prime} - E(x_{ij^\prime} \mid \theta_i,\boldsymbol{\omega}_j^\prime))}{\sqrt{\frac{1}{n}\sum_{i=1}^n(x_{ij} - E(x_{ij} \mid \theta_i,\boldsymbol{\omega}_j))^2}\sqrt{\frac{1}{n}\sum_{i=1}^n(x_{ij^\prime} - E(x_{ij^\prime} \mid \theta_i,\boldsymbol{\omega}_j^\prime))}}\]</span></p>
<p>In R, the functions below can be used to compute these qualtities.</p>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="pl-lsat-example.html#cb312-1" aria-hidden="true" tabindex="-1"></a>calculate.SGDDM <span class="ot">&lt;-</span> <span class="cf">function</span>(data.matrix, expected.value.matrix){</span>
<span id="cb312-2"><a href="pl-lsat-example.html#cb312-2" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb312-3"><a href="pl-lsat-example.html#cb312-3" aria-hidden="true" tabindex="-1"></a>    J.local <span class="ot">=</span> <span class="fu">ncol</span>(data.matrix)</span>
<span id="cb312-4"><a href="pl-lsat-example.html#cb312-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-5"><a href="pl-lsat-example.html#cb312-5" aria-hidden="true" tabindex="-1"></a>    SMBC.matrix <span class="ot">&lt;-</span> <span class="fu">calculate.SMBC.matrix</span>(data.matrix, expected.value.matrix)</span>
<span id="cb312-6"><a href="pl-lsat-example.html#cb312-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb312-7"><a href="pl-lsat-example.html#cb312-7" aria-hidden="true" tabindex="-1"></a>    SGDDM <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">abs</span>((<span class="fu">lower.tri</span>(SMBC.matrix, <span class="at">diag=</span><span class="cn">FALSE</span>))<span class="sc">*</span>SMBC.matrix))<span class="sc">/</span>((J.local<span class="sc">*</span>(J.local<span class="dv">-1</span>))<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb312-8"><a href="pl-lsat-example.html#cb312-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-9"><a href="pl-lsat-example.html#cb312-9" aria-hidden="true" tabindex="-1"></a>    SGDDM</span>
<span id="cb312-10"><a href="pl-lsat-example.html#cb312-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-11"><a href="pl-lsat-example.html#cb312-11" aria-hidden="true" tabindex="-1"></a>} <span class="co"># closes calculate.SGDDM</span></span>
<span id="cb312-12"><a href="pl-lsat-example.html#cb312-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-13"><a href="pl-lsat-example.html#cb312-13" aria-hidden="true" tabindex="-1"></a>calculate.SMBC.matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(data.matrix, expected.value.matrix){</span>
<span id="cb312-14"><a href="pl-lsat-example.html#cb312-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb312-15"><a href="pl-lsat-example.html#cb312-15" aria-hidden="true" tabindex="-1"></a>    N.local <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data.matrix)</span>
<span id="cb312-16"><a href="pl-lsat-example.html#cb312-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-17"><a href="pl-lsat-example.html#cb312-17" aria-hidden="true" tabindex="-1"></a>    MBC.matrix <span class="ot">&lt;-</span> (<span class="fu">t</span>(data.matrix<span class="sc">-</span>expected.value.matrix) <span class="sc">%*%</span> (data.matrix<span class="sc">-</span>expected.value.matrix))<span class="sc">/</span>N.local</span>
<span id="cb312-18"><a href="pl-lsat-example.html#cb312-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-19"><a href="pl-lsat-example.html#cb312-19" aria-hidden="true" tabindex="-1"></a>    MBStddevs.matrix <span class="ot">&lt;-</span> <span class="fu">diag</span>(<span class="fu">sqrt</span>(<span class="fu">diag</span>(MBC.matrix)))</span>
<span id="cb312-20"><a href="pl-lsat-example.html#cb312-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-21"><a href="pl-lsat-example.html#cb312-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#SMBC.matrix &lt;- solve(MBStddevs.matrix) %*% MBC.matrix %*% solve(MBStddevs.matrix)</span></span>
<span id="cb312-22"><a href="pl-lsat-example.html#cb312-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-23"><a href="pl-lsat-example.html#cb312-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-24"><a href="pl-lsat-example.html#cb312-24" aria-hidden="true" tabindex="-1"></a>    J.local <span class="ot">&lt;-</span> <span class="fu">ncol</span>(data.matrix)</span>
<span id="cb312-25"><a href="pl-lsat-example.html#cb312-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-26"><a href="pl-lsat-example.html#cb312-26" aria-hidden="true" tabindex="-1"></a>    SMBC.matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow=</span>J.local, <span class="at">ncol=</span>J.local)</span>
<span id="cb312-27"><a href="pl-lsat-example.html#cb312-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-28"><a href="pl-lsat-example.html#cb312-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J.local){</span>
<span id="cb312-29"><a href="pl-lsat-example.html#cb312-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span>(jj <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J.local){</span>
<span id="cb312-30"><a href="pl-lsat-example.html#cb312-30" aria-hidden="true" tabindex="-1"></a>            SMBC.matrix[j,jj] <span class="ot">&lt;-</span> MBC.matrix[j,jj]<span class="sc">/</span>(MBStddevs.matrix[j,j]<span class="sc">*</span>MBStddevs.matrix[jj,jj])</span>
<span id="cb312-31"><a href="pl-lsat-example.html#cb312-31" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb312-32"><a href="pl-lsat-example.html#cb312-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb312-33"><a href="pl-lsat-example.html#cb312-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-34"><a href="pl-lsat-example.html#cb312-34" aria-hidden="true" tabindex="-1"></a>    SMBC.matrix </span>
<span id="cb312-35"><a href="pl-lsat-example.html#cb312-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-36"><a href="pl-lsat-example.html#cb312-36" aria-hidden="true" tabindex="-1"></a>} <span class="co"># closes calculate.MBC.matrix</span></span></code></pre></div>
<p>Next, we will use the functions above among other basic data wrangling to construct a full posterior predictive distribution analysis to probe our resulting posterior.</p>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="pl-lsat-example.html#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data wrangle the results/posterior draws for use</span></span>
<span id="cb313-2"><a href="pl-lsat-example.html#cb313-2" aria-hidden="true" tabindex="-1"></a>datv1 <span class="ot">&lt;-</span> plot.data <span class="sc">%&gt;%</span></span>
<span id="cb313-3"><a href="pl-lsat-example.html#cb313-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb313-4"><a href="pl-lsat-example.html#cb313-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="st">`</span><span class="at">a[1]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">a[5]</span><span class="st">`</span>,</span>
<span id="cb313-5"><a href="pl-lsat-example.html#cb313-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;a&quot;</span>,</span>
<span id="cb313-6"><a href="pl-lsat-example.html#cb313-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb313-7"><a href="pl-lsat-example.html#cb313-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb313-8"><a href="pl-lsat-example.html#cb313-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">substr</span>(item, <span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb313-9"><a href="pl-lsat-example.html#cb313-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(chain, iter, item, a)</span>
<span id="cb313-10"><a href="pl-lsat-example.html#cb313-10" aria-hidden="true" tabindex="-1"></a>datv2 <span class="ot">&lt;-</span> plot.data <span class="sc">%&gt;%</span></span>
<span id="cb313-11"><a href="pl-lsat-example.html#cb313-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb313-12"><a href="pl-lsat-example.html#cb313-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="st">`</span><span class="at">c[1]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">c[5]</span><span class="st">`</span>,</span>
<span id="cb313-13"><a href="pl-lsat-example.html#cb313-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;c&quot;</span>,</span>
<span id="cb313-14"><a href="pl-lsat-example.html#cb313-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb313-15"><a href="pl-lsat-example.html#cb313-15" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb313-16"><a href="pl-lsat-example.html#cb313-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">substr</span>(item, <span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb313-17"><a href="pl-lsat-example.html#cb313-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(chain, iter, item, c)</span>
<span id="cb313-18"><a href="pl-lsat-example.html#cb313-18" aria-hidden="true" tabindex="-1"></a>datv3 <span class="ot">&lt;-</span> plot.data <span class="sc">%&gt;%</span></span>
<span id="cb313-19"><a href="pl-lsat-example.html#cb313-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb313-20"><a href="pl-lsat-example.html#cb313-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="st">`</span><span class="at">d[1]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">d[5]</span><span class="st">`</span>,</span>
<span id="cb313-21"><a href="pl-lsat-example.html#cb313-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;d&quot;</span>,</span>
<span id="cb313-22"><a href="pl-lsat-example.html#cb313-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb313-23"><a href="pl-lsat-example.html#cb313-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb313-24"><a href="pl-lsat-example.html#cb313-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">item =</span> <span class="fu">substr</span>(item, <span class="dv">3</span>,<span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb313-25"><a href="pl-lsat-example.html#cb313-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(chain, iter, item, d)</span>
<span id="cb313-26"><a href="pl-lsat-example.html#cb313-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-27"><a href="pl-lsat-example.html#cb313-27" aria-hidden="true" tabindex="-1"></a>datv4 <span class="ot">&lt;-</span> plot.data <span class="sc">%&gt;%</span></span>
<span id="cb313-28"><a href="pl-lsat-example.html#cb313-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb313-29"><a href="pl-lsat-example.html#cb313-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="st">`</span><span class="at">theta[1]</span><span class="st">`</span><span class="sc">:</span><span class="st">`</span><span class="at">theta[999]</span><span class="st">`</span>,</span>
<span id="cb313-30"><a href="pl-lsat-example.html#cb313-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;theta&quot;</span>,</span>
<span id="cb313-31"><a href="pl-lsat-example.html#cb313-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;person&quot;</span></span>
<span id="cb313-32"><a href="pl-lsat-example.html#cb313-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb313-33"><a href="pl-lsat-example.html#cb313-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(chain, iter, person, theta)</span>
<span id="cb313-34"><a href="pl-lsat-example.html#cb313-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb313-35"><a href="pl-lsat-example.html#cb313-35" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> <span class="fu">full_join</span>(datv1, datv2)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;chain&quot;, &quot;iter&quot;, &quot;item&quot;)</code></pre>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="pl-lsat-example.html#cb315-1" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> <span class="fu">full_join</span>(dat_long, datv3)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;chain&quot;, &quot;iter&quot;, &quot;item&quot;)</code></pre>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="pl-lsat-example.html#cb317-1" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> <span class="fu">full_join</span>(dat_long, datv4)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;chain&quot;, &quot;iter&quot;)</code></pre>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="pl-lsat-example.html#cb319-1" aria-hidden="true" tabindex="-1"></a>dat1 <span class="ot">&lt;-</span> dat</span>
<span id="cb319-2"><a href="pl-lsat-example.html#cb319-2" aria-hidden="true" tabindex="-1"></a>dat1<span class="sc">$</span>person <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;theta[&quot;</span>,<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(dat), <span class="st">&quot;]&quot;</span>)</span>
<span id="cb319-3"><a href="pl-lsat-example.html#cb319-3" aria-hidden="true" tabindex="-1"></a>datvl <span class="ot">&lt;-</span> dat1 <span class="sc">%&gt;%</span></span>
<span id="cb319-4"><a href="pl-lsat-example.html#cb319-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb319-5"><a href="pl-lsat-example.html#cb319-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols=</span><span class="fu">contains</span>(<span class="st">&quot;item&quot;</span>),</span>
<span id="cb319-6"><a href="pl-lsat-example.html#cb319-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">&quot;item&quot;</span>,</span>
<span id="cb319-7"><a href="pl-lsat-example.html#cb319-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">&quot;x&quot;</span></span>
<span id="cb319-8"><a href="pl-lsat-example.html#cb319-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb319-9"><a href="pl-lsat-example.html#cb319-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb319-10"><a href="pl-lsat-example.html#cb319-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">item =</span> <span class="fu">substr</span>(item, <span class="dv">6</span>, <span class="dv">100</span>)</span>
<span id="cb319-11"><a href="pl-lsat-example.html#cb319-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb319-12"><a href="pl-lsat-example.html#cb319-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb319-13"><a href="pl-lsat-example.html#cb319-13" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> <span class="fu">left_join</span>(dat_long, datvl)</span></code></pre></div>
<pre><code>## Joining, by = c(&quot;item&quot;, &quot;person&quot;)</code></pre>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="pl-lsat-example.html#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute expected prob</span></span>
<span id="cb321-2"><a href="pl-lsat-example.html#cb321-2" aria-hidden="true" tabindex="-1"></a>ilogit <span class="ot">&lt;-</span> <span class="cf">function</span>(x){<span class="fu">exp</span>(x)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(x))}</span>
<span id="cb321-3"><a href="pl-lsat-example.html#cb321-3" aria-hidden="true" tabindex="-1"></a>dat_long <span class="ot">&lt;-</span> dat_long <span class="sc">%&gt;%</span></span>
<span id="cb321-4"><a href="pl-lsat-example.html#cb321-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()<span class="sc">%&gt;%</span></span>
<span id="cb321-5"><a href="pl-lsat-example.html#cb321-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb321-6"><a href="pl-lsat-example.html#cb321-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.exp =</span> c <span class="sc">+</span> (<span class="dv">1</span><span class="sc">-</span>c)<span class="sc">*</span><span class="fu">ilogit</span>(a<span class="sc">*</span>(theta <span class="sc">-</span> d)),</span>
<span id="cb321-7"><a href="pl-lsat-example.html#cb321-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">x.dif =</span> x <span class="sc">-</span> x.exp</span>
<span id="cb321-8"><a href="pl-lsat-example.html#cb321-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb321-9"><a href="pl-lsat-example.html#cb321-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-10"><a href="pl-lsat-example.html#cb321-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-11"><a href="pl-lsat-example.html#cb321-11" aria-hidden="true" tabindex="-1"></a>dat_long<span class="sc">$</span>x.ppd <span class="ot">&lt;-</span> <span class="fu">apply</span>(</span>
<span id="cb321-12"><a href="pl-lsat-example.html#cb321-12" aria-hidden="true" tabindex="-1"></a>  dat_long, <span class="dv">1</span>, </span>
<span id="cb321-13"><a href="pl-lsat-example.html#cb321-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN=</span><span class="cf">function</span>(x){</span>
<span id="cb321-14"><a href="pl-lsat-example.html#cb321-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbern</span>(<span class="dv">1</span>, <span class="fu">as.numeric</span>(x[<span class="dv">10</span>]))</span>
<span id="cb321-15"><a href="pl-lsat-example.html#cb321-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb321-16"><a href="pl-lsat-example.html#cb321-16" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb321-17"><a href="pl-lsat-example.html#cb321-17" aria-hidden="true" tabindex="-1"></a>itermin <span class="ot">&lt;-</span> <span class="fu">min</span>(dat_long<span class="sc">$</span>iter) <span class="co"># used for subseting</span></span>
<span id="cb321-18"><a href="pl-lsat-example.html#cb321-18" aria-hidden="true" tabindex="-1"></a><span class="co"># figure 11.4</span></span>
<span id="cb321-19"><a href="pl-lsat-example.html#cb321-19" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> dat_long <span class="sc">%&gt;%</span></span>
<span id="cb321-20"><a href="pl-lsat-example.html#cb321-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(chain, iter, person) <span class="sc">%&gt;%</span></span>
<span id="cb321-21"><a href="pl-lsat-example.html#cb321-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">raw.score =</span> <span class="fu">sum</span>(x),</span>
<span id="cb321-22"><a href="pl-lsat-example.html#cb321-22" aria-hidden="true" tabindex="-1"></a>            <span class="at">raw.score.ppd =</span> <span class="fu">sum</span>(x.ppd))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;chain&#39;, &#39;iter&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="pl-lsat-example.html#cb323-1" aria-hidden="true" tabindex="-1"></a>di <span class="ot">&lt;-</span> d[ d<span class="sc">$</span>chain <span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> d<span class="sc">$</span>iter <span class="sc">==</span> itermin, ] <span class="sc">%&gt;%</span></span>
<span id="cb323-2"><a href="pl-lsat-example.html#cb323-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(raw.score) <span class="sc">%&gt;%</span></span>
<span id="cb323-3"><a href="pl-lsat-example.html#cb323-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">count =</span> <span class="fu">n</span>())</span>
<span id="cb323-4"><a href="pl-lsat-example.html#cb323-4" aria-hidden="true" tabindex="-1"></a>dii <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb323-5"><a href="pl-lsat-example.html#cb323-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(chain, iter, raw.score.ppd)<span class="sc">%&gt;%</span></span>
<span id="cb323-6"><a href="pl-lsat-example.html#cb323-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">raw.score =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;chain&#39;, &#39;iter&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="pl-lsat-example.html#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># overall fit of observed scores</span></span>
<span id="cb325-2"><a href="pl-lsat-example.html#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb325-3"><a href="pl-lsat-example.html#cb325-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>dii, <span class="fu">aes</span>(<span class="at">y=</span>raw.score, <span class="at">x=</span> raw.score.ppd, <span class="at">group=</span>raw.score.ppd))<span class="sc">+</span></span>
<span id="cb325-4"><a href="pl-lsat-example.html#cb325-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>di, <span class="fu">aes</span>(<span class="at">x=</span>raw.score, <span class="at">y=</span>count), <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb325-5"><a href="pl-lsat-example.html#cb325-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Raw Score&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of Examinees&quot;</span>)<span class="sc">+</span></span>
<span id="cb325-6"><a href="pl-lsat-example.html#cb325-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">5</span>)<span class="sc">+</span></span>
<span id="cb325-7"><a href="pl-lsat-example.html#cb325-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-lsat-jags-ppd-1.png" width="672" /></p>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="pl-lsat-example.html#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="co"># by item</span></span>
<span id="cb326-2"><a href="pl-lsat-example.html#cb326-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> dat_long <span class="sc">%&gt;%</span></span>
<span id="cb326-3"><a href="pl-lsat-example.html#cb326-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(chain, iter, person) <span class="sc">%&gt;%</span></span>
<span id="cb326-4"><a href="pl-lsat-example.html#cb326-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">raw.score =</span> <span class="fu">sum</span>(x),</span>
<span id="cb326-5"><a href="pl-lsat-example.html#cb326-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">raw.score.ppd =</span> <span class="fu">sum</span>(x.ppd))</span>
<span id="cb326-6"><a href="pl-lsat-example.html#cb326-6" aria-hidden="true" tabindex="-1"></a>di <span class="ot">&lt;-</span> d[ d<span class="sc">$</span>chain <span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> d<span class="sc">$</span>iter <span class="sc">==</span> itermin, ] <span class="sc">%&gt;%</span></span>
<span id="cb326-7"><a href="pl-lsat-example.html#cb326-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(raw.score, item) <span class="sc">%&gt;%</span></span>
<span id="cb326-8"><a href="pl-lsat-example.html#cb326-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p.correct =</span> <span class="fu">mean</span>(x))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;raw.score&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="pl-lsat-example.html#cb328-1" aria-hidden="true" tabindex="-1"></a>dii <span class="ot">&lt;-</span> d <span class="sc">%&gt;%</span></span>
<span id="cb328-2"><a href="pl-lsat-example.html#cb328-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(chain, iter, raw.score.ppd, item)<span class="sc">%&gt;%</span></span>
<span id="cb328-3"><a href="pl-lsat-example.html#cb328-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">p.correct =</span> <span class="fu">mean</span>(x.ppd))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;chain&#39;, &#39;iter&#39;, &#39;raw.score.ppd&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="pl-lsat-example.html#cb330-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb330-2"><a href="pl-lsat-example.html#cb330-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>dii,</span>
<span id="cb330-3"><a href="pl-lsat-example.html#cb330-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">y=</span> p.correct,</span>
<span id="cb330-4"><a href="pl-lsat-example.html#cb330-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">x=</span> raw.score.ppd,</span>
<span id="cb330-5"><a href="pl-lsat-example.html#cb330-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">group=</span>raw.score.ppd))<span class="sc">+</span></span>
<span id="cb330-6"><a href="pl-lsat-example.html#cb330-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data=</span>di,</span>
<span id="cb330-7"><a href="pl-lsat-example.html#cb330-7" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x=</span>raw.score, <span class="at">y=</span>p.correct),</span>
<span id="cb330-8"><a href="pl-lsat-example.html#cb330-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span><span class="st">&quot;red&quot;</span>, <span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb330-9"><a href="pl-lsat-example.html#cb330-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>item)<span class="sc">+</span></span>
<span id="cb330-10"><a href="pl-lsat-example.html#cb330-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">&quot;Raw Score&quot;</span>, <span class="at">y=</span><span class="st">&quot;Number of Examinees&quot;</span>)<span class="sc">+</span></span>
<span id="cb330-11"><a href="pl-lsat-example.html#cb330-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-lsat-jags-ppd-2.png" width="672" /></p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="pl-lsat-example.html#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># computing standardized model summary statistics</span></span>
<span id="cb331-2"><a href="pl-lsat-example.html#cb331-2" aria-hidden="true" tabindex="-1"></a><span class="co"># objects for results</span></span>
<span id="cb331-3"><a href="pl-lsat-example.html#cb331-3" aria-hidden="true" tabindex="-1"></a>J <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb331-4"><a href="pl-lsat-example.html#cb331-4" aria-hidden="true" tabindex="-1"></a>n.chain <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb331-5"><a href="pl-lsat-example.html#cb331-5" aria-hidden="true" tabindex="-1"></a>n.iters <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">unique</span>(dat_long<span class="sc">$</span>iter))</span>
<span id="cb331-6"><a href="pl-lsat-example.html#cb331-6" aria-hidden="true" tabindex="-1"></a>n.iters.PPMC <span class="ot">&lt;-</span> n.iters<span class="sc">*</span>n.chain</span>
<span id="cb331-7"><a href="pl-lsat-example.html#cb331-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-8"><a href="pl-lsat-example.html#cb331-8" aria-hidden="true" tabindex="-1"></a>realized.SMBC.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(n.iters.PPMC, J, J))</span>
<span id="cb331-9"><a href="pl-lsat-example.html#cb331-9" aria-hidden="true" tabindex="-1"></a>postpred.SMBC.array <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(n.iters.PPMC, J, J))</span>
<span id="cb331-10"><a href="pl-lsat-example.html#cb331-10" aria-hidden="true" tabindex="-1"></a>realized.SGDDM.vector <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(n.iters.PPMC))</span>
<span id="cb331-11"><a href="pl-lsat-example.html#cb331-11" aria-hidden="true" tabindex="-1"></a>postpred.SGDDM.vector <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="fu">c</span>(n.iters.PPMC))</span>
<span id="cb331-12"><a href="pl-lsat-example.html#cb331-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-13"><a href="pl-lsat-example.html#cb331-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-14"><a href="pl-lsat-example.html#cb331-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-15"><a href="pl-lsat-example.html#cb331-15" aria-hidden="true" tabindex="-1"></a>ii <span class="ot">&lt;-</span> i <span class="ot">&lt;-</span> c <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb331-16"><a href="pl-lsat-example.html#cb331-16" aria-hidden="true" tabindex="-1"></a><span class="co"># iteration condiitons</span></span>
<span id="cb331-17"><a href="pl-lsat-example.html#cb331-17" aria-hidden="true" tabindex="-1"></a>iter.cond <span class="ot">&lt;-</span> <span class="fu">unique</span>(dat_long<span class="sc">$</span>iter)</span>
<span id="cb331-18"><a href="pl-lsat-example.html#cb331-18" aria-hidden="true" tabindex="-1"></a>Xobs <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(dat[,<span class="sc">-</span><span class="dv">6</span>])</span>
<span id="cb331-19"><a href="pl-lsat-example.html#cb331-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-20"><a href="pl-lsat-example.html#cb331-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(iter.cond)){</span>
<span id="cb331-21"><a href="pl-lsat-example.html#cb331-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(c <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>){</span>
<span id="cb331-22"><a href="pl-lsat-example.html#cb331-22" aria-hidden="true" tabindex="-1"></a>  cc <span class="ot">&lt;-</span> iter.cond[i]</span>
<span id="cb331-23"><a href="pl-lsat-example.html#cb331-23" aria-hidden="true" tabindex="-1"></a>  Xexp <span class="ot">&lt;-</span> dat_long[dat_long<span class="sc">$</span>chain<span class="sc">==</span>c <span class="sc">&amp;</span> dat_long<span class="sc">$</span>iter<span class="sc">==</span>cc , ] <span class="sc">%&gt;%</span></span>
<span id="cb331-24"><a href="pl-lsat-example.html#cb331-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb331-25"><a href="pl-lsat-example.html#cb331-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">id_cols =</span> person,</span>
<span id="cb331-26"><a href="pl-lsat-example.html#cb331-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;item&quot;</span>,</span>
<span id="cb331-27"><a href="pl-lsat-example.html#cb331-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="st">&quot;x.exp&quot;</span>,</span>
<span id="cb331-28"><a href="pl-lsat-example.html#cb331-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_prefix =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb331-29"><a href="pl-lsat-example.html#cb331-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb331-30"><a href="pl-lsat-example.html#cb331-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb331-31"><a href="pl-lsat-example.html#cb331-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(item1<span class="sc">:</span>item5)<span class="sc">%&gt;%</span></span>
<span id="cb331-32"><a href="pl-lsat-example.html#cb331-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb331-33"><a href="pl-lsat-example.html#cb331-33" aria-hidden="true" tabindex="-1"></a>  Xppd <span class="ot">&lt;-</span> dat_long[dat_long<span class="sc">$</span>chain<span class="sc">==</span>c <span class="sc">&amp;</span> dat_long<span class="sc">$</span>iter<span class="sc">==</span>cc , ] <span class="sc">%&gt;%</span></span>
<span id="cb331-34"><a href="pl-lsat-example.html#cb331-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(</span>
<span id="cb331-35"><a href="pl-lsat-example.html#cb331-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">id_cols =</span> person,</span>
<span id="cb331-36"><a href="pl-lsat-example.html#cb331-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_from =</span> <span class="st">&quot;item&quot;</span>,</span>
<span id="cb331-37"><a href="pl-lsat-example.html#cb331-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_from =</span> <span class="st">&quot;x.ppd&quot;</span>,</span>
<span id="cb331-38"><a href="pl-lsat-example.html#cb331-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_prefix =</span> <span class="st">&quot;item&quot;</span></span>
<span id="cb331-39"><a href="pl-lsat-example.html#cb331-39" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb331-40"><a href="pl-lsat-example.html#cb331-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()<span class="sc">%&gt;%</span></span>
<span id="cb331-41"><a href="pl-lsat-example.html#cb331-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(item1<span class="sc">:</span>item5)<span class="sc">%&gt;%</span></span>
<span id="cb331-42"><a href="pl-lsat-example.html#cb331-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.matrix</span>()</span>
<span id="cb331-43"><a href="pl-lsat-example.html#cb331-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-44"><a href="pl-lsat-example.html#cb331-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute realized values</span></span>
<span id="cb331-45"><a href="pl-lsat-example.html#cb331-45" aria-hidden="true" tabindex="-1"></a>  realized.SMBC.array[ii, ,] <span class="ot">&lt;-</span> <span class="fu">calculate.SMBC.matrix</span>(Xobs, Xexp)</span>
<span id="cb331-46"><a href="pl-lsat-example.html#cb331-46" aria-hidden="true" tabindex="-1"></a>  realized.SGDDM.vector[ii] <span class="ot">&lt;-</span>  <span class="fu">calculate.SGDDM</span>(Xobs, Xexp)</span>
<span id="cb331-47"><a href="pl-lsat-example.html#cb331-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># compute PPD values</span></span>
<span id="cb331-48"><a href="pl-lsat-example.html#cb331-48" aria-hidden="true" tabindex="-1"></a>  postpred.SMBC.array[ii, ,] <span class="ot">&lt;-</span> <span class="fu">calculate.SMBC.matrix</span>(Xppd, Xexp)</span>
<span id="cb331-49"><a href="pl-lsat-example.html#cb331-49" aria-hidden="true" tabindex="-1"></a>  postpred.SGDDM.vector[ii] <span class="ot">&lt;-</span>  <span class="fu">calculate.SGDDM</span>(Xppd, Xexp)</span>
<span id="cb331-50"><a href="pl-lsat-example.html#cb331-50" aria-hidden="true" tabindex="-1"></a>    ii <span class="ot">&lt;-</span> ii <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb331-51"><a href="pl-lsat-example.html#cb331-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb331-52"><a href="pl-lsat-example.html#cb331-52" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Next, generate plots to help summarize and describe the posterior predictor distributions of these statistics.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="pl-lsat-example.html#cb332-1" aria-hidden="true" tabindex="-1"></a>plot.dat.ppd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb332-2"><a href="pl-lsat-example.html#cb332-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">real =</span> realized.SGDDM.vector,</span>
<span id="cb332-3"><a href="pl-lsat-example.html#cb332-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ppd =</span> postpred.SGDDM.vector</span>
<span id="cb332-4"><a href="pl-lsat-example.html#cb332-4" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb332-5"><a href="pl-lsat-example.html#cb332-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-6"><a href="pl-lsat-example.html#cb332-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-7"><a href="pl-lsat-example.html#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot.dat.ppd, <span class="fu">aes</span>(<span class="at">x=</span>real, <span class="at">y=</span>ppd))<span class="sc">+</span></span>
<span id="cb332-8"><a href="pl-lsat-example.html#cb332-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb332-9"><a href="pl-lsat-example.html#cb332-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb332-10"><a href="pl-lsat-example.html#cb332-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>))</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-ppd-lsat-plots-1.png" width="672" /></p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="pl-lsat-example.html#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform smbc into plotable format</span></span>
<span id="cb333-2"><a href="pl-lsat-example.html#cb333-2" aria-hidden="true" tabindex="-1"></a>ddim <span class="ot">&lt;-</span> <span class="fu">dim</span>(postpred.SMBC.array)</span>
<span id="cb333-3"><a href="pl-lsat-example.html#cb333-3" aria-hidden="true" tabindex="-1"></a>plot.dat.ppd <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow=</span>ddim[<span class="dv">1</span>]<span class="sc">*</span>ddim[<span class="dv">2</span>]<span class="sc">*</span>ddim[<span class="dv">3</span>], <span class="at">ncol=</span><span class="dv">4</span>))</span>
<span id="cb333-4"><a href="pl-lsat-example.html#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plot.dat.ppd) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;itemj&quot;</span>, <span class="st">&quot;itemjj&quot;</span>, <span class="st">&quot;real&quot;</span>, <span class="st">&quot;ppd&quot;</span>)</span>
<span id="cb333-5"><a href="pl-lsat-example.html#cb333-5" aria-hidden="true" tabindex="-1"></a>ii <span class="ot">&lt;-</span> i <span class="ot">&lt;-</span> j <span class="ot">&lt;-</span> jj <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb333-6"><a href="pl-lsat-example.html#cb333-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-7"><a href="pl-lsat-example.html#cb333-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ddim[<span class="dv">1</span>]){</span>
<span id="cb333-8"><a href="pl-lsat-example.html#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ddim[<span class="dv">2</span>]){</span>
<span id="cb333-9"><a href="pl-lsat-example.html#cb333-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(jj <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>ddim[<span class="dv">3</span>]){</span>
<span id="cb333-10"><a href="pl-lsat-example.html#cb333-10" aria-hidden="true" tabindex="-1"></a>      plot.dat.ppd[ii, <span class="dv">1</span>] <span class="ot">&lt;-</span> j</span>
<span id="cb333-11"><a href="pl-lsat-example.html#cb333-11" aria-hidden="true" tabindex="-1"></a>      plot.dat.ppd[ii, <span class="dv">2</span>] <span class="ot">&lt;-</span> jj</span>
<span id="cb333-12"><a href="pl-lsat-example.html#cb333-12" aria-hidden="true" tabindex="-1"></a>      plot.dat.ppd[ii, <span class="dv">3</span>] <span class="ot">&lt;-</span> realized.SMBC.array[i, j, jj]</span>
<span id="cb333-13"><a href="pl-lsat-example.html#cb333-13" aria-hidden="true" tabindex="-1"></a>      plot.dat.ppd[ii, <span class="dv">4</span>] <span class="ot">&lt;-</span> postpred.SMBC.array[i, j, jj]</span>
<span id="cb333-14"><a href="pl-lsat-example.html#cb333-14" aria-hidden="true" tabindex="-1"></a>      ii <span class="ot">&lt;-</span> ii <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb333-15"><a href="pl-lsat-example.html#cb333-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb333-16"><a href="pl-lsat-example.html#cb333-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb333-17"><a href="pl-lsat-example.html#cb333-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb333-18"><a href="pl-lsat-example.html#cb333-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-19"><a href="pl-lsat-example.html#cb333-19" aria-hidden="true" tabindex="-1"></a>plot.dat.ppd <span class="ot">&lt;-</span> plot.dat.ppd <span class="sc">%&gt;%</span></span>
<span id="cb333-20"><a href="pl-lsat-example.html#cb333-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(itemj <span class="sc">&lt;</span> itemjj) <span class="sc">%&gt;%</span></span>
<span id="cb333-21"><a href="pl-lsat-example.html#cb333-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb333-22"><a href="pl-lsat-example.html#cb333-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">cov =</span> <span class="fu">paste0</span>(<span class="st">&quot;cov(&quot;</span>, itemj, <span class="st">&quot;, &quot;</span>, itemjj,<span class="st">&quot;)&quot;</span>)</span>
<span id="cb333-23"><a href="pl-lsat-example.html#cb333-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb333-24"><a href="pl-lsat-example.html#cb333-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-25"><a href="pl-lsat-example.html#cb333-25" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot.dat.ppd, <span class="fu">aes</span>(<span class="at">x=</span>real, <span class="at">y=</span>ppd))<span class="sc">+</span></span>
<span id="cb333-26"><a href="pl-lsat-example.html#cb333-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha=</span><span class="fl">0.25</span>)<span class="sc">+</span></span>
<span id="cb333-27"><a href="pl-lsat-example.html#cb333-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density2d</span>(<span class="at">adjust=</span><span class="dv">2</span>)<span class="sc">+</span></span>
<span id="cb333-28"><a href="pl-lsat-example.html#cb333-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">slope=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb333-29"><a href="pl-lsat-example.html#cb333-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(.<span class="sc">~</span>cov)<span class="sc">+</span></span>
<span id="cb333-30"><a href="pl-lsat-example.html#cb333-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lims</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb333-31"><a href="pl-lsat-example.html#cb333-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-ppd-lsat-plots-2.png" width="672" /></p>
</div>
</div>
=======
>>>>>>> Stashed changes
</div>
            </section>

          </div>
        </div>
      </div>
<a href="irt-models-for-dichotomous-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="lsat-example-jags.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/noah-padgett/Bayesian-Psychometric-Modeling/edit/master/11-irt.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-BPM.pdf", "bookdown-BPM.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
