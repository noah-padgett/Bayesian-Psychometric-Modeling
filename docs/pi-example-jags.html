<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11.7 PI Example - JAGS | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</title>
  <meta name="description" content="This online book is meant to serve a computation reference for the text Bayesian Psychometric Modeling by Roy Levy and Robert Mislevy. We hope that having a detailed computatin guide using Stan is of interest to someone." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="11.7 PI Example - JAGS | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This online book is meant to serve a computation reference for the text Bayesian Psychometric Modeling by Roy Levy and Robert Mislevy. We hope that having a detailed computatin guide using Stan is of interest to someone." />
  <meta name="github-repo" content="noah-padgett/Bayesian-Psychometric-Modeling" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11.7 PI Example - JAGS | Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy" />
  
  <meta name="twitter:description" content="This online book is meant to serve a computation reference for the text Bayesian Psychometric Modeling by Roy Levy and Robert Mislevy. We hope that having a detailed computatin guide using Stan is of interest to someone." />
  

<meta name="author" content="R. Noah Padgett" />


<meta name="date" content="2021-10-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="grm-peer-interactions-example.html"/>
<link rel="next" href="pi-example-stan.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Bayesian Psychometric Modeling</a></li>

<li class="divider"></li>
<li class="part"><span><b>I Foundations</b></span></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Getting Started/Overview Chapter</a>
<ul>
<li class="chapter" data-level="1.1" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>1.1</b> Software</a></li>
<li class="chapter" data-level="1.2" data-path="overview-of-assessment-and-psychometric-modeling.html"><a href="overview-of-assessment-and-psychometric-modeling.html"><i class="fa fa-check"></i><b>1.2</b> Overview of Assessment and Psychometric Modeling</a></li>
<li class="chapter" data-level="1.3" data-path="looking-forward.html"><a href="looking-forward.html"><i class="fa fa-check"></i><b>1.3</b> Looking Forward</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chp2.html"><a href="chp2.html"><i class="fa fa-check"></i><b>2</b> Introduction to Bayesian Inference</a>
<ul>
<li class="chapter" data-level="2.1" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html"><i class="fa fa-check"></i><b>2.1</b> Beta-binomial Example</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html#computation-using-stan"><i class="fa fa-check"></i><b>2.1.1</b> Computation using Stan</a></li>
<li class="chapter" data-level="2.1.2" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html#computation-using-winbugs-openbugs"><i class="fa fa-check"></i><b>2.1.2</b> Computation using WinBUGS (OpenBUGS)</a></li>
<li class="chapter" data-level="2.1.3" data-path="beta-binomial-example.html"><a href="beta-binomial-example.html#computation-using-jags-r2jags"><i class="fa fa-check"></i><b>2.1.3</b> Computation using JAGS (R2jags)</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html"><i class="fa fa-check"></i><b>2.2</b> Beta-Bernoulli Example</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html#computation-using-stan-1"><i class="fa fa-check"></i><b>2.2.1</b> Computation using Stan</a></li>
<li class="chapter" data-level="2.2.2" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html#computation-using-winbugs-openbugs-1"><i class="fa fa-check"></i><b>2.2.2</b> Computation using WinBUGS (OpenBUGS)</a></li>
<li class="chapter" data-level="2.2.3" data-path="beta-bernoulli-example.html"><a href="beta-bernoulli-example.html#computation-using-jags-r2jags-1"><i class="fa fa-check"></i><b>2.2.3</b> Computation using JAGS (R2jags)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="conceptual-issues-in-bayesian-inference.html"><a href="conceptual-issues-in-bayesian-inference.html"><i class="fa fa-check"></i><b>3</b> Conceptual Issues in Bayesian Inference</a></li>
<li class="chapter" data-level="4" data-path="normal-distribution-models.html"><a href="normal-distribution-models.html"><i class="fa fa-check"></i><b>4</b> Normal Distribution Models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="stan-model-for-mean-and-variance-unknown.html"><a href="stan-model-for-mean-and-variance-unknown.html"><i class="fa fa-check"></i><b>4.1</b> Stan Model for mean and variance unknown</a></li>
<li class="chapter" data-level="4.2" data-path="jags-model-for-mean-and-variance-unknown-precision-parameterization.html"><a href="jags-model-for-mean-and-variance-unknown-precision-parameterization.html"><i class="fa fa-check"></i><b>4.2</b> JAGS Model for mean and variance unknown (precision parameterization)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="markov-chain-monte-carlo-estimation.html"><a href="markov-chain-monte-carlo-estimation.html"><i class="fa fa-check"></i><b>5</b> Markov Chain Monte Carlo Estimation</a></li>
<li class="chapter" data-level="6" data-path="regression.html"><a href="regression.html"><i class="fa fa-check"></i><b>6</b> Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="stan-model-for-regression-model.html"><a href="stan-model-for-regression-model.html"><i class="fa fa-check"></i><b>6.1</b> Stan Model for Regression Model</a></li>
<li class="chapter" data-level="6.2" data-path="jags-model-for-regression-model.html"><a href="jags-model-for-regression-model.html"><i class="fa fa-check"></i><b>6.2</b> JAGS Model for Regression Model</a></li>
</ul></li>
<li class="part"><span><b>II Psychometrics</b></span></li>
<li class="chapter" data-level="7" data-path="canonical-bayesian-psychometric-modeling.html"><a href="canonical-bayesian-psychometric-modeling.html"><i class="fa fa-check"></i><b>7</b> Canonical Bayesian Psychometric Modeling</a></li>
<li class="chapter" data-level="8" data-path="classical-test-theory.html"><a href="classical-test-theory.html"><i class="fa fa-check"></i><b>8</b> Classical Test Theory</a>
<ul>
<li class="chapter" data-level="8.1" data-path="example-1-known-measurement-model-parameters-with-1-measure.html"><a href="example-1-known-measurement-model-parameters-with-1-measure.html"><i class="fa fa-check"></i><b>8.1</b> Example 1 - Known measurement model parameters with 1 measure</a></li>
<li class="chapter" data-level="8.2" data-path="example-1-stan.html"><a href="example-1-stan.html"><i class="fa fa-check"></i><b>8.2</b> Example 1 - Stan</a></li>
<li class="chapter" data-level="8.3" data-path="example-1-jags.html"><a href="example-1-jags.html"><i class="fa fa-check"></i><b>8.3</b> Example 1 - JAGS</a></li>
<li class="chapter" data-level="8.4" data-path="example-2-known-measurement-model-with-multiple-measures.html"><a href="example-2-known-measurement-model-with-multiple-measures.html"><i class="fa fa-check"></i><b>8.4</b> Example 2 - Known Measurement Model with Multiple Measures</a></li>
<li class="chapter" data-level="8.5" data-path="example-2-stan.html"><a href="example-2-stan.html"><i class="fa fa-check"></i><b>8.5</b> Example 2 - Stan</a></li>
<li class="chapter" data-level="8.6" data-path="example-2-jags.html"><a href="example-2-jags.html"><i class="fa fa-check"></i><b>8.6</b> Example 2 - JAGS</a></li>
<li class="chapter" data-level="8.7" data-path="example-3-unknown-measurement-model-with-multiple-measures.html"><a href="example-3-unknown-measurement-model-with-multiple-measures.html"><i class="fa fa-check"></i><b>8.7</b> Example 3 - Unknown Measurement Model with Multiple Measures</a></li>
<li class="chapter" data-level="8.8" data-path="example-3-stan.html"><a href="example-3-stan.html"><i class="fa fa-check"></i><b>8.8</b> Example 3 - Stan</a></li>
<li class="chapter" data-level="8.9" data-path="example-3-jags.html"><a href="example-3-jags.html"><i class="fa fa-check"></i><b>8.9</b> Example 3 - JAGS</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="confirmatory-factor-analysis.html"><a href="confirmatory-factor-analysis.html"><i class="fa fa-check"></i><b>9</b> Confirmatory Factor Analysis</a>
<ul>
<li class="chapter" data-level="9.1" data-path="single-latent-variable-model.html"><a href="single-latent-variable-model.html"><i class="fa fa-check"></i><b>9.1</b> Single Latent Variable Model</a></li>
<li class="chapter" data-level="9.2" data-path="jags-single-latent-variable.html"><a href="jags-single-latent-variable.html"><i class="fa fa-check"></i><b>9.2</b> JAGS - Single Latent Variable</a></li>
<li class="chapter" data-level="9.3" data-path="stan-single-latent-variable.html"><a href="stan-single-latent-variable.html"><i class="fa fa-check"></i><b>9.3</b> Stan - Single Latent Variable</a></li>
<li class="chapter" data-level="9.4" data-path="blavaan-single-latent-variable.html"><a href="blavaan-single-latent-variable.html"><i class="fa fa-check"></i><b>9.4</b> Blavaan - Single Latent Variable</a></li>
<li class="chapter" data-level="9.5" data-path="jags-two-latent-variable.html"><a href="jags-two-latent-variable.html"><i class="fa fa-check"></i><b>9.5</b> JAGS - Two Latent Variable</a></li>
<li class="chapter" data-level="9.6" data-path="stan-two-latent-variable.html"><a href="stan-two-latent-variable.html"><i class="fa fa-check"></i><b>9.6</b> Stan - Two Latent Variable</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="stan-two-latent-variable.html"><a href="stan-two-latent-variable.html#inverse-wishart-prior"><i class="fa fa-check"></i><b>9.6.1</b> Inverse-Wishart Prior</a></li>
<li class="chapter" data-level="9.6.2" data-path="stan-two-latent-variable.html"><a href="stan-two-latent-variable.html#lkj-cholesky-parameterization"><i class="fa fa-check"></i><b>9.6.2</b> LKJ Cholesky Parameterization</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="blavaan-two-latent-variables.html"><a href="blavaan-two-latent-variables.html"><i class="fa fa-check"></i><b>9.7</b> Blavaan - Two Latent Variables</a></li>
<li class="chapter" data-level="9.8" data-path="indeterminacy-in-one-factor-cfa.html"><a href="indeterminacy-in-one-factor-cfa.html"><i class="fa fa-check"></i><b>9.8</b> Indeterminacy in One Factor CFA</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="model-evaluation.html"><a href="model-evaluation.html"><i class="fa fa-check"></i><b>10</b> Model Evaluation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="residual-analysis.html"><a href="residual-analysis.html"><i class="fa fa-check"></i><b>10.1</b> Residual Analysis</a></li>
<li class="chapter" data-level="10.2" data-path="posterior-predictive-distributions.html"><a href="posterior-predictive-distributions.html"><i class="fa fa-check"></i><b>10.2</b> Posterior Predictive Distributions</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="posterior-predictive-distributions.html"><a href="posterior-predictive-distributions.html#example-of-posterior-predictive-distribution-of-correlations"><i class="fa fa-check"></i><b>10.2.1</b> Example of posterior predictive distribution of correlations</a></li>
<li class="chapter" data-level="10.2.2" data-path="posterior-predictive-distributions.html"><a href="posterior-predictive-distributions.html#ppd-srmr"><i class="fa fa-check"></i><b>10.2.2</b> PPD SRMR</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="model-comparison.html"><a href="model-comparison.html"><i class="fa fa-check"></i><b>10.3</b> Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="item-response-theory.html"><a href="item-response-theory.html"><i class="fa fa-check"></i><b>11</b> Item Response Theory</a>
<ul>
<li class="chapter" data-level="11.1" data-path="irt-models-for-dichotomous-data.html"><a href="irt-models-for-dichotomous-data.html"><i class="fa fa-check"></i><b>11.1</b> IRT Models for Dichotomous Data</a></li>
<li class="chapter" data-level="11.2" data-path="pl-lsat-example.html"><a href="pl-lsat-example.html"><i class="fa fa-check"></i><b>11.2</b> 3-PL LSAT Example</a></li>
<li class="chapter" data-level="11.3" data-path="lsat-example-jags.html"><a href="lsat-example-jags.html"><i class="fa fa-check"></i><b>11.3</b> LSAT Example - JAGS</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="lsat-example-jags.html"><a href="lsat-example-jags.html#posterior-predicted-distributions"><i class="fa fa-check"></i><b>11.3.1</b> Posterior Predicted Distributions</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="lsat-example-stan.html"><a href="lsat-example-stan.html"><i class="fa fa-check"></i><b>11.4</b> LSAT Example - Stan</a></li>
<li class="chapter" data-level="11.5" data-path="irt-models-for-polytomous-data.html"><a href="irt-models-for-polytomous-data.html"><i class="fa fa-check"></i><b>11.5</b> IRT Models for Polytomous Data</a></li>
<li class="chapter" data-level="11.6" data-path="grm-peer-interactions-example.html"><a href="grm-peer-interactions-example.html"><i class="fa fa-check"></i><b>11.6</b> GRM Peer Interactions Example</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="grm-peer-interactions-example.html"><a href="grm-peer-interactions-example.html#example-specific-model-specification"><i class="fa fa-check"></i><b>11.6.1</b> Example Specific Model Specification</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="pi-example-jags.html"><a href="pi-example-jags.html"><i class="fa fa-check"></i><b>11.7</b> PI Example - JAGS</a></li>
<li class="chapter" data-level="11.8" data-path="pi-example-stan.html"><a href="pi-example-stan.html"><i class="fa fa-check"></i><b>11.8</b> PI Example - Stan</a></li>
<li class="chapter" data-level="11.9" data-path="latent-response-formulation.html"><a href="latent-response-formulation.html"><i class="fa fa-check"></i><b>11.9</b> Latent Response Formulation</a>
<ul>
<li class="chapter" data-level="11.9.1" data-path="latent-response-formulation.html"><a href="latent-response-formulation.html#lsat-example-revisted"><i class="fa fa-check"></i><b>11.9.1</b> LSAT Example Revisted</a></li>
</ul></li>
<li class="chapter" data-level="11.10" data-path="final-notes.html"><a href="final-notes.html"><i class="fa fa-check"></i><b>11.10</b> Final Notes</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="missing-data-modeling.html"><a href="missing-data-modeling.html"><i class="fa fa-check"></i><b>12</b> Missing Data Modeling</a></li>
<li class="chapter" data-level="13" data-path="latent-class-analysis.html"><a href="latent-class-analysis.html"><i class="fa fa-check"></i><b>13</b> Latent Class Analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="lca-model-specification.html"><a href="lca-model-specification.html"><i class="fa fa-check"></i><b>13.1</b> LCA Model Specification</a>
<ul>
<li class="chapter" data-level="13.1.1" data-path="lca-model-specification.html"><a href="lca-model-specification.html#lca-model-indeterminacy"><i class="fa fa-check"></i><b>13.1.1</b> LCA Model Indeterminacy</a></li>
<li class="chapter" data-level="13.1.2" data-path="lca-model-specification.html"><a href="lca-model-specification.html#model-likelihood"><i class="fa fa-check"></i><b>13.1.2</b> Model Likelihood</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="extending-lca.html"><a href="extending-lca.html"><i class="fa fa-check"></i><b>13.2</b> Extending LCA</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="bayesian-networks.html"><a href="bayesian-networks.html"><i class="fa fa-check"></i><b>14</b> Bayesian Networks</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/noah-padgett" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Bayesian Psychometric Modeling (2016) by Roy Levy and Robert J. Mislevy</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pi-example---jags" class="section level2" number="11.7">
<h2><span class="header-section-number">11.7</span> PI Example - JAGS</h2>
<p>In the below implementation, I had to change <code>d[j,3] ~ dnorm(1, .5)I(d[j,4],d[j,2])</code> to <code>d[j,3] ~ dnorm(1, .5);I(,d[j,2])</code> because (1) R is dumb and doesn’t realize that <code>I</code> is a JAGS function; and (2) JAGS does not allow for a <code>directed cycle</code>.
The directed cycle in the DAG is when the range of values for <code>d[j,3]</code> is fixed to be within <code>I(d[j,4],d[j,2])</code> and is not permissible. We need to simply constrain the thresholds to be decreasing or smaller than the previous threshold.
I’m not sure of the underlying technical reason for this error, but I found that adding the semi-colon fixes the issue when defining the model as an R function.</p>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="pi-example-jags.html#cb399-1" aria-hidden="true" tabindex="-1"></a>jags.model.peer.int <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb399-2"><a href="pi-example-jags.html#cb399-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-3"><a href="pi-example-jags.html#cb399-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">#######################################</span></span>
<span id="cb399-4"><a href="pi-example-jags.html#cb399-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify the item response measurement model for the observables</span></span>
<span id="cb399-5"><a href="pi-example-jags.html#cb399-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">#######################################</span></span>
<span id="cb399-6"><a href="pi-example-jags.html#cb399-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb399-7"><a href="pi-example-jags.html#cb399-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J){</span>
<span id="cb399-8"><a href="pi-example-jags.html#cb399-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-9"><a href="pi-example-jags.html#cb399-9" aria-hidden="true" tabindex="-1"></a>      <span class="do">###################################</span></span>
<span id="cb399-10"><a href="pi-example-jags.html#cb399-10" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specify the probabilities of a value being greater than or equal to each category</span></span>
<span id="cb399-11"><a href="pi-example-jags.html#cb399-11" aria-hidden="true" tabindex="-1"></a>      <span class="do">###################################</span></span>
<span id="cb399-12"><a href="pi-example-jags.html#cb399-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(K[j])){</span>
<span id="cb399-13"><a href="pi-example-jags.html#cb399-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># P(greater than or equal to category k &gt; 1)</span></span>
<span id="cb399-14"><a href="pi-example-jags.html#cb399-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">logit</span>(P.gte[i,j,k]) <span class="ot">&lt;-</span> a[j]<span class="sc">*</span>theta[i]<span class="sc">+</span>d[j,k]</span>
<span id="cb399-15"><a href="pi-example-jags.html#cb399-15" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb399-16"><a href="pi-example-jags.html#cb399-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># P(greater than or equal to category 1)</span></span>
<span id="cb399-17"><a href="pi-example-jags.html#cb399-17" aria-hidden="true" tabindex="-1"></a>      P.gte[i,j,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb399-18"><a href="pi-example-jags.html#cb399-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-19"><a href="pi-example-jags.html#cb399-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-20"><a href="pi-example-jags.html#cb399-20" aria-hidden="true" tabindex="-1"></a>      <span class="do">###################################</span></span>
<span id="cb399-21"><a href="pi-example-jags.html#cb399-21" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specify the probabilities of a value being equal to each category</span></span>
<span id="cb399-22"><a href="pi-example-jags.html#cb399-22" aria-hidden="true" tabindex="-1"></a>      <span class="do">###################################</span></span>
<span id="cb399-23"><a href="pi-example-jags.html#cb399-23" aria-hidden="true" tabindex="-1"></a>      <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(K[j]<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb399-24"><a href="pi-example-jags.html#cb399-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># P(greater equal to category k &lt; K)</span></span>
<span id="cb399-25"><a href="pi-example-jags.html#cb399-25" aria-hidden="true" tabindex="-1"></a>        P[i,j,k] <span class="ot">&lt;-</span> P.gte[i,j,k]<span class="sc">-</span>P.gte[i,j,k<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb399-26"><a href="pi-example-jags.html#cb399-26" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb399-27"><a href="pi-example-jags.html#cb399-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># P(greater equal to category K)</span></span>
<span id="cb399-28"><a href="pi-example-jags.html#cb399-28" aria-hidden="true" tabindex="-1"></a>      P[i,j,K[j]] <span class="ot">&lt;-</span> P.gte[i,j,K[j]]</span>
<span id="cb399-29"><a href="pi-example-jags.html#cb399-29" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb399-30"><a href="pi-example-jags.html#cb399-30" aria-hidden="true" tabindex="-1"></a>      <span class="do">###################################</span></span>
<span id="cb399-31"><a href="pi-example-jags.html#cb399-31" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specify the distribution for each observable</span></span>
<span id="cb399-32"><a href="pi-example-jags.html#cb399-32" aria-hidden="true" tabindex="-1"></a>      <span class="do">###################################</span></span>
<span id="cb399-33"><a href="pi-example-jags.html#cb399-33" aria-hidden="true" tabindex="-1"></a>      x[i,j] <span class="sc">~</span> <span class="fu">dcat</span>(P[i,j,<span class="dv">1</span><span class="sc">:</span>K[j]])</span>
<span id="cb399-34"><a href="pi-example-jags.html#cb399-34" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb399-35"><a href="pi-example-jags.html#cb399-35" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb399-36"><a href="pi-example-jags.html#cb399-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-37"><a href="pi-example-jags.html#cb399-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-38"><a href="pi-example-jags.html#cb399-38" aria-hidden="true" tabindex="-1"></a>  <span class="do">#######################################</span></span>
<span id="cb399-39"><a href="pi-example-jags.html#cb399-39" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify the (prior) distribution for the latent variables</span></span>
<span id="cb399-40"><a href="pi-example-jags.html#cb399-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">#######################################</span></span>
<span id="cb399-41"><a href="pi-example-jags.html#cb399-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb399-42"><a href="pi-example-jags.html#cb399-42" aria-hidden="true" tabindex="-1"></a>    theta[i] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># distribution for the latent variables</span></span>
<span id="cb399-43"><a href="pi-example-jags.html#cb399-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb399-44"><a href="pi-example-jags.html#cb399-44" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-45"><a href="pi-example-jags.html#cb399-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-46"><a href="pi-example-jags.html#cb399-46" aria-hidden="true" tabindex="-1"></a>  <span class="do">#######################################</span></span>
<span id="cb399-47"><a href="pi-example-jags.html#cb399-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Specify the prior distribution for the measurement model parameters</span></span>
<span id="cb399-48"><a href="pi-example-jags.html#cb399-48" aria-hidden="true" tabindex="-1"></a>  <span class="do">#######################################</span></span>
<span id="cb399-49"><a href="pi-example-jags.html#cb399-49" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>J){</span>
<span id="cb399-50"><a href="pi-example-jags.html#cb399-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb399-51"><a href="pi-example-jags.html#cb399-51" aria-hidden="true" tabindex="-1"></a>    d[j,<span class="dv">2</span>] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">2</span>, .<span class="dv">5</span>)                   <span class="co"># Locations for k = 2</span></span>
<span id="cb399-52"><a href="pi-example-jags.html#cb399-52" aria-hidden="true" tabindex="-1"></a>    d[j,<span class="dv">3</span>] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, .<span class="dv">5</span>);<span class="fu">I</span>(,d[j,<span class="dv">2</span>])   <span class="co"># Locations for k = 3</span></span>
<span id="cb399-53"><a href="pi-example-jags.html#cb399-53" aria-hidden="true" tabindex="-1"></a>    d[j,<span class="dv">4</span>] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="sc">-</span><span class="dv">1</span>, .<span class="dv">5</span>);<span class="fu">I</span>(,d[j,<span class="dv">3</span>])  <span class="co"># Locations for k = 4</span></span>
<span id="cb399-54"><a href="pi-example-jags.html#cb399-54" aria-hidden="true" tabindex="-1"></a>    d[j,<span class="dv">5</span>] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="sc">-</span><span class="dv">2</span>, .<span class="dv">5</span>);<span class="fu">I</span>(,d[j,<span class="dv">4</span>])        <span class="co"># Locations for k = 5</span></span>
<span id="cb399-55"><a href="pi-example-jags.html#cb399-55" aria-hidden="true" tabindex="-1"></a>    a[j] <span class="sc">~</span> <span class="fu">dnorm</span>(<span class="dv">1</span>, .<span class="dv">5</span>); <span class="fu">I</span>(<span class="dv">0</span>,)    <span class="co"># Discriminations for observables</span></span>
<span id="cb399-56"><a href="pi-example-jags.html#cb399-56" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb399-57"><a href="pi-example-jags.html#cb399-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb399-58"><a href="pi-example-jags.html#cb399-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-59"><a href="pi-example-jags.html#cb399-59" aria-hidden="true" tabindex="-1"></a>} <span class="co"># closes the model</span></span>
<span id="cb399-60"><a href="pi-example-jags.html#cb399-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-61"><a href="pi-example-jags.html#cb399-61" aria-hidden="true" tabindex="-1"></a><span class="co"># initial values</span></span>
<span id="cb399-62"><a href="pi-example-jags.html#cb399-62" aria-hidden="true" tabindex="-1"></a>start_values <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb399-63"><a href="pi-example-jags.html#cb399-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb399-64"><a href="pi-example-jags.html#cb399-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">d=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>,</span>
<span id="cb399-65"><a href="pi-example-jags.html#cb399-65" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>,</span>
<span id="cb399-66"><a href="pi-example-jags.html#cb399-66" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>,</span>
<span id="cb399-67"><a href="pi-example-jags.html#cb399-67" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>,</span>
<span id="cb399-68"><a href="pi-example-jags.html#cb399-68" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>,</span>
<span id="cb399-69"><a href="pi-example-jags.html#cb399-69" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>,</span>
<span id="cb399-70"><a href="pi-example-jags.html#cb399-70" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">3.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>),</span>
<span id="cb399-71"><a href="pi-example-jags.html#cb399-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>T),</span>
<span id="cb399-72"><a href="pi-example-jags.html#cb399-72" aria-hidden="true" tabindex="-1"></a>    <span class="at">a=</span><span class="fu">c</span>(<span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>, <span class="fl">1.00E-01</span>)),</span>
<span id="cb399-73"><a href="pi-example-jags.html#cb399-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb399-74"><a href="pi-example-jags.html#cb399-74" aria-hidden="true" tabindex="-1"></a>    <span class="at">d=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>,</span>
<span id="cb399-75"><a href="pi-example-jags.html#cb399-75" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>,</span>
<span id="cb399-76"><a href="pi-example-jags.html#cb399-76" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>,</span>
<span id="cb399-77"><a href="pi-example-jags.html#cb399-77" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>,</span>
<span id="cb399-78"><a href="pi-example-jags.html#cb399-78" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>,</span>
<span id="cb399-79"><a href="pi-example-jags.html#cb399-79" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>,</span>
<span id="cb399-80"><a href="pi-example-jags.html#cb399-80" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">2.00E+00</span>, <span class="fl">0.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>),</span>
<span id="cb399-81"><a href="pi-example-jags.html#cb399-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>T),</span>
<span id="cb399-82"><a href="pi-example-jags.html#cb399-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">a=</span><span class="fu">c</span>(<span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>, <span class="fl">3.00E+00</span>)),</span>
<span id="cb399-83"><a href="pi-example-jags.html#cb399-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb399-84"><a href="pi-example-jags.html#cb399-84" aria-hidden="true" tabindex="-1"></a>    <span class="at">d=</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>,</span>
<span id="cb399-85"><a href="pi-example-jags.html#cb399-85" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>,</span>
<span id="cb399-86"><a href="pi-example-jags.html#cb399-86" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>,</span>
<span id="cb399-87"><a href="pi-example-jags.html#cb399-87" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>,</span>
<span id="cb399-88"><a href="pi-example-jags.html#cb399-88" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>,</span>
<span id="cb399-89"><a href="pi-example-jags.html#cb399-89" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>,</span>
<span id="cb399-90"><a href="pi-example-jags.html#cb399-90" aria-hidden="true" tabindex="-1"></a>               <span class="cn">NA</span>, <span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">1.00E+00</span>, <span class="sc">-</span><span class="fl">2.00E+00</span>, <span class="sc">-</span><span class="fl">3.00E+00</span>),</span>
<span id="cb399-91"><a href="pi-example-jags.html#cb399-91" aria-hidden="true" tabindex="-1"></a>              <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">nrow=</span><span class="dv">7</span>, <span class="at">byrow=</span>T),</span>
<span id="cb399-92"><a href="pi-example-jags.html#cb399-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">a=</span><span class="fu">c</span>(<span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>, <span class="fl">1.00E+00</span>))</span>
<span id="cb399-93"><a href="pi-example-jags.html#cb399-93" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb399-94"><a href="pi-example-jags.html#cb399-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-95"><a href="pi-example-jags.html#cb399-95" aria-hidden="true" tabindex="-1"></a><span class="co"># vector of all parameters to save</span></span>
<span id="cb399-96"><a href="pi-example-jags.html#cb399-96" aria-hidden="true" tabindex="-1"></a>param_save <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;theta&quot;</span>)</span>
<span id="cb399-97"><a href="pi-example-jags.html#cb399-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-98"><a href="pi-example-jags.html#cb399-98" aria-hidden="true" tabindex="-1"></a><span class="co"># dataset</span></span>
<span id="cb399-99"><a href="pi-example-jags.html#cb399-99" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/PI.dat&quot;</span>, <span class="at">header=</span>T)</span>
<span id="cb399-100"><a href="pi-example-jags.html#cb399-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-101"><a href="pi-example-jags.html#cb399-101" aria-hidden="true" tabindex="-1"></a>mydata <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb399-102"><a href="pi-example-jags.html#cb399-102" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">nrow</span>(dat), <span class="at">J =</span> <span class="fu">ncol</span>(dat),</span>
<span id="cb399-103"><a href="pi-example-jags.html#cb399-103" aria-hidden="true" tabindex="-1"></a>  <span class="at">K =</span> <span class="fu">rep</span>(<span class="dv">5</span>, <span class="fu">ncol</span>(dat)),</span>
<span id="cb399-104"><a href="pi-example-jags.html#cb399-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">as.matrix</span>(dat)</span>
<span id="cb399-105"><a href="pi-example-jags.html#cb399-105" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb399-106"><a href="pi-example-jags.html#cb399-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb399-107"><a href="pi-example-jags.html#cb399-107" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb399-108"><a href="pi-example-jags.html#cb399-108" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">jags</span>(</span>
<span id="cb399-109"><a href="pi-example-jags.html#cb399-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">model.file=</span>jags.model.peer.int,</span>
<span id="cb399-110"><a href="pi-example-jags.html#cb399-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>mydata,</span>
<span id="cb399-111"><a href="pi-example-jags.html#cb399-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">inits=</span>start_values,</span>
<span id="cb399-112"><a href="pi-example-jags.html#cb399-112" aria-hidden="true" tabindex="-1"></a>  <span class="at">parameters.to.save =</span> param_save,</span>
<span id="cb399-113"><a href="pi-example-jags.html#cb399-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.iter=</span><span class="dv">2000</span>,</span>
<span id="cb399-114"><a href="pi-example-jags.html#cb399-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.burnin =</span> <span class="dv">1000</span>,</span>
<span id="cb399-115"><a href="pi-example-jags.html#cb399-115" aria-hidden="true" tabindex="-1"></a>  <span class="at">n.chains =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## Compiling model graph
##    Resolving undeclared variables
##    Allocating nodes
## Graph information:
##    Observed stochastic nodes: 3500
##    Unobserved stochastic nodes: 535
##    Total graph size: 53050
## 
## Initializing model
## 
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |++                                                |   4%
  |                                                        
  |++++                                              |   8%
  |                                                        
  |++++++                                            |  12%
  |                                                        
  |++++++++                                          |  16%
  |                                                        
  |++++++++++                                        |  20%
  |                                                        
  |++++++++++++                                      |  24%
  |                                                        
  |++++++++++++++                                    |  28%
  |                                                        
  |++++++++++++++++                                  |  32%
  |                                                        
  |++++++++++++++++++                                |  36%
  |                                                        
  |++++++++++++++++++++                              |  40%
  |                                                        
  |++++++++++++++++++++++                            |  44%
  |                                                        
  |++++++++++++++++++++++++                          |  48%
  |                                                        
  |++++++++++++++++++++++++++                        |  52%
  |                                                        
  |++++++++++++++++++++++++++++                      |  56%
  |                                                        
  |++++++++++++++++++++++++++++++                    |  60%
  |                                                        
  |++++++++++++++++++++++++++++++++                  |  64%
  |                                                        
  |++++++++++++++++++++++++++++++++++                |  68%
  |                                                        
  |++++++++++++++++++++++++++++++++++++              |  72%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++            |  76%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++          |  80%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++        |  84%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++      |  88%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++    |  92%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++++  |  96%
  |                                                        
  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100%
## 
  |                                                        
  |                                                  |   0%
  |                                                        
  |**                                                |   4%
  |                                                        
  |****                                              |   8%
  |                                                        
  |******                                            |  12%
  |                                                        
  |********                                          |  16%
  |                                                        
  |**********                                        |  20%
  |                                                        
  |************                                      |  24%
  |                                                        
  |**************                                    |  28%
  |                                                        
  |****************                                  |  32%
  |                                                        
  |******************                                |  36%
  |                                                        
  |********************                              |  40%
  |                                                        
  |**********************                            |  44%
  |                                                        
  |************************                          |  48%
  |                                                        
  |**************************                        |  52%
  |                                                        
  |****************************                      |  56%
  |                                                        
  |******************************                    |  60%
  |                                                        
  |********************************                  |  64%
  |                                                        
  |**********************************                |  68%
  |                                                        
  |************************************              |  72%
  |                                                        
  |**************************************            |  76%
  |                                                        
  |****************************************          |  80%
  |                                                        
  |******************************************        |  84%
  |                                                        
  |********************************************      |  88%
  |                                                        
  |**********************************************    |  92%
  |                                                        
  |************************************************  |  96%
  |                                                        
  |**************************************************| 100%</code></pre>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="pi-example-jags.html#cb401-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(fit)</span></code></pre></div>
<pre><code>## Inference for Bugs model at &quot;C:/Users/noahp/AppData/Local/Temp/RtmpW4ITDP/modelcd06e8c1a5d.txt&quot;, fit using jags,
##  3 chains, each with 2000 iterations (first 1000 discarded)
##  n.sims = 3000 iterations saved
##             mu.vect sd.vect     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## a[1]          2.145   0.160    1.827    2.033    2.149    2.257    2.445 1.007   340
## a[2]          3.520   0.265    3.029    3.339    3.515    3.699    4.078 1.018   120
## a[3]          4.042   0.292    3.483    3.845    4.044    4.230    4.664 1.013   160
## a[4]          3.595   0.259    3.118    3.416    3.589    3.761    4.130 1.021   100
## a[5]          2.464   0.174    2.122    2.347    2.468    2.577    2.807 1.022    95
## a[6]          1.877   0.144    1.612    1.780    1.873    1.972    2.161 1.001  3000
## a[7]          1.506   0.128    1.261    1.420    1.509    1.590    1.752 1.001  2100
## d[1,2]        4.954   0.332    4.324    4.735    4.943    5.171    5.639 1.010   870
## d[2,2]        5.201   0.379    4.512    4.935    5.179    5.445    5.993 1.002  3000
## d[3,2]        6.638   0.457    5.809    6.318    6.631    6.948    7.551 1.002  1400
## d[4,2]        6.422   0.445    5.575    6.122    6.413    6.712    7.306 1.002  1000
## d[5,2]        4.810   0.307    4.219    4.598    4.808    5.003    5.423 1.006   410
## d[6,2]        3.856   0.253    3.379    3.680    3.853    4.021    4.367 1.026    82
## d[7,2]        4.306   0.301    3.757    4.096    4.297    4.503    4.941 1.001  3000
## d[1,3]        2.962   0.212    2.556    2.820    2.957    3.104    3.382 1.007   520
## d[2,3]        1.207   0.210    0.793    1.065    1.205    1.347    1.627 1.015   180
## d[3,3]        3.419   0.286    2.865    3.226    3.417    3.615    3.993 1.010   280
## d[4,3]        2.742   0.250    2.241    2.572    2.742    2.907    3.227 1.003   760
## d[5,3]        2.707   0.199    2.330    2.570    2.703    2.838    3.107 1.009   250
## d[6,3]        1.974   0.164    1.666    1.861    1.970    2.080    2.307 1.024    87
## d[7,3]        2.465   0.174    2.127    2.349    2.463    2.582    2.810 1.003   910
## d[1,4]        0.662   0.142    0.391    0.566    0.658    0.756    0.941 1.009   240
## d[2,4]       -1.741   0.219   -2.199   -1.879   -1.730   -1.591   -1.341 1.034    71
## d[3,4]       -1.297   0.234   -1.760   -1.455   -1.287   -1.133   -0.865 1.025    89
## d[4,4]       -0.769   0.198   -1.157   -0.904   -0.766   -0.633   -0.396 1.028    78
## d[5,4]       -0.329   0.155   -0.630   -0.436   -0.329   -0.220   -0.039 1.017   130
## d[6,4]       -0.479   0.131   -0.733   -0.568   -0.479   -0.387   -0.230 1.024    89
## d[7,4]        0.280   0.121    0.039    0.199    0.282    0.363    0.514 1.006   350
## d[1,5]       -2.496   0.189   -2.896   -2.620   -2.487   -2.365   -2.154 1.007   330
## d[2,5]       -5.093   0.371   -5.861   -5.343   -5.084   -4.836   -4.383 1.026    82
## d[3,5]       -5.614   0.408   -6.459   -5.875   -5.596   -5.328   -4.865 1.016   140
## d[4,5]       -4.831   0.342   -5.546   -5.060   -4.806   -4.602   -4.191 1.023   100
## d[5,5]       -3.591   0.243   -4.091   -3.754   -3.590   -3.431   -3.127 1.018   120
## d[6,5]       -3.216   0.211   -3.644   -3.358   -3.214   -3.076   -2.820 1.004   510
## d[7,5]       -2.738   0.187   -3.113   -2.863   -2.729   -2.608   -2.383 1.003   810
## theta[1]      0.841   0.280    0.274    0.648    0.839    1.038    1.368 1.003   980
## theta[2]     -0.985   0.254   -1.484   -1.157   -0.982   -0.811   -0.496 1.004   650
## theta[3]     -1.040   0.248   -1.520   -1.206   -1.036   -0.872   -0.547 1.003   740
## theta[4]     -0.259   0.259   -0.778   -0.426   -0.259   -0.088    0.251 1.002  1400
## theta[5]      0.118   0.262   -0.416   -0.046    0.123    0.285    0.618 1.005   430
## theta[6]      0.092   0.255   -0.409   -0.077    0.103    0.259    0.595 1.003   740
## theta[7]      1.452   0.318    0.864    1.234    1.448    1.650    2.124 1.006   600
## theta[8]      0.771   0.265    0.250    0.586    0.777    0.952    1.274 1.001  2200
## theta[9]     -0.017   0.250   -0.505   -0.183   -0.017    0.150    0.485 1.001  2000
## theta[10]     0.360   0.270   -0.163    0.183    0.358    0.534    0.908 1.005   500
## theta[11]    -0.770   0.256   -1.259   -0.949   -0.772   -0.602   -0.253 1.003   880
## theta[12]    -0.211   0.257   -0.745   -0.378   -0.210   -0.037    0.285 1.003   980
## theta[13]     1.040   0.260    0.519    0.868    1.039    1.215    1.549 1.007   290
## theta[14]    -0.014   0.253   -0.529   -0.174   -0.006    0.156    0.461 1.001  3000
## theta[15]    -0.686   0.245   -1.164   -0.851   -0.684   -0.523   -0.208 1.002  2000
## theta[16]    -0.453   0.286   -1.016   -0.646   -0.453   -0.259    0.116 1.001  3000
## theta[17]     2.361   0.479    1.540    2.024    2.302    2.648    3.410 1.004   570
## theta[18]     0.239   0.258   -0.239    0.061    0.233    0.412    0.775 1.005   430
## theta[19]     0.035   0.261   -0.457   -0.142    0.031    0.209    0.546 1.002  3000
## theta[20]     0.236   0.262   -0.277    0.061    0.231    0.412    0.756 1.001  2100
## theta[21]     0.359   0.249   -0.128    0.197    0.361    0.522    0.835 1.003   890
## theta[22]    -1.023   0.263   -1.556   -1.192   -1.013   -0.848   -0.508 1.001  3000
## theta[23]     0.681   0.264    0.178    0.504    0.680    0.859    1.192 1.007   330
## theta[24]     0.066   0.266   -0.465   -0.111    0.071    0.251    0.571 1.002  1800
## theta[25]     2.355   0.485    1.536    2.007    2.310    2.651    3.431 1.001  2200
## theta[26]     0.546   0.296   -0.020    0.340    0.538    0.737    1.145 1.004   540
## theta[27]    -0.762   0.258   -1.258   -0.944   -0.761   -0.591   -0.253 1.003   780
## theta[28]     0.195   0.252   -0.311    0.034    0.197    0.369    0.682 1.003   830
## theta[29]     1.062   0.290    0.493    0.868    1.059    1.255    1.641 1.001  2000
## theta[30]     0.372   0.243   -0.091    0.207    0.369    0.530    0.852 1.003  1400
## theta[31]     0.475   0.255   -0.006    0.295    0.469    0.652    0.975 1.004   610
## theta[32]     0.415   0.266   -0.102    0.240    0.414    0.591    0.938 1.003   860
## theta[33]     0.427   0.263   -0.106    0.252    0.429    0.601    0.947 1.001  3000
## theta[34]     0.133   0.247   -0.358   -0.035    0.136    0.294    0.613 1.006   430
## theta[35]    -1.314   0.260   -1.820   -1.491   -1.317   -1.138   -0.811 1.010   210
## theta[36]     0.774   0.243    0.292    0.607    0.769    0.938    1.265 1.005   460
## theta[37]    -0.535   0.264   -1.053   -0.713   -0.535   -0.357   -0.029 1.002  2000
## theta[38]    -0.732   0.251   -1.222   -0.904   -0.737   -0.562   -0.231 1.003   680
## theta[39]    -0.466   0.311   -1.076   -0.677   -0.457   -0.258    0.159 1.002  1500
## theta[40]    -0.148   0.257   -0.654   -0.320   -0.148    0.025    0.364 1.003  1300
## theta[41]     0.215   0.288   -0.335    0.024    0.209    0.398    0.799 1.002  1300
## theta[42]    -2.234   0.353   -2.983   -2.465   -2.219   -1.985   -1.600 1.003  1000
## theta[43]     2.068   0.404    1.384    1.792    2.019    2.292    3.018 1.002  1700
## theta[44]    -0.409   0.290   -0.974   -0.610   -0.409   -0.214    0.142 1.003   820
## theta[45]     2.349   0.470    1.567    2.001    2.304    2.638    3.406 1.003   990
## theta[46]     0.782   0.257    0.282    0.606    0.786    0.958    1.276 1.001  3000
## theta[47]    -0.859   0.265   -1.377   -1.038   -0.859   -0.676   -0.333 1.012   170
## theta[48]    -0.181   0.262   -0.714   -0.350   -0.181   -0.010    0.326 1.004   680
## theta[49]     0.166   0.264   -0.366   -0.004    0.162    0.334    0.704 1.002  3000
## theta[50]    -0.582   0.285   -1.132   -0.775   -0.583   -0.394   -0.021 1.005   740
## theta[51]    -0.377   0.250   -0.867   -0.545   -0.376   -0.211    0.129 1.003   920
## theta[52]    -1.019   0.250   -1.516   -1.186   -1.019   -0.858   -0.529 1.003   880
## theta[53]     0.428   0.264   -0.096    0.260    0.428    0.603    0.961 1.002  1500
## theta[54]     0.365   0.275   -0.193    0.188    0.361    0.549    0.905 1.001  3000
## theta[55]    -0.831   0.267   -1.362   -1.004   -0.831   -0.647   -0.321 1.002  1900
## theta[56]     0.784   0.253    0.297    0.616    0.780    0.958    1.278 1.001  3000
## theta[57]     1.396   0.262    0.882    1.219    1.396    1.564    1.944 1.001  3000
## theta[58]    -0.840   0.255   -1.337   -1.011   -0.836   -0.670   -0.342 1.001  3000
## theta[59]     0.094   0.256   -0.415   -0.079    0.098    0.270    0.584 1.002  3000
## theta[60]     0.343   0.267   -0.167    0.161    0.346    0.517    0.861 1.006  1100
## theta[61]    -1.794   0.313   -2.423   -1.995   -1.781   -1.582   -1.206 1.002  1200
## theta[62]    -0.422   0.254   -0.936   -0.592   -0.419   -0.262    0.083 1.002  1900
## theta[63]     2.342   0.476    1.537    2.000    2.304    2.644    3.424 1.002  1300
## theta[64]    -0.920   0.252   -1.421   -1.083   -0.924   -0.757   -0.423 1.002  1100
## theta[65]     0.369   0.274   -0.159    0.184    0.364    0.547    0.914 1.003  1200
## theta[66]     0.779   0.264    0.268    0.602    0.783    0.958    1.309 1.001  2800
## theta[67]     0.339   0.251   -0.157    0.171    0.342    0.508    0.827 1.001  3000
## theta[68]     1.601   0.293    1.060    1.404    1.582    1.793    2.221 1.002  1100
## theta[69]     1.093   0.261    0.575    0.919    1.096    1.273    1.590 1.002  1400
## theta[70]     1.596   0.291    1.040    1.403    1.587    1.781    2.178 1.002  1400
## theta[71]    -0.016   0.246   -0.489   -0.185   -0.015    0.148    0.469 1.004   530
## theta[72]    -1.027   0.257   -1.526   -1.199   -1.023   -0.853   -0.527 1.002  1500
## theta[73]     0.145   0.268   -0.374   -0.035    0.149    0.320    0.681 1.004   660
## theta[74]    -2.301   0.392   -3.175   -2.544   -2.276   -2.020   -1.612 1.002  1800
## theta[75]    -0.131   0.279   -0.683   -0.313   -0.128    0.049    0.415 1.004   960
## theta[76]    -1.106   0.238   -1.556   -1.269   -1.113   -0.942   -0.639 1.007   310
##  [ reached getOption(&quot;max.print&quot;) -- omitted 425 rows ]
## 
## For each parameter, n.eff is a crude measure of effective sample size,
## and Rhat is the potential scale reduction factor (at convergence, Rhat=1).
## 
## DIC info (using the rule, pD = var(deviance)/2)
## pD = 699.0 and DIC = 7012.0
## DIC is an estimate of expected predictive error (lower deviance is better).</code></pre>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="pi-example-jags.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(fit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>summary[ <span class="sc">!</span><span class="fu">rownames</span>(fit<span class="sc">$</span>BUGSoutput<span class="sc">$</span>summary) <span class="sc">%like%</span> <span class="st">&quot;theta&quot;</span>, ], <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##              mean     sd     2.5%      25%      50%      75%    97.5%  Rhat n.eff
## a[1]        2.145  0.160    1.827    2.033    2.149    2.257    2.445 1.007   340
## a[2]        3.520  0.265    3.029    3.339    3.515    3.699    4.078 1.018   120
## a[3]        4.042  0.292    3.483    3.845    4.044    4.230    4.664 1.013   160
## a[4]        3.595  0.259    3.118    3.416    3.589    3.761    4.130 1.021   100
## a[5]        2.464  0.174    2.122    2.347    2.468    2.577    2.807 1.022    95
## a[6]        1.877  0.144    1.612    1.780    1.873    1.972    2.161 1.001  3000
## a[7]        1.506  0.128    1.261    1.420    1.509    1.590    1.752 1.001  2100
## d[1,2]      4.954  0.332    4.324    4.735    4.943    5.171    5.639 1.010   870
## d[2,2]      5.201  0.379    4.512    4.935    5.179    5.445    5.993 1.002  3000
## d[3,2]      6.638  0.457    5.809    6.318    6.631    6.948    7.551 1.002  1400
## d[4,2]      6.422  0.445    5.575    6.122    6.413    6.712    7.306 1.002  1000
## d[5,2]      4.810  0.307    4.219    4.598    4.808    5.003    5.423 1.006   410
## d[6,2]      3.856  0.253    3.379    3.680    3.853    4.021    4.367 1.026    82
## d[7,2]      4.306  0.301    3.757    4.096    4.297    4.503    4.941 1.001  3000
## d[1,3]      2.962  0.212    2.556    2.820    2.957    3.104    3.382 1.007   520
## d[2,3]      1.207  0.210    0.793    1.065    1.205    1.347    1.627 1.015   180
## d[3,3]      3.419  0.286    2.865    3.226    3.417    3.615    3.993 1.010   280
## d[4,3]      2.742  0.250    2.241    2.572    2.742    2.907    3.227 1.003   760
## d[5,3]      2.707  0.199    2.330    2.570    2.703    2.838    3.107 1.009   250
## d[6,3]      1.974  0.164    1.666    1.861    1.970    2.080    2.307 1.024    87
## d[7,3]      2.465  0.174    2.127    2.349    2.463    2.582    2.810 1.003   910
## d[1,4]      0.662  0.142    0.391    0.566    0.658    0.756    0.941 1.009   240
## d[2,4]     -1.741  0.219   -2.199   -1.879   -1.730   -1.591   -1.341 1.034    71
## d[3,4]     -1.297  0.234   -1.760   -1.455   -1.287   -1.133   -0.865 1.025    89
## d[4,4]     -0.769  0.198   -1.157   -0.904   -0.766   -0.633   -0.396 1.028    78
## d[5,4]     -0.329  0.155   -0.630   -0.436   -0.329   -0.220   -0.039 1.017   130
## d[6,4]     -0.479  0.131   -0.733   -0.568   -0.479   -0.387   -0.230 1.024    89
## d[7,4]      0.280  0.121    0.039    0.199    0.282    0.363    0.514 1.006   350
## d[1,5]     -2.496  0.189   -2.896   -2.620   -2.487   -2.365   -2.154 1.007   330
## d[2,5]     -5.093  0.371   -5.861   -5.343   -5.084   -4.836   -4.383 1.026    82
## d[3,5]     -5.614  0.408   -6.459   -5.875   -5.596   -5.328   -4.865 1.016   140
## d[4,5]     -4.831  0.342   -5.546   -5.060   -4.806   -4.602   -4.191 1.023   100
## d[5,5]     -3.591  0.243   -4.091   -3.754   -3.590   -3.431   -3.127 1.018   120
## d[6,5]     -3.216  0.211   -3.644   -3.358   -3.214   -3.076   -2.820 1.004   510
## d[7,5]     -2.738  0.187   -3.113   -2.863   -2.729   -2.608   -2.383 1.003   810
## deviance 6312.984 37.557 6240.558 6286.102 6312.879 6338.275 6387.906 1.010   210</code></pre>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="pi-example-jags.html#cb405-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract posteriors for all chains</span></span>
<span id="cb405-2"><a href="pi-example-jags.html#cb405-2" aria-hidden="true" tabindex="-1"></a>jags.mcmc <span class="ot">&lt;-</span> <span class="fu">as.mcmc</span>(fit)</span>
<span id="cb405-3"><a href="pi-example-jags.html#cb405-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-4"><a href="pi-example-jags.html#cb405-4" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to single data.frame for density plot</span></span>
<span id="cb405-5"><a href="pi-example-jags.html#cb405-5" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">colnames</span>(<span class="fu">as.data.frame</span>(jags.mcmc[[<span class="dv">1</span>]]))</span>
<span id="cb405-6"><a href="pi-example-jags.html#cb405-6" aria-hidden="true" tabindex="-1"></a>plot.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">as.matrix</span>(jags.mcmc, <span class="at">chains=</span>T, <span class="at">iters =</span> T))</span>
<span id="cb405-7"><a href="pi-example-jags.html#cb405-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(plot.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;chain&quot;</span>, <span class="st">&quot;iter&quot;</span>, a)</span>
<span id="cb405-8"><a href="pi-example-jags.html#cb405-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-9"><a href="pi-example-jags.html#cb405-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb405-10"><a href="pi-example-jags.html#cb405-10" aria-hidden="true" tabindex="-1"></a>plot_title <span class="ot">&lt;-</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Posterior distributions&quot;</span>,<span class="st">&quot;with medians and 80% intervals&quot;</span>)</span>
<span id="cb405-11"><a href="pi-example-jags.html#cb405-11" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(plot.data, <span class="at">regex_pars =</span> <span class="st">&quot;d&quot;</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span>  plot_title <span class="sc">+</span> <span class="fu">lims</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>))</span></code></pre></div>
<pre><code>## Scale for &#39;x&#39; is already present. Adding another scale for &#39;x&#39;, which will replace the existing
## scale.</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_segment).</code></pre>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-1.png" width="672" /></p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="pi-example-jags.html#cb408-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_areas</span>(</span>
<span id="cb408-2"><a href="pi-example-jags.html#cb408-2" aria-hidden="true" tabindex="-1"></a>  plot.data,</span>
<span id="cb408-3"><a href="pi-example-jags.html#cb408-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;a[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="st">&quot;]&quot;</span>)),</span>
<span id="cb408-4"><a href="pi-example-jags.html#cb408-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb408-5"><a href="pi-example-jags.html#cb408-5" aria-hidden="true" tabindex="-1"></a>  plot_title</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-2.png" width="672" /></p>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="pi-example-jags.html#cb409-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_acf</span>(plot.data,<span class="at">pars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;a[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="st">&quot;]&quot;</span>)))</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-3.png" width="672" /></p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="pi-example-jags.html#cb410-1" aria-hidden="true" tabindex="-1"></a>bayesplot<span class="sc">::</span><span class="fu">mcmc_trace</span>(plot.data,<span class="at">pars =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;a[&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>, <span class="st">&quot;]&quot;</span>)))</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-4.png" width="672" /></p>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="pi-example-jags.html#cb411-1" aria-hidden="true" tabindex="-1"></a>ggmcmc<span class="sc">::</span><span class="fu">ggs_grb</span>(<span class="fu">ggs</span>(jags.mcmc), <span class="at">family=</span><span class="st">&quot;d&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-5.png" width="672" /></p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="pi-example-jags.html#cb412-1" aria-hidden="true" tabindex="-1"></a>ggmcmc<span class="sc">::</span><span class="fu">ggs_grb</span>(<span class="fu">ggs</span>(jags.mcmc), <span class="at">family=</span><span class="st">&quot;a&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-6.png" width="672" /></p>
<div class="sourceCode" id="cb413"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb413-1"><a href="pi-example-jags.html#cb413-1" aria-hidden="true" tabindex="-1"></a>ggmcmc<span class="sc">::</span><span class="fu">ggs_autocorrelation</span>(<span class="fu">ggs</span>(jags.mcmc), <span class="at">family=</span><span class="st">&quot;d&quot;</span>)</span></code></pre></div>
<p><img src="bookdown-BPM_files/figure-html/chp11-peer-int-jags-7.png" width="672" /></p>
<!-- ## PI Example - OpenBUGS -->
<!-- I ran into issues using the BUGs code provided in text using JAGS so I figured I would replicate the model using OpenBUGS directly to test whether the model can be run as is without any modifications. -->
<!-- ```{r chp11-peer-int-openbugs, warnings=T, message=T, error=T, cache=TRUE} -->
<!-- # model code -->
<!-- model.file <- paste0(w.d,"/code/IRT-for-Polytomous-Observables/IRT for Polytomous Observables/WinBUGS/L-GRM (Normal with Bounds, Truncated-Normal).bug") -->
<!-- cat(model.file) -->
<!-- # get data file -->
<!-- data.file <- paste0(w.d,"/code/IRT-for-Polytomous-Observables/IRT for Polytomous Observables/WinBUGS/data.txt") -->
<!-- # initial values -->
<!-- start_values <- list( -->
<!--   list( -->
<!--     d= matrix(c(NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00, -->
<!--                NA, 3.00E+00, 1.00E+00, 0.00E+00, -1.00E+00), -->
<!--       ncol=5, nrow=7, byrow=T), -->
<!--     a=c(1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01, 1.00E-01)), -->
<!--   list( -->
<!--     d= matrix(c(NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00, -->
<!--                NA, 2.00E+00, 0.00E+00, -1.00E+00, -2.00E+00), -->
<!--       ncol=5, nrow=7, byrow=T), -->
<!--     a=c(3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00, 3.00E+00)), -->
<!--   list( -->
<!--     d= matrix(c(NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00, -->
<!--                NA, 1.00E+00, -1.00E+00, -2.00E+00, -3.00E+00), -->
<!--               ncol=5, nrow=7, byrow=T), -->
<!--     a=c(1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00, 1.00E+00)) -->
<!-- ) -->
<!-- # vector of all parameters to save -->
<!-- param_save <- c("a", "d", "theta") -->
<!-- # fit model -->
<!-- fit <- openbugs( -->
<!--   data= data.file,  -->
<!--   model.file = model.file, # R grabs the file and runs it in openBUGS -->
<!--   parameters.to.save = param_save, -->
<!--   inits=start_values, -->
<!--   n.chains = 3, -->
<!--   n.iter = 2000, -->
<!--   n.burnin = 1000, -->
<!--   n.thin = 1 -->
<!-- ) -->
<!-- print(fit) -->
<!-- ``` -->
</div>
            </section>

          </div>
        </div>
      </div>
<a href="grm-peer-interactions-example.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="pi-example-stan.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/noah-padgett/Bayesian-Psychometric-Modeling/edit/master/11-irt.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-BPM.pdf", "bookdown-BPM.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
